<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="New-WSManSessionOption (Microsoft.WSMan.Management)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="New-WSManSessionOption (Microsoft.WSMan.Management)" name="twitter:title"/>
  <meta content="The New-WSManSessionOption cmdlet creates a WSMan Session option hash table which can be passed to WSMan cmdlets:  Get-WSManInstance Set-WSManInstance Invoke-WSManAction Connect-WSMan  " name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="The New-WSManSessionOption cmdlet creates a WSMan Session option hash table which can be passed to WSMan cmdlets:  Get-WSManInstance Set-WSManInstance Invoke-WSManAction Connect-WSMan  " name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="PowerShell_PowerShell-docs_reference" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="PowerShell" name="search.ms_product"/>
  <meta content="PowerShell.PowerShell_PowerShell-docs_reference" name="depot_name"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/45404d4ca212afa615798d3d5cbfea5dc5cc1efb/reference/6/Microsoft.WSMan.Management/New-WSManSessionOption.md" name="ref_skeleton_gitcommit"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/live/reference/6/Microsoft.WSMan.Management/New-WSManSessionOption.md" name="original_ref_skeleton_git_url"/>
  <meta content="2018-03-30 03:35 PM" name="updated_at"/>
  <meta content="1e51cb70-fa70-5569-a006-428af9c09dac" name="document_id"/>
  <meta content="a71149dc-95f5-b34f-19c1-52ec2817b9b9" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="06/09/2017" name="ms.date"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="powershell,cmdlet" name="keywords"/>
  <meta content="http://go.microsoft.com/fwlink/?LinkId=821734" name="online_version"/>
  <meta content="Microsoft.WSMan.Management.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="sdwheeler" name="author"/>
  <meta content="sewhee" name="ms.author"/>
  <meta content="carmonm" name="manager"/>
  <meta content="/powershell/bread-pscore/toc.yml?view=powershell-6" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="windows, macos, linux" name="ms.tgt_pltfr"/>
  <meta content="powershell-scripting" name="ms.technology"/>
  <meta content="powershell" name="ms.prod"/>
  <meta content="MSDocsHeader-Powershell" name="uhfHeaderId"/>
  <meta content="../psdocs/toc.json?view=powershell-6" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.wsman.management/new-wsmansessionoption" rel="canonical"/>
  <title>
   New-WSManSessionOption
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/60aac04b.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/fdb8a38a.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      New-WSMan
      <wbr/>
      Session
      <wbr/>
      Option
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./Microsoft.WSMan.Management.html">
         Microsoft.WSMan.Management
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Creates session option hash table to use as input parameters for WS-Management cmdlets.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">New-WSManSessionOption
   [-ProxyAccessType &lt;ProxyAccessType&gt;]
   [-ProxyAuthentication &lt;ProxyAuthentication&gt;]
   [-ProxyCredential &lt;PSCredential&gt;]
   [-SkipCACheck]
   [-SkipCNCheck]
   [-SkipRevocationCheck]
   [-SPNPort &lt;Int32&gt;]
   [-OperationTimeout &lt;Int32&gt;]
   [-NoEncryption]
   [-UseUTF16]
   [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       New-WSManSessionOption
      </strong>
      cmdlet creates a WSMan Session option hash table which can be passed to WSMan cmdlets:
     </p>
     <ul>
      <li>
       Get-WSManInstance
      </li>
      <li>
       Set-WSManInstance
      </li>
      <li>
       Invoke-WSManAction
      </li>
      <li>
       Connect-WSMan
      </li>
     </ul>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Create a connection that uses connection options
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; $a = New-WSManSessionOption -OperationTimeout 30000

PS C:\&gt; Connect-WSMan -ComputerName "server01" -SessionOption $a

PS C:\&gt; cd wsman:

PS WSMan:\&gt;

PS WSMan:\&gt; dir

WSManConfig: Microsoft.WSMan.Management\WSMan::WSMan

ComputerName                                  Type

------------                                  ----

localhost                                     Container

server01                                      Container</code></pre>
     <p>
      This example creates a connection to the remote server01 computer by using the connection options that are defined by
      <strong>
       New-WSManSessionOption
      </strong>
      .
     </p>
     <p>
      The first command uses
      <strong>
       New-WSManSessionOption
      </strong>
      to store a set of connection setting options in the $a variable.
In this case, the session options set a connection time out of 30 seconds (30,000 milliseconds).
     </p>
     <p>
      The second command uses the
      <em>
       SessionOption
      </em>
      parameter to pass the credentials that are stored in the $a variable to
      <strong>
       Connect-WSMan
      </strong>
      .
Then,
      <strong>
       Connect-WSMan
      </strong>
      connects to the remote server01 computer by using the specified session options.
     </p>
     <p>
      <strong>
       Connect-WSMan
      </strong>
      is generally used in the context of the WSMan provider to connect to a remote computer, in this case the server01 computer.
However, you can use the cmdlet to establish connections to remote computers before you change to the WSMan provider.
Those connections appear in the
      <strong>
       ComputerName
      </strong>
      list.
     </p>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -NoEncryption
     </div>
     <div class="parameterInfo">
      <p>
       Indicates that the connection does not use encryption for remote operations over HTTP.
      </p>
      <p>
       By default, unencrypted traffic is not enabled.
It must be enabled in the local configuration.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -OperationTimeout
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the time-out, in milliseconds, for the WS-Management operation.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          Int32
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         OperationTimeoutMSec
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -ProxyAccessType
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the mechanism by which the proxy server is located.
The acceptable values for this parameter are:
      </p>
      <ul>
       <li>
        ProxyIEConfig.
Use the Internet Explorer proxy configuration for the current user.
       </li>
       <li>
        ProxyWinHttpConfig.
The WSMan client uses the proxy settings configured for WinHTTP, using the ProxyCfg.exe utility.
       </li>
       <li>
        ProxyAutoDetect.
Force auto-detection of a proxy server.
       </li>
       <li>
        ProxyNoProxyServer.
Do not use a proxy server.
Resolve all host names locally.
       </li>
      </ul>
      <p>
       The default value is ProxyIEConfig.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          ProxyAccessType
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -ProxyAuthentication
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the authentication method to use at the proxy.
The acceptable values for this parameter are:
      </p>
      <ul>
       <li>
        Basic.
Basic is a scheme in which the user name and password are sent in clear-text to the server or proxy.
       </li>
       <li>
        Digest.
Digest is a challenge-response scheme that uses a server-specified data string for the challenge.
       </li>
       <li>
        Negotiate.
Negotiate is a challenge-response scheme that negotiates with the server or proxy to determine which scheme to use for authentication.
Examples are the Kerberos protocol and NTLM.
       </li>
      </ul>
      <p>
       The default value is Negotiate.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          ProxyAuthentication
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -ProxyCredential
     </div>
     <div class="parameterInfo">
      <p>
       Specifies a user account that has permission to gain access through an intermediate Web proxy.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          PSCredential
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -SPNPort
     </div>
     <div class="parameterInfo">
      <p>
       Specifies a port number to append to the connection Service Principal Name (SPN) of the remote server.
An SPN is used when the authentication mechanism is Kerberos or Negotiate.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          Int32
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -SkipCACheck
     </div>
     <div class="parameterInfo">
      <p>
       Specifies that, when it connects over HTTPS, the client does not validate that the server certificate is signed by a trusted certification authority (CA).
Use this option only when the remote computer is trusted by another method, for example, if the remote computer is part of a network that is physically secure and isolated or the remote computer is listed as a trusted host in the WS-Management configuration.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -SkipCNCheck
     </div>
     <div class="parameterInfo">
      <p>
       Specifies that the certificate common name (CN) of the server does not have to match the host name of the server.
This is used only in remote operations using HTTPS.
This option should only be used for trusted computers.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -SkipRevocationCheck
     </div>
     <div class="parameterInfo">
      <p>
       Indicates that the connection does not validate the revocation status on the server certificate.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -UseUTF16
     </div>
     <div class="parameterInfo">
      <p>
       Indicates that the connection encodes the request in UTF16 format instead of UTF8 format.
The default is UTF8 encoding.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       SessionOption
      </strong>
     </p>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="relative-path" href="connect-wsman.html">
        Connect-WSMan
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="disable-wsmancredssp.html">
        Disable-WSManCredSSP
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="disconnect-wsman.html">
        Disconnect-WSMan
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="enable-wsmancredssp.html">
        Enable-WSManCredSSP
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="get-wsmancredssp.html">
        Get-WSManCredSSP
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="get-wsmaninstance.html">
        Get-WSManInstance
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="invoke-wsmanaction.html">
        Invoke-WSManAction
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="new-wsmaninstance.html">
        New-WSManInstance
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="remove-wsmaninstance.html">
        Remove-WSManInstance
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="set-wsmaninstance.html">
        Set-WSManInstance
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="set-wsmanquickconfig.html">
        Set-WSManQuickConfig
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="test-wsman.html">
        Test-WSMan
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <div class="note alert feedback-system-change-alert">
     <p>
      Note
     </p>
     <p>
      The feedback system for this content will be changing soon. Old comments will not be carried over. If content within a comment thread is important to you, please save a copy. For more information on the upcoming change,
      <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
       we invite you to read our blog post
      </a>
      .
     </p>
    </div>
    <div data-bi-name="comments" id="comments-container" role="form">
    </div>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>