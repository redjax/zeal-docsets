<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Set-AuthenticodeSignature (Microsoft.PowerShell.Security)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Set-AuthenticodeSignature (Microsoft.PowerShell.Security)" name="twitter:title"/>
  <meta content="The Set-AuthenticodeSignature cmdlet adds an Authenticode signature to any file that supports Subject Interface Package (SIP). In a Windows PowerShell script file, the signature takes the form of a bâ¦" name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="The Set-AuthenticodeSignature cmdlet adds an Authenticode signature to any file that supports Subject Interface Package (SIP). In a Windows PowerShell script file, the signature takes the form of a bâ¦" name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="PowerShell_PowerShell-docs_reference" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="PowerShell" name="search.ms_product"/>
  <meta content="PowerShell.PowerShell_PowerShell-docs_reference" name="depot_name"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/617301cc0a194afdca440ba75f5cec2a540ce619/reference/6/Microsoft.PowerShell.Security/Set-AuthenticodeSignature.md" name="ref_skeleton_gitcommit"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/live/reference/6/Microsoft.PowerShell.Security/Set-AuthenticodeSignature.md" name="original_ref_skeleton_git_url"/>
  <meta content="2018-03-30 03:35 PM" name="updated_at"/>
  <meta content="b32d55d9-df50-4579-e6ff-31904b79a9cf" name="document_id"/>
  <meta content="0249e978-7402-b03f-e6ba-1bd781a58c26" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="06/09/2017" name="ms.date"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="powershell,cmdlet" name="keywords"/>
  <meta content="http://go.microsoft.com/fwlink/?LinkId=821718" name="online_version"/>
  <meta content="Microsoft.PowerShell.Security.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="sdwheeler" name="author"/>
  <meta content="sewhee" name="ms.author"/>
  <meta content="carmonm" name="manager"/>
  <meta content="/powershell/bread-pscore/toc.yml?view=powershell-6" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="windows, macos, linux" name="ms.tgt_pltfr"/>
  <meta content="powershell-scripting" name="ms.technology"/>
  <meta content="powershell" name="ms.prod"/>
  <meta content="MSDocsHeader-Powershell" name="uhfHeaderId"/>
  <meta content="../psdocs/toc.json?view=powershell-6" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-authenticodesignature" rel="canonical"/>
  <title>
   Set-AuthenticodeSignature
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/60aac04b.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/fdb8a38a.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Set-Authenticode
      <wbr/>
      Signature
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./Microsoft.PowerShell.Security.html">
         Microsoft.PowerShell.Security
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Adds an Authenticode signature to a Windows PowerShell script or other file.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Set-AuthenticodeSignature
   [-Certificate] &lt;X509Certificate2&gt;
   [-IncludeChain &lt;String&gt;]
   [-TimestampServer &lt;String&gt;]
   [-HashAlgorithm &lt;String&gt;]
   [-Force]
   [-FilePath] &lt;String[]&gt;
   [-WhatIf]
   [-Confirm]
   [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Set-AuthenticodeSignature
   [-Certificate] &lt;X509Certificate2&gt;
   [-IncludeChain &lt;String&gt;]
   [-TimestampServer &lt;String&gt;]
   [-HashAlgorithm &lt;String&gt;]
   [-Force]
   -LiteralPath &lt;String[]&gt;
   [-WhatIf]
   [-Confirm]
   [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Set-AuthenticodeSignature
   [-Certificate] &lt;X509Certificate2&gt;
   [-IncludeChain &lt;String&gt;]
   [-TimestampServer &lt;String&gt;]
   [-HashAlgorithm &lt;String&gt;]
   [-Force]
   -SourcePathOrExtension &lt;String[]&gt;
   -Content &lt;Byte[]&gt;
   [-WhatIf]
   [-Confirm]
   [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Set-AuthenticodeSignature
      </strong>
      cmdlet adds an Authenticode signature to any file that supports Subject Interface Package (SIP).
     </p>
     <p>
      In a Windows PowerShell script file, the signature takes the form of a block of text that indicates the end of the instructions that are executed in the script.
If there is a signature in the file when this cmdlet runs, that signature is removed.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Get a code-signing certificate and sign a script
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; $Cert = Get-ChildItem -Path "Cert:\CurrentUser\My" -CodeSigningCert

PS C:\&gt; Set-AuthenticodeSignature -FilePath "PsTestInternet2.ps1" -Certificate $Cert</code></pre>
     <p>
      These commands get a code-signing certificate from the Windows PowerShell certificate provider and use it to sign a Windows PowerShell script.
     </p>
     <p>
      The first command uses the Get-ChildItem cmdlet and the Windows PowerShell certificate provider to get the certificates in the Cert:\CurrentUser\My subdirectory of the certificate store.
(The Cert: drive is the drive exposed by the certificate provider.) The
      <em>
       CodeSigningCert
      </em>
      parameter, which is supported only by the certificate provider, limits the certificates retrieved to those with code-signing authority.
The command stores the result in the $Cert variable.
     </p>
     <p>
      The second command uses the
      <strong>
       Set-AuthenticodeSignature
      </strong>
      cmdlet to sign the PSTestInternet2.ps1 script.
It uses the
      <em>
       FilePath
      </em>
      parameter to specify the name of the script and the
      <em>
       Certificate
      </em>
      parameter to specify that the certificate is stored in the $Cert variable.
     </p>
     <p>
      <strong>
       Example 2: Get a code-signing certificate and sign a script
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; $Cert = Get-PfxCertificate -FilePath "C:\Test\Mysign.pfx"

PS C:\&gt; Set-AuthenticodeSignature -FilePath "ServerProps.ps1" -Certificate $Cert</code></pre>
     <p>
      These commands use the Get-PfxCertificate cmdlet to find a code signing certificate.
Then, they use it to sign a Windows PowerShell script.
     </p>
     <p>
      The first command uses the
      <strong>
       Get-PfxCertificate
      </strong>
      cmdlet to find the C:\Test\MySign.pfx certificate and store it in the $Cert variable.
     </p>
     <p>
      The second command uses
      <strong>
       Set-AuthenticodeSignature
      </strong>
      to sign the script.
The
      <em>
       FilePath
      </em>
      parameter of
      <strong>
       Set-AuthenticodeSignature
      </strong>
      specifies the path to the script file being signed and the
      <em>
       Certificate
      </em>
      parameter passes the $Cert variable containing the certificate to
      <strong>
       Set-AuthenticodeSignature
      </strong>
      .
     </p>
     <p>
      If the certificate file is password protected, Windows PowerShell prompts you for the password.
     </p>
     <p>
      <strong>
       Example 3: Add a digital signature with the root authority
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Set-AuthenticodeSignature -FilePath "C:\scripts\Remodel.ps1" -Certificate $Cert -IncludeChain "All" -TimeStampServer "http://timestamp.fabrikam.com/scripts/timstamper.dll"</code></pre>
     <p>
      This command adds a digital signature that includes the root authority in the trust chain, and it is signed by a third-party timestamp server.
     </p>
     <p>
      The command uses the
      <em>
       FilePath
      </em>
      parameter to specify the script being signed and the
      <em>
       Certificate
      </em>
      parameter to specify the certificate that is saved in the $Cert variable.
It uses the
      <em>
       IncludeChain
      </em>
      parameter to include all of the signatures in the trust chain (including the root authority).
It also uses the
      <em>
       TimeStampServer
      </em>
      parameter to add a timestamp to the signature.
This prevents the script from failing when the certificate expires.
     </p>
     <h2 id="required-parameters">
      Required Parameters
     </h2>
     <div class="parameterName stack">
      -Certificate
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the certificate that will be used to sign the script or file.
Enter a variable that stores an object representing the certificate or an expression that gets the certificate.
      </p>
      <p>
       To find a certificate, use Get-PfxCertificate or use the Get-ChildItem cmdlet in the Certificate (Cert:) drive.
If the certificate is not valid or does not have code-signing authority, the command fails.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          X509Certificate2
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         1
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Content
     </div>
     <div class="parameterInfo">
      <p>
       To find a certificate, use Get-PfxCertificate or use the Get-ChildItem cmdlet in the Certificate (Cert:) drive.
If the certificate is not valid or does not have code-signing authority, the command fails.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          Byte[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -FilePath
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the path to a file that is being signed.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         0
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName, ByValue)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -LiteralPath
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the path to a file that is being signed.
Unlike
       <em>
        FilePath
       </em>
       , the value of the
       <em>
        LiteralPath
       </em>
       parameter is used exactly as it is typed.
No characters are interpreted as wildcards.
If the path includes escape characters, enclose it in single quotation marks.
Single quotation marks tell Windows PowerShell not to interpret any characters as escape sequences.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         PSPath
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -SourcePathOrExtension
     </div>
     <div class="parameterInfo">
      <p>
       To find a certificate, use Get-PfxCertificate or use the Get-ChildItem cmdlet in the Certificate (Cert:) drive.
If the certificate is not valid or does not have code-signing authority, the command fails.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName, ByValue)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -Confirm
     </div>
     <div class="parameterInfo">
      <p>
       Prompts you for confirmation before running the cmdlet.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         cf
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Force
     </div>
     <div class="parameterInfo">
      <p>
       Allows the cmdlet to append a signature to a read-only file.
Even using the
       <em>
        Force
       </em>
       parameter, the cmdlet cannot override security restrictions.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -HashAlgorithm
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the hashing algorithm that Windows uses to compute the digital signature for the file.
      </p>
      <p>
       For Windows PowerShell 3.0, the default is SHA-256, which is the Windows default hashing algorithm.
For Windows PowerShell 2.0, the default is SHA-1.
Files that are signed with a different hashing algorithm might not be recognized on other systems.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -IncludeChain
     </div>
     <div class="parameterInfo">
      <p>
       Determines which certificates in the certificate trust chain are included in the digital signature.
NotRoot is the default.
The acceptable values for this parameter are:
      </p>
      <ul>
       <li>
        Signer.
Includes only the signer's certificate.
       </li>
       <li>
        NotRoot.
Includes all of the certificates in the certificate chain, except for the root authority.
       </li>
       <li>
        All.
Includes all the certificates in the certificate chain.
       </li>
      </ul>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Parameter Sets:
        </td>
        <td>
         signer, notroot, all
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -TimestampServer
     </div>
     <div class="parameterInfo">
      <p>
       Uses the specified time stamp server to add a time stamp to the signature.
Type the URL of the time stamp server as a string.
      </p>
      <p>
       The time stamp represents the exact time that the certificate was added to the file.
A time stamp prevents the script from failing if the certificate expires because users and programs can verify that the certificate was valid at the time of signing.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -WhatIf
     </div>
     <div class="parameterInfo">
      <p>
       Shows what would happen if the cmdlet runs.
The cmdlet is not run.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         wi
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       System.String
      </strong>
     </p>
     <p>
      You can pipe a string that contains the file path to
      <strong>
       Set-AuthenticodeSignature
      </strong>
      .
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       System.Management.Automation.Signature
      </strong>
     </p>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="relative-path" href="get-authenticodesignature.html">
        Get-AuthenticodeSignature
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="get-executionpolicy.html">
        Get-ExecutionPolicy
       </a>
      </li>
      <li>
       <a data-linktype="external" href="https://msdn.microsoft.com/en-us/powershell/reference/5.1/Microsoft.PowerShell.Security/Get-PfxCertificate">
        Get-PfxCertificate
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="set-executionpolicy.html">
        Set-ExecutionPolicy
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <div class="note alert feedback-system-change-alert">
     <p>
      Note
     </p>
     <p>
      The feedback system for this content will be changing soon. Old comments will not be carried over. If content within a comment thread is important to you, please save a copy. For more information on the upcoming change,
      <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
       we invite you to read our blog post
      </a>
      .
     </p>
    </div>
    <div data-bi-name="comments" id="comments-container" role="form">
    </div>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>