<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Compress-Archive (Microsoft.PowerShell.Archive)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Compress-Archive (Microsoft.PowerShell.Archive)" name="twitter:title"/>
  <meta content="The Compress-Archive cmdlet creates a zipped (or compressed) archive file from one or more specified files or folders. An archive file allows multiple files to be packaged, and optionally compressed,â¦" name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="The Compress-Archive cmdlet creates a zipped (or compressed) archive file from one or more specified files or folders. An archive file allows multiple files to be packaged, and optionally compressed,â¦" name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="PowerShell_PowerShell-docs_reference" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="PowerShell" name="search.ms_product"/>
  <meta content="PowerShell.PowerShell_PowerShell-docs_reference" name="depot_name"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/07245fd62201a5a0afb220d8ec0bc9475f35a138/reference/6/Microsoft.PowerShell.Archive/Compress-Archive.md" name="ref_skeleton_gitcommit"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/live/reference/6/Microsoft.PowerShell.Archive/Compress-Archive.md" name="original_ref_skeleton_git_url"/>
  <meta content="2018-03-29 05:21 PM" name="updated_at"/>
  <meta content="1e67ee59-8a3e-59ad-7c8d-a78605f55b66" name="document_id"/>
  <meta content="3c8b8ee9-6a97-4eda-d184-49e728abf0a6" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="06/09/2017" name="ms.date"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="powershell,cmdlet" name="keywords"/>
  <meta content="http://go.microsoft.com/fwlink/?LinkId=821654" name="online_version"/>
  <meta content="Microsoft.PowerShell.Archive-help.xml" name="external_help_file"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="sdwheeler" name="author"/>
  <meta content="sewhee" name="ms.author"/>
  <meta content="carmonm" name="manager"/>
  <meta content="/powershell/bread-pscore/toc.yml?view=powershell-6" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="windows, macos, linux" name="ms.tgt_pltfr"/>
  <meta content="powershell-scripting" name="ms.technology"/>
  <meta content="powershell" name="ms.prod"/>
  <meta content="MSDocsHeader-Powershell" name="uhfHeaderId"/>
  <meta content="../psdocs/toc.json?view=powershell-6" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.archive/compress-archive" rel="canonical"/>
  <title>
   Compress-Archive
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/60aac04b.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/fdb8a38a.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Compress-Archive
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./Microsoft.PowerShell.Archive.html">
         Microsoft.PowerShell.Archive
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Creates an archive, or zipped file, from specified files and folders.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Compress-Archive
        [-Path] &lt;String[]&gt;
        [-DestinationPath] &lt;String&gt;
        [-CompressionLevel &lt;String&gt;]
        [-WhatIf]
        [-Confirm]
        [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Compress-Archive
        [-Path] &lt;String[]&gt;
        [-DestinationPath] &lt;String&gt;
        [-CompressionLevel &lt;String&gt;]
        [-Update]
        [-WhatIf]
        [-Confirm]
        [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Compress-Archive
        [-Path] &lt;String[]&gt;
        [-DestinationPath] &lt;String&gt;
        [-CompressionLevel &lt;String&gt;]
        [-Force]
        [-WhatIf]
        [-Confirm]
        [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Compress-Archive
        -LiteralPath &lt;String[]&gt;
        [-DestinationPath] &lt;String&gt;
        [-CompressionLevel &lt;String&gt;]
        [-Update]
        [-WhatIf]
        [-Confirm]
        [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Compress-Archive
        -LiteralPath &lt;String[]&gt;
        [-DestinationPath] &lt;String&gt;
        [-CompressionLevel &lt;String&gt;]
        [-Force]
        [-WhatIf]
        [-Confirm]
        [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Compress-Archive
        -LiteralPath &lt;String[]&gt;
        [-DestinationPath] &lt;String&gt;
        [-CompressionLevel &lt;String&gt;]
        [-WhatIf]
        [-Confirm]
        [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <code>
       Compress-Archive
      </code>
      cmdlet creates a zipped (or compressed) archive file from one or more specified files or folders.
An archive file allows multiple files to be packaged, and optionally compressed, into a single zipped file for easier distribution and storage.
An archive file can be compressed by using the compression algorithm specified by the CompressionLevel parameter.
     </p>
     <p>
      Because
      <code>
       Compress-Archive
      </code>
      relies upon the Microsoft .NET Framework API
      <code>
       System.IO.Compression.ZipArchive
      </code>
      to compress files, the maximum file size that you can compress by using
      <code>
       Compress-Archive
      </code>
      is currently 2 GB.
This is a limitation of the underlying API.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Create an archive file
      </strong>
     </p>
     <pre><code class="lang-powershell">Compress-Archive -LiteralPath C:\Reference\Draftdoc.docx, C:\Reference\Images\diagram2.vsd -CompressionLevel Optimal -DestinationPath C:\Archives\Draft.Zip</code></pre>
     <p>
      This command creates a new archive file, Draft.zip, by compressing two files, Draftdoc.docx and diagram2.vsd, specified by the
      <strong>
       LiteralPath
      </strong>
      parameter.
The compression level specified for this operation is Optimal.
     </p>
     <p>
      <strong>
       Example 2: Create an archive with wildcard characters
      </strong>
     </p>
     <pre><code class="lang-powershell">Compress-Archive -Path C:\Reference\* -CompressionLevel Fastest -DestinationPath C:\Archives\Draft</code></pre>
     <p>
      This command creates a new archive file, Draft.zip, in the C:\Archives folder.
Note that though the file name extension .zip was not added to the value of the
      <strong>
       DestinationPath
      </strong>
      parameter, Windows PowerShell appends this to the specified archive file name automatically.
The new archive file contains every file in the C:\Reference folder, because a wildcard character was used in place of specific file names in the
      <strong>
       Path
      </strong>
      parameter.
The specified compression level is Fastest, which might result in a larger output file, but compresses a large number of files faster.
     </p>
     <p>
      <strong>
       Example 3: Update an existing archive file
      </strong>
     </p>
     <pre><code class="lang-powershell">Compress-Archive -Path C:\Reference\* -Update -DestinationPath C:\Archives\Draft.Zip</code></pre>
     <p>
      This command updates an existing archive file, Draft.Zip, in the C:\Archives folder.
The command is run to update Draft.Zip with newer versions of existing files that came from the C:\Reference folder, and also to add new files that have been added to C:\Reference since Draft.Zip was initially created.
     </p>
     <p>
      <strong>
       Example 4: Create an archive from an entire folder
      </strong>
     </p>
     <pre><code class="lang-powershell">Compress-Archive -Path C:\Reference -DestinationPath C:\Archives\Draft</code></pre>
     <p>
      This command creates an archive from an entire folder, C:\Reference.
Note that though the file name extension .zip was not added to the value of the
      <strong>
       DestinationPath
      </strong>
      parameter, Windows PowerShell appends this to the specified archive file name automatically.
     </p>
     <h2 id="required-parameters">
      Required Parameters
     </h2>
     <div class="parameterName stack">
      -DestinationPath
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the path to the archive output file.
This parameter is required.
The specified
       <strong>
        DestinationPath
       </strong>
       value should include the desired name of the output zipped file; it specifies either the absolute or relative path to the zipped file.
If the file name specified in
       <strong>
        DestinationPath
       </strong>
       does not have a .zip file name extension, the cmdlet adds a .zip file name extension.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         2
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Force
     </div>
     <div class="parameterInfo">
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -LiteralPath
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the path or paths to the files that you want to add to the archive zipped file.
Unlike the
       <strong>
        Path
       </strong>
       parameter, the value of
       <strong>
        LiteralPath
       </strong>
       is used exactly as it is typed.
No characters are interpreted as wildcards.
If the path includes escape characters, enclose each escape character in single quotation marks, to instruct Windows PowerShell not to interpret any characters as escape sequences.
To specify multiple paths, and include files in multiple locations in your output zipped file, use commas to separate the paths.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         PSPath
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Path
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the path or paths to the files that you want to add to the archive zipped file.
This parameter can accept wildcard characters.
Wildcard characters allow you to add all files in a folder to your zipped archive file.
To specify multiple paths, and include files in multiple locations in your output zipped file, use commas to separate the paths.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         1
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName, ByValue)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Update
     </div>
     <div class="parameterInfo">
      <p>
       Updates the specified archive by replacing older versions of files in the archive with newer versions of files that have the same names.
You can also add this parameter to add files to an existing archive.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -CompressionLevel
     </div>
     <div class="parameterInfo">
      <p>
       Specifies how much compression to apply when you are creating the archive file.
Faster compression requires less time to create the file, but can result in larger file sizes.
The acceptable values for this parameter are:
      </p>
      <ul>
       <li>
        Fastest.
Use the fastest compression method available to decrease processing time; this can result in larger file sizes.
       </li>
       <li>
        NoCompression.
Do not compress the source files.
       </li>
       <li>
        Optimal.
Processing time is dependent on file size.
       </li>
      </ul>
      <p>
       If this parameter is not specified, the command uses the default value, Optimal.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Confirm
     </div>
     <div class="parameterInfo">
      <p>
       Prompts you for confirmation before running the cmdlet.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         cf
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -WhatIf
     </div>
     <div class="parameterInfo">
      <p>
       Shows what would happen if the cmdlet runs.
The cmdlet is not run.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         wi
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       System.String
      </strong>
     </p>
     <p>
      You can pipe a string that contains a path to one or more files.
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       System.IO.FileInfo
      </strong>
     </p>
     <h2 id="notes">
      Notes
     </h2>
     <h2 id="related-links">
      RELATED LINKS
     </h2>
     <!-- </content> -->
    </main>
    <div class="note alert feedback-system-change-alert">
     <p>
      Note
     </p>
     <p>
      The feedback system for this content will be changing soon. Old comments will not be carried over. If content within a comment thread is important to you, please save a copy. For more information on the upcoming change,
      <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
       we invite you to read our blog post
      </a>
      .
     </p>
    </div>
    <div data-bi-name="comments" id="comments-container" role="form">
    </div>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>