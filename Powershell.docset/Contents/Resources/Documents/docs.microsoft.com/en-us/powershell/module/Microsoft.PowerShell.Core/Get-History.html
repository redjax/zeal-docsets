<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Get-History (Microsoft.PowerShell.Core)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Get-History (Microsoft.PowerShell.Core)" name="twitter:title"/>
  <meta content="The Get-History cmdlet gets the session history, that is, the list of commands entered during the current session. Windows PowerShell automatically maintains a history of each session. The number ofâ¦" name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="The Get-History cmdlet gets the session history, that is, the list of commands entered during the current session. Windows PowerShell automatically maintains a history of each session. The number ofâ¦" name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="PowerShell_PowerShell-docs_reference" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="PowerShell" name="search.ms_product"/>
  <meta content="PowerShell.PowerShell_PowerShell-docs_reference" name="depot_name"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/6a6d85dfc6556f4605f45163661aeed4e68cf400/reference/6/Microsoft.PowerShell.Core/Get-History.md" name="ref_skeleton_gitcommit"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/live/reference/6/Microsoft.PowerShell.Core/Get-History.md" name="original_ref_skeleton_git_url"/>
  <meta content="2018-03-30 03:35 PM" name="updated_at"/>
  <meta content="4d5f232f-19a1-2922-55dd-d03bb6499d3d" name="document_id"/>
  <meta content="40a9c56c-3f44-cd88-5e19-ae55353076fb" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="06/09/2017" name="ms.date"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="powershell,cmdlet" name="keywords"/>
  <meta content="http://go.microsoft.com/fwlink/?LinkId=821484" name="online_version"/>
  <meta content="System.Management.Automation.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="sdwheeler" name="author"/>
  <meta content="sewhee" name="ms.author"/>
  <meta content="carmonm" name="manager"/>
  <meta content="/powershell/bread-pscore/toc.yml?view=powershell-6" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="windows, macos, linux" name="ms.tgt_pltfr"/>
  <meta content="powershell-scripting" name="ms.technology"/>
  <meta content="powershell" name="ms.prod"/>
  <meta content="MSDocsHeader-Powershell" name="uhfHeaderId"/>
  <meta content="../psdocs/toc.json?view=powershell-6" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/get-history" rel="canonical"/>
  <title>
   Get-History
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/60aac04b.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/fdb8a38a.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Get-History
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./Microsoft.PowerShell.Core.html">
         Microsoft.PowerShell.Core
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Gets a list of the commands entered during the current session.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Get-History
   [[-Id] &lt;Int64[]&gt;]
   [[-Count] &lt;Int32&gt;]
   [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Get-History
      </strong>
      cmdlet gets the session history, that is, the list of commands entered during the current session.
     </p>
     <p>
      Windows PowerShell automatically maintains a history of each session.
The number of entries in the session history is determined by the value of the $MaximumHistoryCount preference variable.
Beginning in Windows PowerShell 3.0, the default value is 4096.
     </p>
     <p>
      You can save the session history in XML or CSV format.
By default, history files are saved in the home directory, but you can save the file in any location.
     </p>
     <p>
      For more information about the history features in Windows PowerShell, see about_History (
      <a data-linktype="external" href="http://go.microsoft.com/fwlink/?LinkID=113233">
       http://go.microsoft.com/fwlink/?LinkID=113233
      </a>
      ) in the Microsoft TechNet library.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Get the session history
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-History</code></pre>
     <p>
      This command gets the entries in the session history.
The default display shows each command and its ID, which indicates the order in which they ran.
     </p>
     <p>
      <strong>
       Example 2: Get entries that include a string
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-History | Where-Object {$_.CommandLine -like "*Service*"}</code></pre>
     <p>
      This command gets entries in the command history that include the string service.
The first command gets all entries in the session history.
The pipeline operator (|) passes the results to the Where-Object cmdlet, which selects only the commands that include service.
     </p>
     <p>
      <strong>
       Example 3: Export at most seven entries
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-History -ID 7 -Count 5 | Export-Csv History.csv</code></pre>
     <p>
      This command gets the five most recent history entries ending with entry 7.
The pipeline operator passes the result to the Export-Csv cmdlet, which formats the history as comma-separated text and saves it in the History.csv file.
The file includes the data that is displayed when you format the history as a list.
This includes the status and start and end times of the command.
     </p>
     <p>
      <strong>
       Example 4: Display the most recent command
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-History -Count 1</code></pre>
     <p>
      This command gets the last command in the command history.
The last command is the most recently entered command.
This command uses the
      <em>
       Count
      </em>
      parameter to display just one command.
By default,
      <strong>
       Get-History
      </strong>
      gets the most recent commands.
This command can be abbreviated to "h -c 1" and is equivalent to pressing the up-arrow key.
     </p>
     <p>
      <strong>
       Example 5: Display all the properties of the entries in the history
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-History | Format-List -Property *</code></pre>
     <p>
      This command displays all of the properties of entries in the session history.
The pipeline operator passes the results of a
      <strong>
       Get-History
      </strong>
      command to the Format-List cmdlet, which displays all of the properties of each history entry.
This includes the ID, status, and start and end times of the command.
     </p>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -Count
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the number of the most recent history entries that this cmdlet gets.
By, default,
       <strong>
        Get-History
       </strong>
       gets all entries in the session history.
If you use both the
       <em>
        Count
       </em>
       and
       <em>
        Id
       </em>
       parameters in a command, the display ends with the command that is specified by the
       <em>
        Id
       </em>
       parameter.
      </p>
      <p>
       In Windows PowerShell 2.0, by default,
       <strong>
        Get-History
       </strong>
       gets the 32 most recent entries.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          Int32
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         1
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Id
     </div>
     <div class="parameterInfo">
      <p>
       Specifies an array of the IDs of entries in the session history.
       <strong>
        Get-History
       </strong>
       gets only specified entries.
If you use both the
       <em>
        Id
       </em>
       and
       <em>
        Count
       </em>
       parameters in a command,
       <strong>
        Get-History
       </strong>
       gets the most recent entries ending with the entry specified by the
       <em>
        Id
       </em>
       parameter.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          Int64[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         0
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByValue)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       Int64
      </strong>
     </p>
     <p>
      You can pipe a history ID to this cmdlet.
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       Microsoft.PowerShell.Commands.HistoryInfo
      </strong>
     </p>
     <p>
      This cmdlet returns a history object for each history item that it gets.
     </p>
     <h2 id="notes">
      Notes
     </h2>
     <ul>
      <li>
       The session history is a list of the commands entered during the session. The session history represents the run order, the status, and the start and end times of the command. As you enter each command, Windows PowerShell adds it to the history so that you can reuse it. For more information about the command history, see about_History.
      </li>
      <li>
       Starting in Windows PowerShell 3.0, the default value of the $MaximumHistoryCount preference variable is 4096. In Windows PowerShell 2.0, the default value is 64. For more information about the $MaximumHistoryCount variable, see
       <a data-linktype="relative-path" href="about/about_preference_variables.html">
        about_Preference_Variables
       </a>
       in the TechNet library.
      </li>
     </ul>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="relative-path" href="add-history.html">
        Add-History
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="clear-history.html">
        Clear-History
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="invoke-history.html">
        Invoke-History
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <div class="note alert feedback-system-change-alert">
     <p>
      Note
     </p>
     <p>
      The feedback system for this content will be changing soon. Old comments will not be carried over. If content within a comment thread is important to you, please save a copy. For more information on the upcoming change,
      <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
       we invite you to read our blog post
      </a>
      .
     </p>
    </div>
    <div data-bi-name="comments" id="comments-container" role="form">
    </div>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>