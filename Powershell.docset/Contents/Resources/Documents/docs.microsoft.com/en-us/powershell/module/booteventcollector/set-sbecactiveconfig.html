<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Set-SbecActiveConfig (booteventcollector)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Set-SbecActiveConfig (booteventcollector)" name="twitter:title"/>
  <meta content="Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell." name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell." name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="powershell-windows" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="MSDN" name="search.ms_product"/>
  <meta content="MSDN.powershell-windows" name="depot_name"/>
  <meta content="https://cpubwin.visualstudio.com/DefaultCollection/powershell/_git/powershell/commit/ced7757924addcaea0b7a244ae4d240e4d28d93a?path=%2fdocset%2fwindows%2fbooteventcollector%2fset-sbecactiveconfig.md&amp;_a=contents" name="ref_skeleton_gitcommit"/>
  <meta content="https://cpubwin.visualstudio.com/DefaultCollection/powershell/_git/powershell?path=%2fdocset%2fwindows%2fbooteventcollector%2fset-sbecactiveconfig.md&amp;version=GBlive&amp;_a=contents" name="original_ref_skeleton_git_url"/>
  <meta content="2017-09-15 03:44 AM" name="updated_at"/>
  <meta content="e3fddda8-f55c-e431-0398-ea9f44f9f4a5" name="document_id"/>
  <meta content="be97fc57-e275-d1e3-e9f0-52514baaf2c2" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="manage" name="ms.mktglfcycl"/>
  <meta content="library" name="ms.sitesec"/>
  <meta content="brianlic" name="ms.author"/>
  <meta content="brianlic-msft" name="author"/>
  <meta content="BootEventCollector-help.xml" name="external_help_file"/>
  <meta content="powershell, cmdlet" name="keywords"/>
  <meta content="alanth" name="manager"/>
  <meta content="12/20/2016" name="ms.date"/>
  <meta content="w10" name="ms.prod"/>
  <meta content="powershell-windows" name="ms.technology"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="" name="online_version"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="0D9E3E5F-2E41-4695-82A3-420DCAD727EF" name="ms.assetid"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="/powershell/windows/bread/toc.json?view=win10-ps" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="MSDocsHeader-WindowsIT" name="uhfHeaderId"/>
  <meta content="../win10-ps/toc.json?view=win10-ps" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/booteventcollector/set-sbecactiveconfig" rel="canonical"/>
  <title>
   Set-SbecActiveConfig
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/e4a1f3a3.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/31353636.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Set-Sbec
      <wbr/>
      Active
      <wbr/>
      Config
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./.html">
         booteventcollector
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Sets the new active configuration for the running Setup and Boot Event Collector.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Set-SbecActiveConfig
   [-Content] &lt;String[]&gt;
   [[-OldTimestamp] &lt;UInt64&gt;]
   [-Continue]
   [[-ComputerName] &lt;String[]&gt;]
   [[-CimSession] &lt;CimSession[]&gt;]
   [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Set-SbecActiveConfig
      </strong>
      cmdlet sets the new active configuration for the running Setup and Boot Event Collector.
     </p>
     <p>
      The new configuration is checked for validity, and on success is applied to both the running collector instance and its active configuration file, so that the configuration is remembered and used even after the system restarts.
The previous configuration is saved in a backup file, which enables you to undo any changes.
     </p>
     <p>
      You can use Get-SbecActiveConfig and
      <strong>
       Set-SbecActiveConfig
      </strong>
      to modify the configuration atomically, as follows:
     </p>
     <p>
      1.
Get the old configuration text and timestamp with
      <strong>
       Get-SbecActiveConfig
      </strong>
      . 
2.
Modify the configuration text. 
3.
Pass the text and timestamp (using the
      <em>
       OldTimestamp
      </em>
      parameter) to
      <strong>
       Set-SbecActiveConfig
      </strong>
      .
If the
      <em>
       OldTimestamp
      </em>
      parameter is specified, the Collector checks whether the active configuration was changed in between.
     </p>
     <p>
      If this check succeeds, the new configuration is applied; otherwise, an error is returned.
     </p>
     <p>
      If the previous configuration was restored from a backup file (for example, by Undo-SbecActiveConfig), it also has the original timestamp when that configuration was originally set, and its normal timestamp is the time when it was restored.
You can use Get-SbecBackupConfig to get the original timestamp.
For such a configuration, the OldTimestamp parameter of
      <strong>
       Set-SbecActiveConfig
      </strong>
      may match either the normal or original timestamp of the previous configuration.
     </p>
     <p>
      The text of the configuration becomes normalized before the configuration is set by removing all the carriage return (
      <code>
       \r
      </code>
      ) characters and by removing any empty lines at the end of configuration.
The carriage return characters are inserted appropriately when the configuration is saved to the file for persistence.
     </p>
     <p>
      You must have Builtin Administrator privilege to run this cmdlet.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Set the active configuration
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Set-SbecActiveConfig -Content $NewConfig | Format-List</code></pre>
     <p>
      This command sets the configuration and throws on error.
Format-List formats the returned information.
     </p>
     <p>
      <strong>
       Example 2: Set the active configuration from a file
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-Content MyConfig.xml | Set-SbecActiveConfig -Continue | Format-List</code></pre>
     <p>
      This command sets the configuration and does not throw on error.
Format-List formats the returned information.
     </p>
     <p>
      <strong>
       Example 3: Set the configuration as an atomic modification
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; do { $prev = Get-SbecActiveConfig; $res = Set-SbecActiveConfig -Content (Modify-MyConfig $prev.Content) -OldTimestamp $prev.Timestamp -Continue } while ($res.ErrorType -eq 5); if ($res.Success) { ... } else { ... }</code></pre>
     <p>
      This command sets the new configuration as an atomic modification of the previous configuration.
     </p>
     <p>
      If the atomicity is broken, the code re-tries by getting the new configuration and modifying it again.
     </p>
     <h2 id="required-parameters">
      Required Parameters
     </h2>
     <div class="parameterName stack">
      -Content
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the configuration to set as active.
The acceptable values for this parameter are:
      </p>
      <ul>
       <li>
        A multiline string.
Use
        <code>
         \n
        </code>
        to indicate line breaks.
       </li>
       <li>
        An array of one-line strings.
This cmdlet merges the array.
       </li>
       <li>
        A mix of multiline strings and string arrays.
       </li>
      </ul>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         0
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByValue)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -CimSession
     </div>
     <div class="parameterInfo">
      <p>
       Runs the cmdlet on the remote computers through a remote session.
Enter a session object, such as the output of a
       <strong>
        New-CimSession
       </strong>
       or
       <strong>
        Get-CimSession
       </strong>
       cmdlet or an array of these objects.
The default is to run the cmdlet on the local computer.
For more information, see About_CimSession.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          CimSession[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         3
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -ComputerName
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the names of the computers on which you want to perform the operation.
You can specify a fully qualified domain name (FQDN), a NetBIOS name, or an IP address for each computer.
For more information see
       <a data-linktype="external" href="http://go.microsoft.com/fwlink/?LinkId=808801">
        Invoke-CimMethod
       </a>
       on MSDN.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         2
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Continue
     </div>
     <div class="parameterInfo">
      <p>
       Specifies that this operation will not throw an exception if a failure occurs.
Instead the caller should examine the output of the cmdlet for the error information.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -OldTimestamp
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the timestamp of the previous active configuration.
This provides a way to perform the atomic changes of the configuration.
Each configuration has a timestamp (the time when it was last set or restored) and an original timestamp (if the configuration was restored, the time when it was originally set, otherwise the same as the normal timestamp).
This operation checks that the
       <em>
        OldTimestamp
       </em>
       value matches either the normal or original timestamp of the current active configuration thus ensuring that the active configuration wasn't changed since the last time you have looked at it.
If the values do not match, an error is returned.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          UInt64
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         1
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       string[]
      </strong>
     </p>
     <p>
      The text of the configuration, same as in the
      <em>
       Content
      </em>
      parameter.
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       hash table
      </strong>
     </p>
     <p>
      The hash table includes the following elements:
     </p>
     <ul>
      <li>
       Success
      </li>
      <li>
       NewTimestamp
      </li>
      <li>
       ErrorType
      </li>
      <li>
       ErrorString
      </li>
      <li>
       WarningString
      </li>
      <li>
       InfoString
      </li>
     </ul>
     <p>
      The
      <code>
       &lt;ErrorType&gt;
      </code>
      element contains 0 on success.
If a failure occurs,
      <code>
       &lt;ErrorType&gt;
      </code>
      has a code that describes the error:
     </p>
     <ul>
      <li>
       1 (bad argument format)
      </li>
      <li>
       2 (bad argument value)
      </li>
      <li>
       3 (resource (socket) open error)
      </li>
      <li>
       4 (persistence (backup configuration file) error)
      </li>
      <li>
       5 (atomicity error (that is, the old timestamp does not match)
      </li>
     </ul>
     <p>
      The Success element is $True on success, $False otherwise.
     </p>
     <p>
      The
      <code>
       &lt;NewTimeStamp&gt;
      </code>
      element contains the timestamp of the newly restored configuration, that is, the time when it was restored, if this operation is successful, the current original timestamp if the timestamp check fails, or $Null on other failures.
     </p>
     <p>
      ErrorString, WarningString, and InfoString contain detailed error messages.
      <code>
       &lt;ErrorString&gt;
      </code>
      contains information only if an error occurs.
     </p>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="relative-path" href="./get-sbecactiveconfig.html">
        Get-SbecActiveConfig
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="./restore-sbecbackupconfig.html">
        Restore-SbecBackupConfig
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="./test-sbecactiveconfig.html">
        Test-SbecActiveConfig
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="./test-sbecconfig.html">
        Test-SbecConfig
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="./undo-sbecactiveconfig.html">
        Undo-SbecActiveConfig
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <section class="feedback-section" data-bi-name="feedback-section">
     <h2 id="feedback">
      Feedback
     </h2>
     <div class="alert choose-feedback-type">
      <p>
       We'd love to hear your thoughts. Choose the type you'd like to provide:
      </p>
      <div class="choose-feedback-buttons">
       <a class="button-border feedback-type-product" data-bi-name="product-feedback" href="https://windowsserver.uservoice.com/forums/301869-powershell">
        Product feedback
        <span aria-hidden="true" class="docon docon-navigate-external">
        </span>
       </a>
       <div class="button-group">
        <button class="button-border feedback-sign-in-button" data-bi-name="feedback-sign-in">
         <span aria-hidden="true" class="docon docon-brand-github">
         </span>
         Sign in to give documentation feedback
        </button>
        <button aria-controls="feedback-form" aria-expanded="false" class="button-border feedback-form-toggle" data-bi-name="documentation-feedback" hidden="">
         Content feedback
        </button>
        <div auto-align="" class="dropdown has-caret">
         <button aria-controls="fbm0" aria-expanded="false" aria-haspopup="true" aria-label="Expand documentation feedback menu" class="button-border dropdown-trigger" data-bi-name="documentation-feedback-menu">
          <span aria-hidden="true" class="docon docon-chevron-down-light">
          </span>
         </button>
         <div class="dropdown-menu documentation-feedback-menu" id="fbm0" role="menu">
          You may also leave feedback
          <a data-bi-name="create-issue-on-github" href="{0}">
           directly on GitHub
           <span aria-hidden="true" class="docon docon-navigate-external">
           </span>
          </a>
          .
         </div>
        </div>
       </div>
      </div>
      <p>
       <small>
        Our new feedback system is built on GitHub Issues. Read about this change in
        <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
         our blog post
        </a>
        .
       </small>
      </p>
     </div>
     <form accept-charset="UTF-8" action="javascript:" autocomplete="off" class="feedback-form" hidden="" id="feedback-form">
      <h3 class="feedback-form-heading current-user">
       <img alt="Avatar" aria-hidden="true" class="avatar" height="36" width="36"/>
       <span aria-hidden="true" class="username">
       </span>
       <span class="visually-hidden">
        Liquid error: Can't find the localized string giveDocumentationFeedback for template Conceptual.
       </span>
      </h3>
      <label>
       <span class="visually-hidden">
        Title
       </span>
       <input name="title" pattern=".*\w.*" placeholder="Title" required="" type="text"/>
      </label>
      <label>
       <span class="visually-hidden">
        Leave a comment
       </span>
       <textarea name="body" placeholder="Leave a comment" required=""></textarea>
      </label>
      <div class="action-container">
       <button class="primary-action" name="submit" type="submit">
        Submit feedback
       </button>
      </div>
     </form>
     <div class="feedback-status alert busy" role="alert">
      <p>
       Loading feedback...
      </p>
     </div>
     <div class="feedback-tab-group tabGroup" data-tab-group-independent="" hidden="">
      <ul role="tablist">
       <li role="presentation">
        <a aria-controls="tabpanel-issues-open" aria-label="Open Issues" data-tab="issues-open" href="#tabpanel-issues-open" role="tab">
        </a>
       </li>
       <li role="presentation">
        <a aria-controls="tabpanel-issues-closed" aria-label="Closed Issues" data-tab="issues-closed" href="#tabpanel-issues-closed" role="tab">
        </a>
       </li>
      </ul>
      <section data-tab="issues-open" id="tabpanel-issues-open" role="tabpanel">
       <div class="no-issues-placeholder">
        There are no open issues
       </div>
       <ul aria-label="Open Issues" class="github-issues-list">
       </ul>
      </section>
      <section data-tab="issues-closed" id="tabpanel-issues-closed" role="tabpanel">
       <div class="no-issues-placeholder">
        There are no closed issues
       </div>
       <ul aria-label="Closed Issues" class="github-issues-list">
       </ul>
      </section>
     </div>
     <div class="action-container">
      <a class="view-on-github" data-bi-name="view-on-github" hidden="" href="https://github.com/MicrosoftDocs/windows-powershell-docs/issues">
       <span aria-hidden="true" class="docon docon-brand-github">
       </span>
       <span>
        View on GitHub
       </span>
       <span aria-hidden="true" class="docon docon-navigate-external">
       </span>
      </a>
     </div>
    </section>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>