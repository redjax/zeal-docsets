<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Get-PSDrive (Microsoft.PowerShell.Management)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Get-PSDrive (Microsoft.PowerShell.Management)" name="twitter:title"/>
  <meta content="The Get-PSDrive cmdlet gets the drives in the current session. You can get a particular drive or all drives in the session. This cmdlet gets the following types of drives:  Windows logical drives onâ¦" name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="The Get-PSDrive cmdlet gets the drives in the current session. You can get a particular drive or all drives in the session. This cmdlet gets the following types of drives:  Windows logical drives onâ¦" name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="PowerShell_PowerShell-docs_reference" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="PowerShell" name="search.ms_product"/>
  <meta content="PowerShell.PowerShell_PowerShell-docs_reference" name="depot_name"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/158b56ade9f1c5ec3467d3351c67f1850001ba83/reference/6/Microsoft.PowerShell.Management/Get-PSDrive.md" name="ref_skeleton_gitcommit"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/live/reference/6/Microsoft.PowerShell.Management/Get-PSDrive.md" name="original_ref_skeleton_git_url"/>
  <meta content="2018-06-04 07:21 PM" name="updated_at"/>
  <meta content="465e03df-5516-036c-7496-4ecfcb15ad79" name="document_id"/>
  <meta content="de2cff8a-e09e-65bd-b937-29f6eebc6d21" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="06/09/2017" name="ms.date"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="powershell,cmdlet" name="keywords"/>
  <meta content="http://go.microsoft.com/fwlink/?linkid=821591" name="online_version"/>
  <meta content="Microsoft.PowerShell.Commands.Management.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="sdwheeler" name="author"/>
  <meta content="sewhee" name="ms.author"/>
  <meta content="carmonm" name="manager"/>
  <meta content="/powershell/bread-pscore/toc.yml?view=powershell-6" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="windows, macos, linux" name="ms.tgt_pltfr"/>
  <meta content="powershell-scripting" name="ms.technology"/>
  <meta content="powershell" name="ms.prod"/>
  <meta content="MSDocsHeader-Powershell" name="uhfHeaderId"/>
  <meta content="../psdocs/toc.json?view=powershell-6" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-psdrive" rel="canonical"/>
  <title>
   Get-PSDrive
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/60aac04b.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/fdb8a38a.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Get-PSDrive
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./Microsoft.PowerShell.Management.html">
         Microsoft.PowerShell.Management
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Gets drives in the current session.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Get-PSDrive
   [[-Name] &lt;String[]&gt;]
   [-Scope &lt;String&gt;]
   [-PSProvider &lt;String[]&gt;]
   [-UseTransaction]
   [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Get-PSDrive
   [-LiteralName] &lt;String[]&gt;
   [-Scope &lt;String&gt;]
   [-PSProvider &lt;String[]&gt;]
   [-UseTransaction]
   [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Get-PSDrive
      </strong>
      cmdlet gets the drives in the current session.
You can get a particular drive or all drives in the session.
     </p>
     <p>
      This cmdlet gets the following types of drives:
     </p>
     <ul>
      <li>
       Windows logical drives on the computer, including drives mapped to network shares.
      </li>
      <li>
       Drives exposed by Windows PowerShell providers (such as the Certificate:, Function:, and Alias: drives) and the HKLM: and HKCU: drives that are exposed by the Windows PowerShell Registry provider.
      </li>
      <li>
       Session-specified temporary drives and persistent mapped network drives that you create by using the New-PSDrive cmdlet.
      </li>
     </ul>
     <p>
      Beginning in Windows PowerShell 3.0, the
      <em>
       Persist
      </em>
      parameter of the
      <strong>
       New-PSDrive
      </strong>
      cmdlet can create mapped network drives that are saved on the local computer and are available in other sessions.
For more information, see New-PSDrive.
     </p>
     <p>
      Also, beginning in Windows PowerShell 3.0, when an external drive is connected to the computer, Windows PowerShell automatically adds a PSDrive to the file system that represents the new drive.
You do not need to restart Windows PowerShell.
Similarly, when an external drive is disconnected from the computer, Windows PowerShell automatically deletes the PSDrive that represents the removed drive.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Get drives in the current session
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-PSDrive



Name           Used (GB)     Free (GB) Provider      Root

----           ---------     --------- --------      ----

Alias                                  Alias

C                 202.06      23718.91 FileSystem    C:\

Cert                                   Certificate   \

D                1211.06     123642.32 FileSystem    D:\

Env                                    Environment

Function                               Function

HKCU                                   Registry      HKEY_CURRENT_USER

HKLM                                   Registry      HKEY_LOCAL_MACHINE

Variable                               Variable</code></pre>
     <p>
      This command gets the drives in the current session.
     </p>
     <p>
      The output shows the hard drive (C:), CD-ROM drive (D:), and the drives exposed by the Windows PowerShell providers (Alias:, Cert:, Env:, Function:, HKCU:, HKLM:, and Variable:).
     </p>
     <p>
      <strong>
       Example 2: Get a drive on the computer
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\foo&gt; Get-PSDrive D



Name           Used (GB)     Free (GB) Provider      Root

----           ---------     --------- --------      ----

D                1211.06     123642.32 FileSystem    D:\</code></pre>
     <p>
      This command gets the D: drive on the computer.
Note that the drive letter in the command is not followed by a colon.
     </p>
     <p>
      <strong>
       Example 3: Get all the drives that are supported by the Windows PowerShell file system provider
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-PSDrive -PSProvider FileSystem

Name           Used (GB)     Free (GB) Provider      Root

----           ---------     --------- --------      ----

A                                                    A:\

C                 202.06      23718.91 FileSystem    C:\

D                1211.06     123642.32 FileSystem    D:\

G                 202.06        710.91 FileSystem    \\Music\GratefulDead</code></pre>
     <p>
      This command gets all of the drives that are supported by the Windows PowerShell FileSystem provider.
This includes fixed drives, logical partitions, mapped network drives, and temporary drives that you create by using the New-PSDrive cmdlet.
     </p>
     <p>
      <strong>
       Example 4: Check to see if a drive is in use as a Windows PowerShell drive name
      </strong>
     </p>
     <pre><code class="lang-powershell">if (Get-PSDrive X -ErrorAction SilentlyContinue) {

	Write-Host 'The X: drive is already in use.'

} else {

	New-PSDrive -Name X -PSProvider Registry -Root HKLM:\SOFTWARE

}</code></pre>
     <p>
      This command checks to see whether the X drive is already in use as a Windows PowerShell drive name.
If it is not, the command uses the
      <code>
       New-PSDrive
      </code>
      cmdlet to create a temporary drive that is mapped to the HKLM:\SOFTWARE registry key.
     </p>
     <p>
      <strong>
       Example 5: Compare the types of files system drives
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-PSDrive -PSProvider FileSystem

Name           Used (GB)     Free (GB) Provider      Root

----           ---------     --------- --------      ----

A                                                    A:\

C                 202.06      23718.91 FileSystem    C:\

D                1211.06     123642.32 FileSystem    D:\

G                 202.06        710.91 FileSystem    \\Music\GratefulDead

X                                      Registry      HKLM:\Network



PS C:\&gt; net use

New connections will be remembered.

Status       Local     Remote                    Network

-------------------------------------------------------------------------------

OK           G:        \\Server01\Public         Microsoft Windows Network



PS C:\&gt; [System.IO.DriveInfo]::GetDrives() | Format-Table

Name DriveType DriveFormat IsReady AvailableFreeSpace TotalFreeSpace TotalSize     RootDirectory VolumeLabel

---- --------- ----------- ------- ------------------ -------------- ---------     ------------- -----------

A:\    Network               False                                                 A:\

C:\      Fixed NTFS          True  771920580608       771920580608   988877418496  C:\           Windows

D:\      Fixed NTFS          True  689684144128       689684144128   1990045179904 D:\           Big Drive

E:\      CDRom               False                                                 E:\

G:\    Network NTFS          True      69120000           69120000       104853504 G:\           GratefulDead



PS N:\&gt; Get-CimInstance -Class Win32_LogicalDisk



DeviceID DriveType ProviderName   VolumeName         Size          FreeSpace

-------- --------- ------------   ----------         ----          ---------

A:       4

C:       3                        Windows            988877418496  771926069248

D:       3                        Big!              1990045179904  689684144128

E:       5

G:       4         \\Music\GratefulDead              988877418496  771926069248





PS C:\&gt; Get-CimInstance -Class Win32_NetworkConnection

LocalName RemoteName            ConnectionState Status

--------- ----------            --------------- ------

G:        \\Music\GratefulDead  Connected       OK</code></pre>
     <p>
      This example compares the types of file system drives that are displayed by
      <strong>
       Get-PSDrive
      </strong>
      to those displayed by using other methods.
This example demonstrates different ways to display drives in Windows PowerShell, and it shows that session-specific drives created by using the New-PSDrive cmdlet are accessible only in Windows PowerShell.
     </p>
     <p>
      The first command uses
      <strong>
       Get-PSDrive
      </strong>
      to get all of the file system drives in the session.
This includes the fixed drives (C: and D:), a mapped network drive (G:) that was created by using the
      <em>
       Persist
      </em>
      parameter of
      <strong>
       New-PSDrive
      </strong>
      , and a PowerShell drive (T:) that was created by using
      <strong>
       New-PSDrive
      </strong>
      without the
      <em>
       Persist
      </em>
      parameter.
     </p>
     <p>
      The
      <strong>
       net use
      </strong>
      command displays Windows mapped network drives, in this case it displays only the G drive.
It does not display the X: drive that was created by
      <strong>
       New-PSDrive
      </strong>
      .
It shows that the G: drive is also mapped to \\Music\GratefulDead.
     </p>
     <p>
      The third command uses the
      <strong>
       GetDrives
      </strong>
      method of the Microsoft .NET Framework
      <strong>
       System.IO.DriveInfo
      </strong>
      class.
This command gets the Windows file system drives, including drive G:, but it does not get the drives created by
      <strong>
       New-PSDrive
      </strong>
      .
     </p>
     <p>
      The fourth command uses the
      <strong>
       Get-CimInstance
      </strong>
      cmdlet to get the instances of the
      <strong>
       Win32_LogicalDisk
      </strong>
      class.
It returns the A:, C:, D:, E:, and G: drives, but not the drives created by
      <strong>
       New-PSDrive
      </strong>
      .
     </p>
     <p>
      The last command uses the
      <strong>
       Get-CimInstance
      </strong>
      cmdlet to display the instances of the
      <strong>
       Win32_NetworkConnection
      </strong>
      class.
Like
      <strong>
       net use
      </strong>
      , it returns only the persistent G: drive reated by
      <strong>
       New-PSDrive
      </strong>
      .
     </p>
     <h2 id="required-parameters">
      Required Parameters
     </h2>
     <div class="parameterName stack">
      -LiteralName
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the name of the drive.
      </p>
      <p>
       The value of
       <em>
        LiteralName
       </em>
       is used exactly as it is typed.
No characters are interpreted as wildcards.
If the name includes escape characters, enclose it in single quotation marks.
Single quotation marks tell Windows PowerShell not to interpret any characters as escape sequences.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         1
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -Name
     </div>
     <div class="parameterInfo">
      <p>
       Specifies, as a string array, the name or name of drives that this cmdlet gets in the operation.
Type the drive name or letter without a colon (:).
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         1
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -PSProvider
     </div>
     <div class="parameterInfo">
      <p>
       Specifies, as a string array, the Windows PowerShell provider.
This cmdlet gets only the drives supported by this provider.
Type the name of a provider, such as FileSystem, Registry, or Certificate.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Scope
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the scope in which this cmdlet gets the drives.
      </p>
      <p>
       The acceptable values for this parameter are:
      </p>
      <ul>
       <li>
        Global
       </li>
       <li>
        Local
       </li>
       <li>
        Script
       </li>
       <li>
        a number relative to the current scope (0 through the number of scopes, where 0 is the current scope and 1 is its parent).
"Local" is the default.
For more information, see about_Scopes (
        <a data-linktype="external" href="http://go.microsoft.com/fwlink/?LinkID=113260">
         http://go.microsoft.com/fwlink/?LinkID=113260
        </a>
        ).
       </li>
      </ul>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -UseTransaction
     </div>
     <div class="parameterInfo">
      <p>
       Includes the command in the active transaction.
This parameter is valid only when a transaction is in progress.
For more information, see Includes the command in the active transaction.
This parameter is valid only when a transaction is in progress.
For more information, see
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         usetx
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       None
      </strong>
     </p>
     <p>
      You cannot pipe objects to this cmdlet.
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       System.Management.Automation.PSDriveInfo
      </strong>
     </p>
     <p>
      This cmdlet returns objects that represent the drives in the session.
     </p>
     <h2 id="notes">
      Notes
     </h2>
     <ul>
      <li>
       This cmdlet is designed to work with the data exposed by any provider. To list the providers available in your session, use the
       <strong>
        Get-PSProvider
       </strong>
       cmdlet. For more information, see
       <a data-linktype="relative-path" href="../microsoft.powershell.core/about/about_providers.html">
        about_Providers
       </a>
       .
      </li>
      <li>
       Mapped network drives that are created by using the
       <em>
        Persist
       </em>
       parameter of the New-PSDrive cmdlet are specific to a user account. Mapped network drives that you create in sessions that are started with the Run as administrator option or with the credentials of another user are not visible in sessions that are started without explicit credentials or with the credentials of the current user.
      </li>
     </ul>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="relative-path" href="new-psdrive.html">
        New-PSDrive
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="remove-psdrive.html">
        Remove-PSDrive
       </a>
      </li>
      <li>
       <a data-linktype="external" href="https://msdn.microsoft.com/en-us/powershell/reference/5.1/Microsoft.PowerShell.Management/Get-WmiObject">
        Get-WmiObject
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="get-psprovider.html">
        Get-PSProvider
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <div class="note alert feedback-system-change-alert">
     <p>
      Note
     </p>
     <p>
      The feedback system for this content will be changing soon. Old comments will not be carried over. If content within a comment thread is important to you, please save a copy. For more information on the upcoming change,
      <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
       we invite you to read our blog post
      </a>
      .
     </p>
    </div>
    <div data-bi-name="comments" id="comments-container" role="form">
    </div>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>