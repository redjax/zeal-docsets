<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Invoke-GPUpdate (grouppolicy)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Invoke-GPUpdate (grouppolicy)" name="twitter:title"/>
  <meta content="Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell." name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell." name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="powershell-windows" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="MSDN" name="search.ms_product"/>
  <meta content="MSDN.powershell-windows" name="depot_name"/>
  <meta content="https://cpubwin.visualstudio.com/DefaultCollection/powershell/_git/powershell/commit/ced7757924addcaea0b7a244ae4d240e4d28d93a?path=%2fdocset%2fwindows%2fgrouppolicy%2finvoke-gpupdate.md&amp;_a=contents" name="ref_skeleton_gitcommit"/>
  <meta content="https://cpubwin.visualstudio.com/DefaultCollection/powershell/_git/powershell?path=%2fdocset%2fwindows%2fgrouppolicy%2finvoke-gpupdate.md&amp;version=GBlive&amp;_a=contents" name="original_ref_skeleton_git_url"/>
  <meta content="2017-09-15 03:44 AM" name="updated_at"/>
  <meta content="88e1d943-d695-2bf1-2947-ec124d5f347d" name="document_id"/>
  <meta content="37fb3294-2045-498b-0781-d3795825b8dc" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="manage" name="ms.mktglfcycl"/>
  <meta content="library" name="ms.sitesec"/>
  <meta content="brianlic" name="ms.author"/>
  <meta content="brianlic-msft" name="author"/>
  <meta content="Microsoft.GroupPolicy.Commands.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell, cmdlet" name="keywords"/>
  <meta content="alanth" name="manager"/>
  <meta content="12/20/2016" name="ms.date"/>
  <meta content="w10" name="ms.prod"/>
  <meta content="powershell-windows" name="ms.technology"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="" name="online_version"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="4587F08A-A67B-4407-8FE2-B6ECE3643E94" name="ms.assetid"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="/powershell/windows/bread/toc.json?view=win10-ps" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="MSDocsHeader-WindowsIT" name="uhfHeaderId"/>
  <meta content="../win10-ps/toc.json?view=win10-ps" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/grouppolicy/invoke-gpupdate" rel="canonical"/>
  <title>
   Invoke-GPUpdate
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/e4a1f3a3.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/31353636.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Invoke-GPUpdate
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./.html">
         grouppolicy
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Schedules a remote Group Policy refresh on the specified computer.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Invoke-GPUpdate
      [-AsJob]
      [-Boot]
      [[-Computer] &lt;String&gt;]
      [[-RandomDelayInMinutes] &lt;Int32&gt;]
      [-Force]
      [-LogOff]
      [-Target &lt;String&gt;]
      [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Invoke-GPUpdate
      [-AsJob]
      [-Boot]
      [[-Computer] &lt;String&gt;]
      [[-RandomDelayInMinutes] &lt;Int32&gt;]
      [-LogOff]
      [-Target &lt;String&gt;]
      [-Sync]
      [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Invoke-GPUpdate
      </strong>
      cmdlet refreshes Group Policy settings, including security settings that are set on remote computers by scheduling the running of the Gpupdate command on a remote computer.
You can combine this cmdlet in a scripted fashion to schedule the Gpupdate command on a group of computers.
     </p>
     <p>
      The refresh can be scheduled to immediately start a refresh of policy settings or wait for a specified period of time, up to a maximum of 31 days.
To avoid putting a load on the network, the refresh times will be offset by a random delay.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Schedule a Group Policy refresh on the current computer
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Invoke-GPUpdate</code></pre>
     <p>
      This command schedules a Group Policy refresh on the computer on which you are running the
      <strong>
       Invoke-GPUpdate
      </strong>
      cmdlet.
     </p>
     <p>
      <strong>
       Example 2: Schedule a Group Policy refresh on a remote computer
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Invoke-GPUpdate -Computer "CONTOSO\COMPUTER-02" -Target "User"</code></pre>
     <p>
      This command schedules a Group Policy refresh on a remote computer named CONTOSO\COMPUTER-02 that only schedule to update the user policy settings in synchronous mode.
     </p>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -AsJob
     </div>
     <div class="parameterInfo">
      <p>
       Runs the cmdlet as a background job.
Use this parameter to run commands that take a long time to complete. 
 The cmdlet immediately returns an object that represents the job and then displays the command prompt.
You can continue to work in the session while the job completes.
To manage the job, use the
       <code>
        *-Job
       </code>
       cmdlets.
To get the job results, use the
       <a data-linktype="external" href="http://go.microsoft.com/fwlink/?LinkID=113372">
        Receive-Job
       </a>
       cmdlet. 
 For more information about Windows PowerShellÂ® background jobs, see
       <a data-linktype="external" href="http://go.microsoft.com/fwlink/?LinkID=113251">
        about_Jobs
       </a>
       .
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Boot
     </div>
     <div class="parameterInfo">
      <p>
       Indicates that the cmdlet restarts the computer after the Group Policy settings are applied.
This is required for those Group Policy client side extensions (CSEs) that do not process Group Policy on a background update cycle, but do process Group Policy at computer startup, for instance, per-computer Software Installation policy settings.
      </p>
      <p>
       This parameter has no effect if there are no CSEs called that require a restart.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Computer
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the name of the computer for which this cmdlet schedules a Group Policy refresh.
You can specify the computer name in one of the following formats:
      </p>
      <ul>
       <li>
        <p>
         Full computer name (FQDN computer name); for example, computer-01.sales.contoso.com.
        </p>
       </li>
       <li>
        <p>
         Fully qualified domain name (FQDN)\computer name; for example, sales.contoso.com\computer-01.
        </p>
       </li>
       <li>
        <p>
         NetBIOS domain name\computer name; for example, sales\computer-01.
        </p>
       </li>
       <li>
        <p>
         Computer name (host name): for example, computer-01.
        </p>
       </li>
      </ul>
      <p>
       If the computer name is not specified, the computer in which this cmdlet is run will have its Group Policy settings refreshed.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         DNSHostName
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         0
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByValue)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Force
     </div>
     <div class="parameterInfo">
      <p>
       Forces the command to run without asking for user confirmation.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -LogOff
     </div>
     <div class="parameterInfo">
      <p>
       Indicates that the cmdlet logs off the current user after the policy settings have been updated.
This is required for those Group Policy client-side extensions (CSEs) that do not process Group Policy on a background update cycle but do process Group Policy when a user logs on.
Examples include per-user Software Installation policy settings and the Folder Redirection extension.
      </p>
      <p>
       This parameter has no effect if there are no CSEs called that require a logoff.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -RandomDelayInMinutes
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the delay, in minutes, that Task Scheduler waits, with a random factor added to lower the network load, before running a scheduled Group Policy refresh.
      </p>
      <p>
       You can specify a delay in from 0 minutes to a maximum of 44640 minutes (31 days):
      </p>
      <ul>
       <li>
        A value of 0 causes the Group Policy refresh to run as soon as the gpupdate task has been scheduled.
       </li>
      </ul>
      <p>
       -A value in the range of 1 minute to the maximum value of 44640 minutes cause the Group Policy refresh to delay the specified number of minutes plus a random offset before starting the Group Policy refresh.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          Int32
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         RandomnessInMinutes
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         1
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Sync
     </div>
     <div class="parameterInfo">
      <p>
       Indicates that the cmdlet processes the next foreground Group Policy application to be done synchronously.
Foreground Group Policy applications occur at computer startup and user logon.
You can specify this for the user, computer or both using the
       <em>
        Target
       </em>
       parameter.
      </p>
      <p>
       On a client computer, by default, Group Policy processes synchronously at computer startup and asynchronously at user logon.
      </p>
      <p>
       On a server, by default, Group Policy processes synchronously at computer startup and at user logon.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Target
     </div>
     <div class="parameterInfo">
      <p>
       Specifies that only the user or computer policy settings are refreshed.
By default, both user and computer policy settings are refreshed.
      </p>
      <p>
       The acceptable values for this parameter are:
      </p>
      <ul>
       <li>
        User
       </li>
       <li>
        Computer
       </li>
      </ul>
      <p>
       If the
       <em>
        Target
       </em>
       parameter is not specified both user and computer policy settings are refreshed.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       None
      </strong>
     </p>
     <p>
      This cmdlet does not take any object as input.
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       None
      </strong>
     </p>
     <p>
      This cmdlet does not generate any input.
     </p>
     <h2 id="notes">
      Notes
     </h2>
     <ul>
      <li>
       This cmdlet does not support scheduling a Group Policy refresh for computers running Windows XP or earlier.
      </li>
      <li>
       <p>
        In order to successfully schedule a Group Policy refresh for computers using this cmdlet, the following Firewall rules must be set on each client computer to allow the following connections:
       </p>
      </li>
      <li>
       <p>
        Remote Scheduled Tasks Management (RPC)
       </p>
      </li>
      <li>
       Remote Scheduled Tasks Management (RPC-ERMAP)
      </li>
      <li>
       Windows Management Instrumentation (WMI-IN)
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <section class="feedback-section" data-bi-name="feedback-section">
     <h2 id="feedback">
      Feedback
     </h2>
     <div class="alert choose-feedback-type">
      <p>
       We'd love to hear your thoughts. Choose the type you'd like to provide:
      </p>
      <div class="choose-feedback-buttons">
       <a class="button-border feedback-type-product" data-bi-name="product-feedback" href="https://windowsserver.uservoice.com/forums/301869-powershell">
        Product feedback
        <span aria-hidden="true" class="docon docon-navigate-external">
        </span>
       </a>
       <div class="button-group">
        <button class="button-border feedback-sign-in-button" data-bi-name="feedback-sign-in">
         <span aria-hidden="true" class="docon docon-brand-github">
         </span>
         Sign in to give documentation feedback
        </button>
        <button aria-controls="feedback-form" aria-expanded="false" class="button-border feedback-form-toggle" data-bi-name="documentation-feedback" hidden="">
         Content feedback
        </button>
        <div auto-align="" class="dropdown has-caret">
         <button aria-controls="fbm0" aria-expanded="false" aria-haspopup="true" aria-label="Expand documentation feedback menu" class="button-border dropdown-trigger" data-bi-name="documentation-feedback-menu">
          <span aria-hidden="true" class="docon docon-chevron-down-light">
          </span>
         </button>
         <div class="dropdown-menu documentation-feedback-menu" id="fbm0" role="menu">
          You may also leave feedback
          <a data-bi-name="create-issue-on-github" href="{0}">
           directly on GitHub
           <span aria-hidden="true" class="docon docon-navigate-external">
           </span>
          </a>
          .
         </div>
        </div>
       </div>
      </div>
      <p>
       <small>
        Our new feedback system is built on GitHub Issues. Read about this change in
        <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
         our blog post
        </a>
        .
       </small>
      </p>
     </div>
     <form accept-charset="UTF-8" action="javascript:" autocomplete="off" class="feedback-form" hidden="" id="feedback-form">
      <h3 class="feedback-form-heading current-user">
       <img alt="Avatar" aria-hidden="true" class="avatar" height="36" width="36"/>
       <span aria-hidden="true" class="username">
       </span>
       <span class="visually-hidden">
        Liquid error: Can't find the localized string giveDocumentationFeedback for template Conceptual.
       </span>
      </h3>
      <label>
       <span class="visually-hidden">
        Title
       </span>
       <input name="title" pattern=".*\w.*" placeholder="Title" required="" type="text"/>
      </label>
      <label>
       <span class="visually-hidden">
        Leave a comment
       </span>
       <textarea name="body" placeholder="Leave a comment" required=""></textarea>
      </label>
      <div class="action-container">
       <button class="primary-action" name="submit" type="submit">
        Submit feedback
       </button>
      </div>
     </form>
     <div class="feedback-status alert busy" role="alert">
      <p>
       Loading feedback...
      </p>
     </div>
     <div class="feedback-tab-group tabGroup" data-tab-group-independent="" hidden="">
      <ul role="tablist">
       <li role="presentation">
        <a aria-controls="tabpanel-issues-open" aria-label="Open Issues" data-tab="issues-open" href="#tabpanel-issues-open" role="tab">
        </a>
       </li>
       <li role="presentation">
        <a aria-controls="tabpanel-issues-closed" aria-label="Closed Issues" data-tab="issues-closed" href="#tabpanel-issues-closed" role="tab">
        </a>
       </li>
      </ul>
      <section data-tab="issues-open" id="tabpanel-issues-open" role="tabpanel">
       <div class="no-issues-placeholder">
        There are no open issues
       </div>
       <ul aria-label="Open Issues" class="github-issues-list">
       </ul>
      </section>
      <section data-tab="issues-closed" id="tabpanel-issues-closed" role="tabpanel">
       <div class="no-issues-placeholder">
        There are no closed issues
       </div>
       <ul aria-label="Closed Issues" class="github-issues-list">
       </ul>
      </section>
     </div>
     <div class="action-container">
      <a class="view-on-github" data-bi-name="view-on-github" hidden="" href="https://github.com/MicrosoftDocs/windows-powershell-docs/issues">
       <span aria-hidden="true" class="docon docon-brand-github">
       </span>
       <span>
        View on GitHub
       </span>
       <span aria-hidden="true" class="docon docon-navigate-external">
       </span>
      </a>
     </div>
    </section>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>