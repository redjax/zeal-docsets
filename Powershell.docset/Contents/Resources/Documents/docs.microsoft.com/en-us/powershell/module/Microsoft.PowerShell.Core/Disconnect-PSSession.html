<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Disconnect-PSSession (Microsoft.PowerShell.Core)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Disconnect-PSSession (Microsoft.PowerShell.Core)" name="twitter:title"/>
  <meta content="The Disconnect-PSSession cmdlet disconnects a Windows PowerShell session (PSSession), such as one started by using the New-PSSession cmdlet, from the current session. As a result, the PSSession is inâ¦" name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="The Disconnect-PSSession cmdlet disconnects a Windows PowerShell session (PSSession), such as one started by using the New-PSSession cmdlet, from the current session. As a result, the PSSession is inâ¦" name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="PowerShell_PowerShell-docs_reference" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="PowerShell" name="search.ms_product"/>
  <meta content="PowerShell.PowerShell_PowerShell-docs_reference" name="depot_name"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/6a6d85dfc6556f4605f45163661aeed4e68cf400/reference/6/Microsoft.PowerShell.Core/Disconnect-PSSession.md" name="ref_skeleton_gitcommit"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/live/reference/6/Microsoft.PowerShell.Core/Disconnect-PSSession.md" name="original_ref_skeleton_git_url"/>
  <meta content="2018-03-30 03:35 PM" name="updated_at"/>
  <meta content="bed9fc99-1ce9-8bef-761d-d5ce2047ba42" name="document_id"/>
  <meta content="ab7a7eaa-d96e-6305-2582-9ae6b7f13a48" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="06/09/2017" name="ms.date"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="powershell,cmdlet" name="keywords"/>
  <meta content="http://go.microsoft.com/fwlink/?LinkID=821474" name="online_version"/>
  <meta content="System.Management.Automation.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="sdwheeler" name="author"/>
  <meta content="sewhee" name="ms.author"/>
  <meta content="carmonm" name="manager"/>
  <meta content="/powershell/bread-pscore/toc.yml?view=powershell-6" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="windows, macos, linux" name="ms.tgt_pltfr"/>
  <meta content="powershell-scripting" name="ms.technology"/>
  <meta content="powershell" name="ms.prod"/>
  <meta content="MSDocsHeader-Powershell" name="uhfHeaderId"/>
  <meta content="../psdocs/toc.json?view=powershell-6" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/disconnect-pssession" rel="canonical"/>
  <title>
   Disconnect-PSSession
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/60aac04b.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/fdb8a38a.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Disconnect-PSSession
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./Microsoft.PowerShell.Core.html">
         Microsoft.PowerShell.Core
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Disconnects from a session.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Disconnect-PSSession
          [-Session] &lt;PSSession[]&gt;
          [-IdleTimeoutSec &lt;Int32&gt;]
          [-OutputBufferingMode &lt;OutputBufferingMode&gt;]
          [-ThrottleLimit &lt;Int32&gt;]
          [-WhatIf]
          [-Confirm]
          [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Disconnect-PSSession
          [-IdleTimeoutSec &lt;Int32&gt;]
          [-OutputBufferingMode &lt;OutputBufferingMode&gt;]
          [-ThrottleLimit &lt;Int32&gt;]
          -Name &lt;String[]&gt;
          [-WhatIf]
          [-Confirm]
          [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Disconnect-PSSession
          [-IdleTimeoutSec &lt;Int32&gt;]
          [-OutputBufferingMode &lt;OutputBufferingMode&gt;]
          [-ThrottleLimit &lt;Int32&gt;]
          [-Id] &lt;Int32[]&gt;
          [-WhatIf]
          [-Confirm]
          [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Disconnect-PSSession
          [-IdleTimeoutSec &lt;Int32&gt;]
          [-OutputBufferingMode &lt;OutputBufferingMode&gt;]
          [-ThrottleLimit &lt;Int32&gt;]
          -InstanceId &lt;Guid[]&gt;
          [-WhatIf]
          [-Confirm]
          [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Disconnect-PSSession
      </strong>
      cmdlet disconnects a Windows PowerShell session (
      <strong>
       PSSession
      </strong>
      ), such as one started by using the New-PSSession cmdlet, from the current session.
As a result, the
      <strong>
       PSSession
      </strong>
      is in a disconnected state.
You can connect to the disconnected
      <strong>
       PSSession
      </strong>
      from the current session or from another session on the local computer or a different computer.
     </p>
     <p>
      The
      <strong>
       Disconnect-PSSession
      </strong>
      cmdlet disconnects only open
      <strong>
       PSSessions
      </strong>
      that are connected to the current session.
      <strong>
       Disconnect-PSSession
      </strong>
      cannot disconnect broken or closed
      <strong>
       PSSession
      </strong>
      objects, or interactive
      <strong>
       PSSession
      </strong>
      objects started by using the Enter-PSSession cmdlet, and it cannot disconnect
      <strong>
       PSSession
      </strong>
      objects that are connected to other sessions.
     </p>
     <p>
      To reconnect to a disconnected
      <strong>
       PSSession
      </strong>
      , use the Connect-PSSession or Receive-PSSession cmdlets.
     </p>
     <p>
      When a
      <strong>
       PSSession
      </strong>
      is disconnected, the commands in the
      <strong>
       PSSession
      </strong>
      continue to run until they finish, unless the PSSession times out or the commands in the
      <strong>
       PSSession
      </strong>
      are blocked by a full output buffer.
To change the idle time-out, use the
      <em>
       IdleTimeoutSec
      </em>
      parameter.
To change the output buffering mode, use the
      <em>
       OutputBufferingMode
      </em>
      parameter.
You can also use the
      <em>
       InDisconnectedSession
      </em>
      parameter of the Invoke-Command cmdlet to run a command in a disconnected session.
     </p>
     <p>
      For more information about the Disconnected Sessions feature, see about_Remote_Disconnected_Sessions.
     </p>
     <p>
      This cmdlet was introduced in Windows PowerShell 3.0.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Disconnect a session
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Disconnect-PSSession -Name UpdateSession

Id Name            ComputerName    State         ConfigurationName     Availability

-- ----            ------------    -----         -----------------     ------------

1  UpdateSession   Server01        Disconnected  Microsoft.PowerShell          None</code></pre>
     <p>
      This command disconnects the UpdateSession
      <strong>
       PSSession
      </strong>
      on the Server01 computer from the current session.
The command uses the
      <em>
       Name
      </em>
      parameter to identify the
      <strong>
       PSSession
      </strong>
      .
     </p>
     <p>
      The output shows that the attempt to disconnect was successful.
The session state is
      <strong>
       Disconnected
      </strong>
      and the
      <strong>
       Availability
      </strong>
      is None, which indicates that the session is not busy and can be reconnected.
     </p>
     <p>
      <strong>
       Example 2: Disconnect a session created in the current session
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-PSSession -ComputerName Server12 -Name ITTask | Disconnect-PSSession -OutputBufferingMode Drop -IdleTimeoutSec 86400

Id Name            ComputerName    State         ConfigurationName     Availability

-- ----            ------------    -----         -----------------     ------------

1  ITTask          Server12        Disconnected  ITTasks               None</code></pre>
     <p>
      This command disconnects the ITTask
      <strong>
       PSSession
      </strong>
      on the Server12 computer from the current session.
The ITTask session was created in the current session and connects to the Server12 computer.
The command uses the Get-PSSession cmdlet to get the session and
      <strong>
       Disconnect-PSSession
      </strong>
      to disconnect it.
     </p>
     <p>
      The
      <strong>
       Disconnect-PSSession
      </strong>
      command uses the
      <em>
       OutputBufferingMode
      </em>
      parameter to set the output mode to Drop.
This setting makes sure that the script that is running in the session can continue to run even if the session output buffer is full.
Because the script writes its output to a report on a file share, other output can be lost without consequence.
     </p>
     <p>
      The command also uses the
      <em>
       IdleTimeoutSec
      </em>
      parameter to extend the idle time-out of the session to 24 hours.
This setting allows time for this administrator or other administrators to reconnect to the session to verify that the script ran and troubleshoot if needed.
     </p>
     <p>
      <strong>
       Example 3: Disconnecting sessions in an enterprise scenario
      </strong>
     </p>
     <pre><code class="lang-powershell">The technician starts by creating sessions on several remote computers and running a script in each session.The first command uses the New-PSSession cmdlet to create the ITTask session on three remote computers. The command saves the sessions in the $s variable. The second command uses the *FilePath* parameter of the Invoke-Command cmdlet to run a script in the sessions in the $s variable.

PS C:\&gt; $s = New-PSSession -ComputerName Srv1, Srv2, Srv30 -Name ITTask



PS C:\&gt; Invoke-Command $s -FilePath \\Server01\Scripts\Get-PatchStatus.ps1



The script running on the Srv1 computer generates unexpected errors. The technician contacts his manager and asks for assistance. The manager directs the technician to disconnect from the session so he can investigate.The second command uses the Get-PSSession cmdlet to get the ITTask session on the Srv1 computer and **Disconnect-PSSession** to disconnect it. This command does not affect the ITTask sessions on  the other computers.

PS C:\&gt; Get-PSSession -Name ITTask -ComputerName Srv1 | Disconnect-PSSession

Id Name            ComputerName    State         ConfigurationName     Availability

-- ----            ------------    -----         -----------------     ------------

1 ITTask           Srv1            Disconnected  Microsoft.PowerShell          None



The third command uses the **Get-PSSession** cmdlet to get the ITTask sessions. The output shows that the ITTask sessions on the Srv2 and Srv30 computers were not affected by the command to disconnect.

PS C:\&gt; Get-PSSession -ComputerName Srv1, Srv2, Srv30 -Name ITTask

Id Name            ComputerName    State         ConfigurationName     Availability

-- ----            ------------    -----         -----------------     ------------

 1 ITTask          Srv1            Disconnected  Microsoft.PowerShell          None

 2 ITTask          Srv2            Opened        Microsoft.PowerShell     Available

 3 ITTask          Srv30           Opened        Microsoft.PowerShell     Available



The manager logs on to his home computer, connects to his corporate network, starts Windows PowerShell, and uses the Get-PSSession cmdlet to get the ITTask session on the Srv1 computer. He uses the credentials of the technician to access the session.

PS C:\&gt; Get-PSSession -ComputerName Srv1 -Name ITTask -Credential Domain01\User01

Id Name            ComputerName    State         ConfigurationName     Availability

-- ----            ------------    -----         -----------------     ------------

 1 ITTask          Srv1            Disconnected  Microsoft.PowerShell          None



Next, the manager uses the Connect-PSSession cmdlet to connect to the ITTask session on the Srv1 computer. The command saves the session in the $s variable.

PS C:\&gt; $s = Connect-PSSession -ComputerName Srv1 -Name ITTask -Credential Domain01\User01



The manager uses the Invoke-Command cmdlet to run some diagnostic commands in the session in the $s variable. He recognizes that the script failed because it did not find a required directory. The manager uses the MkDir function to create the directory, and then he restarts the Get-PatchStatus.ps1 script and disconnects from the session.The manager reports his findings to the technician, suggests that he reconnect to the session to complete the tasks, and asks him to add a command to the Get-PatchStatus.ps1 script that creates the required directory if it does not exist.

PS C:\&gt; Invoke-Command -Session $s {dir $home\Scripts\PatchStatusOutput.ps1}



PS C:\&gt; Invoke-Command -Session $s {mkdir $home\Scripts\PatchStatusOutput}



PS C:\&gt; Invoke-Command -Session $s -FilePath \\Server01\Scripts\Get-PatchStatus.ps1



PS C:\&gt; Disconnect-PSSession -Session $s</code></pre>
     <p>
      This series of commands shows how
      <strong>
       Disconnect-PSSession
      </strong>
      might be used in an enterprise scenario.
In this case, a new technician starts a script in a session on a remote computer and runs into a problem.
The technician disconnects from the session so that a more experienced manager can connect to the session and resolve the problem.
     </p>
     <p>
      <strong>
       Example 4: Correct the value of an idle time-out so it can be disconnected
      </strong>
     </p>
     <pre><code class="lang-powershell">The first command uses the New-PSSessionOption cmdlet to create a session option object. It uses the *IdleTimeout* parameter to set an idle time-out of 48 hours (172800000 milliseconds). The command saves the session option object in the $Timeout variable.

PS C:\&gt; $Timeout = New-PSSessionOption -IdleTimeout 172800000



The second command uses the New-PSSession cmdlet to create the ITTask session on the Server01 computer. The command saves the session in the $s variable. The value of the *SessionOption* parameter is the 48-hour idle time-out in the $Timeout variable.

PS C:\&gt; $s = New-PSSession -Computer Server01 -Name ITTask -SessionOption $Timeout



The third command disconnects the ITTask session in the $s variable. The command fails because the idle time-out value of the session exceeds the **MaxIdleTimeoutMs** quota in the session configuration. Because the idle time-out is not used until the session is disconnected, this violation can go undetected while the session is being used.

PS C:\&gt; Disconnect-PSSession -Session $s

Disconnect-PSSession : The session ITTask cannot be disconnected because the specified

idle timeout value 172800(seconds) is either greater than the server maximum allowed

43200 (seconds) or less that the minimum allowed60(seconds).  Choose an idle time out

value that is within the allowed range and try again.



The fourth command uses the Invoke-Command cmdlet to run a Get-PSSessionConfiguration command for the Microsoft.PowerShell session configuration on the Server01 computer. The command uses the Format-List cmdlet to display all properties of the session configuration in a list.The output shows that the **MaxIdleTimeoutMS** property, which establishes the maximum permitted **IdleTimeout** value for sessions that use the session configuration, is 43200000 milliseconds (12 hours).

PS C:\&gt; Invoke-Command -ComputerName Server01 {Get-PSSessionConfiguration Microsoft.PowerShell} | Format-List -Property *

Architecture                  : 64

Filename                      : %windir%\system32\pwrshplugin.dll

ResourceUri                   : http://schemas.microsoft.com/powershell/microsoft.powershell

MaxConcurrentCommandsPerShell : 1000

UseSharedProcess              : false

ProcessIdleTimeoutSec         : 0

xmlns                         : http://schemas.microsoft.com/wbem/wsman/1/config/PluginConfiguration

MaxConcurrentUsers            : 5

lang                          : en-US

SupportsOptions               : true

ExactMatch                    : true

RunAsUser                     :

IdleTimeoutms                 : 7200000

PSVersion                     : 3.0

OutputBufferingMode           : Block

AutoRestart                   : false

SecurityDescriptorSddl        : O:NSG:BAD:P(A;;GA;;;BA)S:P(AU;FA;GA;;;WD)(AU;SA;GXGW;;;WD)

MaxMemoryPerShellMB           : 1024

MaxIdleTimeoutms              : 2147483647

Uri                           : http://schemas.microsoft.com/powershell/microsoft.powershell

SDKVersion                    : 2

Name                          : microsoft.powershell

XmlRenderingType              : text

Capability                    : {Shell}

RunAsPassword                 :

MaxProcessesPerShell          : 15

ParentResourceUri             : http://schemas.microsoft.com/powershell/microsoft.powershell

Enabled                       : true

MaxShells                     : 25

MaxShellsPerUser              : 25

Permission                    : BUILTIN\Administrators AccessAllowed

PSComputerName                : localhost

RunspaceId                    : aea84310-6dbf-4c21-90ac-13980039925a

PSShowComputerName            : True





The fifth command gets the session option values of the session in the $s variable. The values of many session options are properties of the **ConnectionInfo** property of the **Runspace** property of the session.The output shows that the value of the **IdleTimeout** property of the session is 172800000 milliseconds (48 hours), which violates the **MaxIdleTimeoutMs** quota of 12 hours in the session configuration.To resolve this conflict, you can use the *ConfigurationName* parameter to select a different session configuration or use the *IdleTimeout* parameter to reduce the idle time-out of the session.

PS C:\&gt; $s.Runspace.ConnectionInfo

ConnectionUri                     : http://Server01/wsman

ComputerName                      : Server01

Scheme                            : http

Port                              : 80

AppName                           : /wsman

Credential                        :

ShellUri                          : http://schemas.microsoft.com/powershell/Microsoft.PowerShell

AuthenticationMechanism           : Default

CertificateThumbprint             :

MaximumConnectionRedirectionCount : 5

MaximumReceivedDataSizePerCommand :

MaximumReceivedObjectSize         : 209715200

UseCompression                    : True

NoMachineProfile                  : False

ProxyAccessType                   : None

ProxyAuthentication               : Negotiate

ProxyCredential                   :

SkipCACheck                       : False

SkipCNCheck                       : False

SkipRevocationCheck               : False

NoEncryption                      : False

UseUTF16                          : False

OutputBufferingMode               : Drop

IncludePortInSPN                  : False

Culture                           : en-US

UICulture                         : en-US

OpenTimeout                       : 180000

CancelTimeout                     : 60000

OperationTimeout                  : 180000

IdleTimeout                       : 172800000



The sixth command disconnects the session. It uses the *IdleTimeoutSec* parameter to set the idle time-out to the 12-hour maximum.

PS C:\&gt; Disconnect-PSSession $s -IdleTimeoutSec 43200

Id Name            ComputerName    State         ConfigurationName     Availability

-- ----            ------------    -----         -----------------     ------------

 4 ITTask          Server01        Disconnected  Microsoft.PowerShell          None



The seventh command gets the value of the **IdleTimeout** property of the disconnected session, which is measured in milliseconds. The output confirms that the command was successful.

PS C:\&gt; $s.Runspace.ConnectionInfo.IdleTimeout

43200000</code></pre>
     <p>
      This example shows how to correct the value of the
      <strong>
       IdleTimeout
      </strong>
      property of a session so that it can be disconnected.
     </p>
     <p>
      The idle time-out property of a session is critical to disconnected sessions, because it determines how long a disconnected session is maintained before it is deleted.
You can set the idle time-out option when you create a session and when you disconnect it.
The default values for the idle time-out of a session are set in the
      <strong>
       $PSSessionOption
      </strong>
      preference variable on the local computer and in the session configuration on the remote computer.
Values set for the session take precedence over values set in the session configuration, but session values cannot exceed quotas set in the session configuration, such as the
      <strong>
       MaxIdleTimeoutMs
      </strong>
      value.
     </p>
     <h2 id="required-parameters">
      Required Parameters
     </h2>
     <div class="parameterName stack">
      -Id
     </div>
     <div class="parameterInfo">
      <p>
       Specifies an array of IDs of sessions that this cmdlet disconnects.
Type one or more IDs, separated by commas, or use the range operator (..) to specify a range of IDs.
      </p>
      <p>
       To get the ID of a session, use the Get-PSSession cmdlet.
The instance ID is stored in the
       <strong>
        ID
       </strong>
       property of the session.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          Int32[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         0
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -InstanceId
     </div>
     <div class="parameterInfo">
      <p>
       Specifies an array of GUIDs of sessions that this cmdlet disconnects.
      </p>
      <p>
       The instance ID is a GUID that uniquely identifies a session on a local or remote computer.
The instance ID is unique, even across multiple sessions on multiple computers.
      </p>
      <p>
       To get the instance ID of a session, use
       <strong>
        Get-PSSession
       </strong>
       .
The instance ID is stored in the
       <strong>
        InstanceID
       </strong>
       property of the session.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          Guid[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Name
     </div>
     <div class="parameterInfo">
      <p>
       Specifies an array of friendly names of sessions that this cmdlet disconnects.
Wildcard characters are permitted.
      </p>
      <p>
       To get the friendly name of a session, use
       <strong>
        Get-PSSession
       </strong>
       .
The friendly name is stored in the
       <strong>
        Name
       </strong>
       property of the session.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Session
     </div>
     <div class="parameterInfo">
      <p>
       Specifies an array of sessions.
Enter
       <strong>
        PSSession
       </strong>
       objects, such as those that the
       <strong>
        New-PSSession
       </strong>
       cmdlet returns.
You can also pipe a
       <strong>
        PSSession
       </strong>
       object to Disconnect-PSSession.
      </p>
      <p>
       <strong>
        Get-PSSession
       </strong>
       can get all
       <strong>
        PSSession
       </strong>
       objects that end at a remote computer.
These include
       <strong>
        PSSession
       </strong>
       objects that are disconnected and
       <strong>
        PSSession
       </strong>
       objects that are connected to other sessions on other computers.
       <strong>
        Disconnect-PSSession
       </strong>
       disconnects only
       <strong>
        PSSession
       </strong>
       that are connected to the current session.
If you pipe other
       <strong>
        PSSession
       </strong>
       objects to
       <strong>
        Disconnect-PSSession
       </strong>
       , the
       <strong>
        Disconnect-PSSession
       </strong>
       command fails.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          PSSession[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         0
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName, ByValue)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -Confirm
     </div>
     <div class="parameterInfo">
      <p>
       Prompts you for confirmation before running the cmdlet.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         cf
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -IdleTimeoutSec
     </div>
     <div class="parameterInfo">
      <p>
       Changes the idle time-out value of the disconnected
       <strong>
        PSSession
       </strong>
       .
Enter a value in seconds.
The minimum value is 60 (1 minute).
      </p>
      <p>
       The idle time-out determines how long the disconnected
       <strong>
        PSSession
       </strong>
       is maintained on the remote computer.
When the time-out expires, the
       <strong>
        PSSession
       </strong>
       is deleted.
      </p>
      <p>
       Disconnected
       <strong>
        PSSession
       </strong>
       objects are considered to be idle from the moment that they are disconnected, even if commands are running in the disconnected session.
      </p>
      <p>
       The default value for the idle time-out of a session is set by the value of the
       <strong>
        IdleTimeoutMs
       </strong>
       property of the session configuration.
The default value is 7200000 milliseconds (2 hours).
      </p>
      <p>
       The value of this parameter takes precedence over the value of the
       <strong>
        IdleTimeout
       </strong>
       property of the $PSSessionOption preference variable and the default idle time-out value in the session configuration.
However, this value cannot exceed the value of the
       <strong>
        MaxIdleTimeoutMs
       </strong>
       property of the session configuration.
The default value of
       <strong>
        MaxIdleTimeoutMs
       </strong>
       is 12 hours (43200000 milliseconds).
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          Int32
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -OutputBufferingMode
     </div>
     <div class="parameterInfo">
      <p>
       Specifies how command output is managed in the disconnected session when the output buffer is full.
The default value is Block.
      </p>
      <p>
       If the command in the disconnected session is returning output and the output buffer fills, the value of this parameter effectively determines whether the command continues to run while the session is disconnected.
A value of Block suspends the command until the session is reconnected.
A value of Drop allows the command to complete, although data might be lost.
When using the Drop value, redirect the command output to a file on disk.
      </p>
      <p>
       The acceptable values for this parameter are:
      </p>
      <ul>
       <li>
        Block. When the output buffer is full, execution is suspended until the buffer is clear.
       </li>
       <li>
        Drop. When the output buffer is full, execution continues. As new output is saved, the oldest output is discarded.
       </li>
       <li>
        None. No output buffering mode is specified. The value of the
        <em>
         OutputBufferingMode
        </em>
        property of the session configuration is used for the disconnected session.
       </li>
      </ul>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          OutputBufferingMode
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Parameter Sets:
        </td>
        <td>
         None, Drop, Block
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -ThrottleLimit
     </div>
     <div class="parameterInfo">
      <p>
       Sets the throttle limit for the
       <strong>
        Disconnect-PSSession
       </strong>
       command.
      </p>
      <p>
       The throttle limit is the maximum number of concurrent connections that can be established to run this command.
If you omit this parameter or enter a value of 0, the default value, 32, is used.
      </p>
      <p>
       The throttle limit applies only to the current command, not to the session or to the computer.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          Int32
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -WhatIf
     </div>
     <div class="parameterInfo">
      <p>
       Shows what would happen if the cmdlet runs.
The cmdlet is not run.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         wi
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       System.Management.Automation.Runspaces.PSSession
      </strong>
     </p>
     <p>
      You can pipe a session to this cmdlet.
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       System.Management.Automation.Runspaces.PSSession
      </strong>
     </p>
     <p>
      This cmdlet returns an object that represents the session that it disconnected.
     </p>
     <h2 id="notes">
      Notes
     </h2>
     <ul>
      <li>
       The
       <strong>
        Disconnect-PSSession
       </strong>
       cmdlet works only when the local and remote computers are running Windows PowerShell 3.0 or later versions of Windows PowerShell.
      </li>
      <li>
       If you use
       <strong>
        Disconnect-PSSession
       </strong>
       on a disconnected session, the command does not affect the session and it does not generate errors.
      </li>
      <li>
       Disconnected loopback sessions with interactive security tokens, which are created by using the
       <em>
        EnableNetworkAccess
       </em>
       parameter, can be reconnected only from the computer on which the session was created. This restriction protects the computer from malicious access.
      </li>
      <li>
       <p>
        When you disconnect a
        <strong>
         PSSession
        </strong>
        , the session state is
        <strong>
         Disconnected
        </strong>
        and the availability is
        <strong>
         None
        </strong>
        .
       </p>
       <p>
        The value of the
        <strong>
         State
        </strong>
        property is relative to the current session.
Therefore, a value of
        <strong>
         Disconnected
        </strong>
        means that the
        <strong>
         PSSession
        </strong>
        is not connected to the current session.
However, it does not mean that the
        <strong>
         PSSession
        </strong>
        is disconnected from all sessions.
It might be connected to a different session.
To determine whether you can connect or reconnect to the session, use the
        <strong>
         Availability
        </strong>
        property.
       </p>
       <p>
        An
        <strong>
         Availability
        </strong>
        value of
        <strong>
         None
        </strong>
        indicates that you can connect to the session.
A value of
        <strong>
         Busy
        </strong>
        indicates that you cannot connect to the
        <strong>
         PSSession
        </strong>
        because it is connected to another session.
       </p>
       <p>
        For more information about the values of the
        <strong>
         State
        </strong>
        property of sessions, see
        <a data-linktype="external" href="https://msdn.microsoft.com/library/system.management.automation.runspaces.runspacestate">
         RunspaceState Enumeration
        </a>
        in the MSDN library.
       </p>
       <p>
        For more information about the values of the
        <strong>
         Availability
        </strong>
        property of sessions, see
        <a data-linktype="external" href="https://msdn.microsoft.com/library/system.management.automation.runspaces.runspaceavailability">
         RunspaceAvailability Enumeration
        </a>
        in the MSDN library.
       </p>
      </li>
     </ul>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="relative-path" href="connect-pssession.html">
        Connect-PSSession
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="enter-pssession.html">
        Enter-PSSession
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="exit-pssession.html">
        Exit-PSSession
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="get-pssession.html">
        Get-PSSession
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="get-pssessionconfiguration.html">
        Get-PSSessionConfiguration
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="new-pssession.html">
        New-PSSession
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="new-pssessionoption.html">
        New-PSSessionOption
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="new-pstransportoption.html">
        New-PSTransportOption
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="receive-pssession.html">
        Receive-PSSession
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="register-pssessionconfiguration.html">
        Register-PSSessionConfiguration
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="remove-pssession.html">
        Remove-PSSession
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <div class="note alert feedback-system-change-alert">
     <p>
      Note
     </p>
     <p>
      The feedback system for this content will be changing soon. Old comments will not be carried over. If content within a comment thread is important to you, please save a copy. For more information on the upcoming change,
      <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
       we invite you to read our blog post
      </a>
      .
     </p>
    </div>
    <div data-bi-name="comments" id="comments-container" role="form">
    </div>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>