<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Set-TraceSource (Microsoft.PowerShell.Utility)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Set-TraceSource (Microsoft.PowerShell.Utility)" name="twitter:title"/>
  <meta content="The Set-TraceSource cmdlet configures, starts, and stops a trace of a Windows PowerShell component. You can use it to specify which components will be traced and where the tracing output is sent. " name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="The Set-TraceSource cmdlet configures, starts, and stops a trace of a Windows PowerShell component. You can use it to specify which components will be traced and where the tracing output is sent. " name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="PowerShell_PowerShell-docs_reference" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="PowerShell" name="search.ms_product"/>
  <meta content="PowerShell.PowerShell_PowerShell-docs_reference" name="depot_name"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/45404d4ca212afa615798d3d5cbfea5dc5cc1efb/reference/6/Microsoft.PowerShell.Utility/Set-TraceSource.md" name="ref_skeleton_gitcommit"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/live/reference/6/Microsoft.PowerShell.Utility/Set-TraceSource.md" name="original_ref_skeleton_git_url"/>
  <meta content="2018-03-30 03:35 PM" name="updated_at"/>
  <meta content="aafd824e-f4d3-7b35-7c41-a3a42f91d6ce" name="document_id"/>
  <meta content="16692f8d-8e33-440b-676c-ffbad8a2b5fb" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="06/09/2017" name="ms.date"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="powershell,cmdlet" name="keywords"/>
  <meta content="http://go.microsoft.com/fwlink/?LinkId=821860" name="online_version"/>
  <meta content="Microsoft.PowerShell.Commands.Utility.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="sdwheeler" name="author"/>
  <meta content="sewhee" name="ms.author"/>
  <meta content="carmonm" name="manager"/>
  <meta content="/powershell/bread-pscore/toc.yml?view=powershell-6" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="windows, macos, linux" name="ms.tgt_pltfr"/>
  <meta content="powershell-scripting" name="ms.technology"/>
  <meta content="powershell" name="ms.prod"/>
  <meta content="MSDocsHeader-Powershell" name="uhfHeaderId"/>
  <meta content="../psdocs/toc.json?view=powershell-6" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-tracesource" rel="canonical"/>
  <title>
   Set-TraceSource
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/60aac04b.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/fdb8a38a.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Set-Trace
      <wbr/>
      Source
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./Microsoft.PowerShell.Utility.html">
         Microsoft.PowerShell.Utility
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Configures, starts, and stops a trace of Windows PowerShell components.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Set-TraceSource
   [-Name] &lt;String[]&gt;
   [[-Option] &lt;PSTraceSourceOptions&gt;]
   [-ListenerOption &lt;TraceOptions&gt;]
   [-FilePath &lt;String&gt;]
   [-Force]
   [-Debugger]
   [-PSHost]
   [-PassThru]
   [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Set-TraceSource
   [-Name] &lt;String[]&gt;
   [-RemoveListener &lt;String[]&gt;]
   [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Set-TraceSource
   [-Name] &lt;String[]&gt;
   [-RemoveFileListener &lt;String[]&gt;]
   [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Set-TraceSource
      </strong>
      cmdlet configures, starts, and stops a trace of a Windows PowerShell component.
You can use it to specify which components will be traced and where the tracing output is sent.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Trace the ParameterBinding component
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Set-TraceSource -Name "ParameterBinding" -Option ExecutionFlow -PSHost -ListenerOption "ProcessId,TimeStamp"</code></pre>
     <p>
      This command starts tracing for the ParameterBinding component of Windows PowerShell.
It uses the
      <em>
       Name
      </em>
      parameter to specify the trace source, the
      <em>
       Option
      </em>
      parameter to select the ExecutionFlow trace events, and the
      <em>
       PSHost
      </em>
      parameter to select the Windows PowerShell host listener, which sends the output to the console.
The
      <em>
       ListenerOption
      </em>
      parameter adds the ProcessID and TimeStamp values to the trace message prefix.
     </p>
     <p>
      <strong>
       Example 2: Stop a trace
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Set-TraceSource -Name "ParameterBinding" -RemoveListener "Host"</code></pre>
     <p>
      This command stops the trace of the ParameterBinding component of Windows PowerShell.
It uses the
      <em>
       Name
      </em>
      parameter to identify the component that was being traced and the
      <em>
       RemoveListener
      </em>
      parameter to identify the trace listener.
     </p>
     <h2 id="required-parameters">
      Required Parameters
     </h2>
     <div class="parameterName stack">
      -Name
     </div>
     <div class="parameterInfo">
      <p>
       Specifies which components are traced.
Enter the name of the trace source of each component.
Wildcards are permitted.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         1
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName, ByValue)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -Debugger
     </div>
     <div class="parameterInfo">
      <p>
       Indicates that the cmdlet sends the trace output to the debugger.
You can view the output in any user-mode or kernel mode debugger or in Microsoft Visual Studio.
This parameter also selects the default trace listener.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -FilePath
     </div>
     <div class="parameterInfo">
      <p>
       Specifies a file that this cmdlet sends the trace output to.
This parameter also selects the file trace listener.
If you use this parameter to start the trace, use the
       <em>
        RemoveFileListener
       </em>
       parameter to stop the trace.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         PSPath
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Force
     </div>
     <div class="parameterInfo">
      <p>
       Indicates that the cmdlet overwrites a read-only file.
Use with the
       <em>
        FilePath
       </em>
       parameter.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -ListenerOption
     </div>
     <div class="parameterInfo">
      <p>
       Specifies optional data to the prefix of each trace message in the output.
The acceptable values for this parameter are:
      </p>
      <ul>
       <li>
        None
       </li>
       <li>
        LogicalOperationStack
       </li>
       <li>
        DateTime
       </li>
       <li>
        Timestamp
       </li>
       <li>
        ProcessId
       </li>
       <li>
        ThreadId
       </li>
       <li>
        Callstack
       </li>
      </ul>
      <p>
       None is the default.
      </p>
      <p>
       To specify multiple options, separate them with commas, but with no spaces, and enclose them in quotation marks, such as "ProcessID,ThreadID".
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          TraceOptions
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Parameter Sets:
        </td>
        <td>
         None, LogicalOperationStack, DateTime, Timestamp, ProcessId, ThreadId, Callstack
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Option
     </div>
     <div class="parameterInfo">
      <p>
       Determines the type of events that are traced.
The acceptable values for this parameter are:
      </p>
      <ul>
       <li>
        None
       </li>
       <li>
        Constructor
       </li>
       <li>
        Dispose
       </li>
       <li>
        Finalizer
       </li>
       <li>
        Method
       </li>
       <li>
        Property
       </li>
       <li>
        Delegates
       </li>
       <li>
        Events
       </li>
       <li>
        Exception
       </li>
       <li>
        Lock
       </li>
       <li>
        Error
       </li>
       <li>
        Errors
       </li>
       <li>
        Warning
       </li>
       <li>
        Verbose
       </li>
       <li>
        WriteLine
       </li>
       <li>
        Data
       </li>
       <li>
        Scope
       </li>
       <li>
        ExecutionFlow
       </li>
       <li>
        Assert
       </li>
       <li>
        All
       </li>
      </ul>
      <p>
       All is the default.
      </p>
      <p>
       The following values are combinations of other values:
      </p>
      <ul>
       <li>
        ExecutionFlow: (Constructor, Dispose, Finalizer, Method, Delegates, Events, and Scope)
       </li>
       <li>
        Data: (Constructor, Dispose, Finalizer, Property, Verbose, and WriteLine)
       </li>
       <li>
        Errors: (Error and Exception).
       </li>
      </ul>
      <p>
       To specify multiple options, separate them with commas, but with no spaces, and enclose them in quotation marks, such as "Constructor,Dispose".
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          PSTraceSourceOptions
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         2
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -PSHost
     </div>
     <div class="parameterInfo">
      <p>
       ndicates that this cmdlet sends the trace output to the Windows PowerShell host.
This parameter also selects the PSHost trace listener.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -PassThru
     </div>
     <div class="parameterInfo">
      <p>
       Returns an object representing the item with which you are working.
By default, this cmdlet does not generate any output.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -RemoveFileListener
     </div>
     <div class="parameterInfo">
      <p>
       Stops the trace by removing the file trace listener associated with the specified file.
Enter the path and file name of the trace output file.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -RemoveListener
     </div>
     <div class="parameterInfo">
      <p>
       Stops the trace by removing the trace listener.
      </p>
      <p>
       Use the following values with
       <em>
        RemoveListener
       </em>
       :
      </p>
      <ul>
       <li>
        To remove PSHost (console), type
        <code>
         Host
        </code>
        .
       </li>
       <li>
        To remove Debugger, type
        <code>
         Debug
        </code>
        .
       </li>
       <li>
        To remove all trace listeners, type
        <code>
         *
        </code>
        .
       </li>
      </ul>
      <p>
       To remove the file trace listener, use the
       <em>
        RemoveFileListener
       </em>
       parameter.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       System.String
      </strong>
     </p>
     <p>
      You can pipe a string that contains a name to
      <strong>
       Set-TraceSource
      </strong>
      .
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       None or System.Management.Automation.PSTraceSource
      </strong>
     </p>
     <p>
      When you use the
      <em>
       PassThru
      </em>
      parameter,
      <strong>
       Set-TraceSource
      </strong>
      generates a
      <strong>
       System.Management.Automation.PSTraceSource
      </strong>
      object representing the trace session.
Otherwise, this cmdlet does not generate any output.
     </p>
     <h2 id="notes">
      Notes
     </h2>
     <ul>
      <li>
       <p>
        Tracing is a method that developers use to debug and refine programs. When tracing, the program generates detailed messages about each step in its internal processing.
       </p>
       <p>
        The Windows PowerShell tracing cmdlets are designed to help Windows PowerShell developers, but they are available to all users.
They let you monitor nearly every aspect of the functionality of Windows PowerShell.
       </p>
       <p>
        A trace source is the part of each Windows PowerShell component that manages tracing and generates trace messages for the component.
To trace a component, you identify its trace source.
       </p>
       <p>
        A trace listener receives the output of the trace and displays it to the user.
You can elect to send the trace data to a user-mode or kernel-mode debugger, to the console, to a file, or to a custom listener derived from the
        <strong>
         System.Diagnostics.TraceListener
        </strong>
        class.
       </p>
      </li>
      <li>
       <p>
        To start a trace, use the
        <em>
         Name
        </em>
        parameter to specify a trace source and the
        <em>
         FilePath
        </em>
        ,
        <em>
         Debugger
        </em>
        , or
        <em>
         PSHost
        </em>
        parameters to specify a listener (a destination for the output). Use the
        <em>
         Options
        </em>
        parameter to determine the types of events that are traced and the
        <em>
         ListenerOption
        </em>
        parameter to configure the trace output.
       </p>
      </li>
      <li>
       To change the configuration of a trace, enter a
       <strong>
        Set-TraceSource
       </strong>
       command as you would to start a trace. Windows PowerShell recognizes that the trace source is already being traced. It stops the trace, adds the new configuration, and starts or restarts the trace.
      </li>
      <li>
       To stop a trace, use the
       <em>
        RemoveListener
       </em>
       parameter. To stop a trace that uses the file listener (a trace started by using the
       <em>
        FilePath
       </em>
       parameter), use the
       <em>
        RemoveFileListener
       </em>
       parameter. When you remove the listener, the trace stops.
      </li>
      <li>
       To determine which components can be traced, use Get-TraceSource. The trace sources for each module are loaded automatically when the component is in use, and they appear in the output of
       <strong>
        Get-TraceSource
       </strong>
       .
      </li>
     </ul>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="relative-path" href="get-tracesource.html">
        Get-TraceSource
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="trace-command.html">
        Trace-Command
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <div class="note alert feedback-system-change-alert">
     <p>
      Note
     </p>
     <p>
      The feedback system for this content will be changing soon. Old comments will not be carried over. If content within a comment thread is important to you, please save a copy. For more information on the upcoming change,
      <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
       we invite you to read our blog post
      </a>
      .
     </p>
    </div>
    <div data-bi-name="comments" id="comments-container" role="form">
    </div>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>