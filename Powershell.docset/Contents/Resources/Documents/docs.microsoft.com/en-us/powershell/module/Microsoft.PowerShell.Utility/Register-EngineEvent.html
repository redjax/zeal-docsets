<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Register-EngineEvent (Microsoft.PowerShell.Utility)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Register-EngineEvent (Microsoft.PowerShell.Utility)" name="twitter:title"/>
  <meta content="The Register-EngineEvent cmdlet subscribes to events that are generated by the Windows PowerShell engine and the New-Event cmdlet. Use the SourceIdentifier parameter to specify the event. You can useâ¦" name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="The Register-EngineEvent cmdlet subscribes to events that are generated by the Windows PowerShell engine and the New-Event cmdlet. Use the SourceIdentifier parameter to specify the event. You can useâ¦" name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="PowerShell_PowerShell-docs_reference" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="PowerShell" name="search.ms_product"/>
  <meta content="PowerShell.PowerShell_PowerShell-docs_reference" name="depot_name"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/57cd861e6079bc530a60692b1bbf35cfef1d3f35/reference/6/Microsoft.PowerShell.Utility/Register-EngineEvent.md" name="ref_skeleton_gitcommit"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/live/reference/6/Microsoft.PowerShell.Utility/Register-EngineEvent.md" name="original_ref_skeleton_git_url"/>
  <meta content="2018-03-30 03:35 PM" name="updated_at"/>
  <meta content="3d81a424-dc51-5a33-09b3-4224de54d92d" name="document_id"/>
  <meta content="4c356ab5-91fc-18a6-9498-10f28f070918" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="06/09/2017" name="ms.date"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="powershell,cmdlet" name="keywords"/>
  <meta content="http://go.microsoft.com/fwlink/?LinkId=821844" name="online_version"/>
  <meta content="Microsoft.PowerShell.Commands.Utility.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="sdwheeler" name="author"/>
  <meta content="sewhee" name="ms.author"/>
  <meta content="carmonm" name="manager"/>
  <meta content="/powershell/bread-pscore/toc.yml?view=powershell-6" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="windows, macos, linux" name="ms.tgt_pltfr"/>
  <meta content="powershell-scripting" name="ms.technology"/>
  <meta content="powershell" name="ms.prod"/>
  <meta content="MSDocsHeader-Powershell" name="uhfHeaderId"/>
  <meta content="../psdocs/toc.json?view=powershell-6" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/register-engineevent" rel="canonical"/>
  <title>
   Register-EngineEvent
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/60aac04b.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/fdb8a38a.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Register-Engine
      <wbr/>
      Event
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./Microsoft.PowerShell.Utility.html">
         Microsoft.PowerShell.Utility
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Subscribes to events that are generated by the Windows PowerShell engine and by the New-Event cmdlet.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Register-EngineEvent
        [-SourceIdentifier] &lt;String&gt;
        [[-Action] &lt;ScriptBlock&gt;]
        [-MessageData &lt;PSObject&gt;]
        [-SupportEvent]
        [-Forward]
        [-MaxTriggerCount &lt;Int32&gt;]
        [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Register-EngineEvent
      </strong>
      cmdlet subscribes to events that are generated by the Windows PowerShell engine and the New-Event cmdlet.
Use the
      <em>
       SourceIdentifier
      </em>
      parameter to specify the event.
     </p>
     <p>
      You can use this cmdlet to subscribe to the Exiting engine event and events generated by the New-Event cmdlet.
These events are automatically added to your event queue in your session without subscribing.
However, subscribing lets you forward the events, specify an action to respond to the events, and cancel the subscription.
     </p>
     <p>
      When the subscribed event is raised, it is added to the event queue in your session.
To get events in the event queue, use the Get-Event cmdlet.
     </p>
     <p>
      When you subscribe to a event, an event subscriber is added to your session.
To get the event subscribers in the session, use the Get-EventSubscriber cmdlet.
To cancel the subscription, use the Unregister-Event cmdlet, which deletes the event subscriber from the session.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Register a PowerShell engine event on remote computers
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; $S = New-PSSession -ComputerName "Server01, Server02"

PS C:\&gt; Invoke-Command -Session $S { Register-EngineEvent -SourceIdentifier ([System.Management.Automation.PsEngineEvent]::Exiting) -Forward }</code></pre>
     <p>
      This command registers for a Windows PowerShell engine event on two remote computers.
     </p>
     <p>
      The first command creates a user-managed session (PSSession) on each of the remote computers.
     </p>
     <p>
      The second command uses the Invoke-Command cmdlet to run the
      <strong>
       Register-EngineEvent
      </strong>
      command in the remote sessions.
     </p>
     <p>
      The
      <strong>
       Register-EngineEvent
      </strong>
      command uses the
      <em>
       SourceIdentifier
      </em>
      parameter to identify the event.
It uses the
      <em>
       Forward
      </em>
      parameter to forward the events from the remote session to the local session.
     </p>
     <p>
      <strong>
       Example 2: Take a specified action when the Exiting event occurs
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Register-EngineEvent -SourceIdentifier PowerShell.Exiting -SupportEvent -Action {

     Get-History | Export-Clixml $Home\history.clixml

}</code></pre>
     <p>
      This command shows how to run
      <strong>
       Register-EngineEvent
      </strong>
      to take a specific action when the
      <strong>
       PowerShell.Exiting
      </strong>
      event occurs.
The
      <em>
       SupportEvent
      </em>
      parameter is added to hide the event subscription.
When Windows PowerShell exits, in this case, the command history from the exiting session is exported in XML format to a file name and path in the user's $Home directory.
     </p>
     <h2 id="required-parameters">
      Required Parameters
     </h2>
     <div class="parameterName stack">
      -SourceIdentifier
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the source identifier of the event to which you are subscribing.
The source identifier must be unique in the current session.
This parameter is required.
      </p>
      <p>
       The value of this parameter appears in the value of the
       <strong>
        SourceIdentifier
       </strong>
       property of the subscriber object and of all event objects associated with this subscription.
      </p>
      <p>
       Supported EngineEvent values include PowerShell.Exiting, PowerShell.OnIdle, and PowerShell.OnScriptBlockInvoke.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         101
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -Action
     </div>
     <div class="parameterInfo">
      <p>
       Specifies commands to handle the events.
The commands in the
       <em>
        Action
       </em>
       run when an event is raised, instead of sending the event to the event queue.
Enclose the commands in braces ( { } ) to create a script block.
      </p>
      <p>
       The value of the
       <em>
        Action
       </em>
       parameter can include the $Event, $EventSubscriber, $Sender, $EventArgs, and $Args automatic variables, which provide information about the event to the Action script block.
For more information, see about_Automatic_Variables (
       <a data-linktype="external" href="http://go.microsoft.com/fwlink/?LinkID=113212">
        http://go.microsoft.com/fwlink/?LinkID=113212
       </a>
       ).
      </p>
      <p>
       When you specify an action,
       <strong>
        Register-EngineEvent
       </strong>
       returns an event job object that represents that action.
You can use the Job cmdlets to manage the event job.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          ScriptBlock
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         102
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Forward
     </div>
     <div class="parameterInfo">
      <p>
       Indicates that the cmdlet sends events for this subscription to the session on the local computer.
Use this parameter when you are registering for events on a remote computer or in a remote session.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -MaxTriggerCount
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the max trigger count.
      </p>
      <p>
       The value of the
       <em>
        Action
       </em>
       parameter can include the $Event, $EventSubscriber, $Sender, $EventArgs, and $Args automatic variables, which provide information about the event to the Action script block.
For more information, see about_Automatic_Variables (
       <a data-linktype="external" href="http://go.microsoft.com/fwlink/?LinkID=113212">
        http://go.microsoft.com/fwlink/?LinkID=113212
       </a>
       ).
      </p>
      <p>
       When you specify an action,
       <strong>
        Register-EngineEvent
       </strong>
       returns an event job object that represents that action.
You can use the Job cmdlets to manage the event job.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          Int32
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -MessageData
     </div>
     <div class="parameterInfo">
      <p>
       Specifies additional data associated with the event.
The value of this parameter appears in the
       <strong>
        MessageData
       </strong>
       property of the event object.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          PSObject
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -SupportEvent
     </div>
     <div class="parameterInfo">
      <p>
       Indicates that the cmdlet hides the event subscription.
Add this parameter when the current subscription is part of a more complex event registration mechanism and it should not be discovered independently.
      </p>
      <p>
       To view or cancel a subscription that was created with the
       <em>
        SupportEvent
       </em>
       parameter, add the
       <em>
        Force
       </em>
       parameter to the Get-EventSubscriber or Unregister-Event cmdlets.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       None
      </strong>
     </p>
     <p>
      You cannot pipe input to
      <strong>
       Register-EngineEvent
      </strong>
      .
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       None or System.Management.Automation.PSEventJob
      </strong>
     </p>
     <p>
      If you use the
      <em>
       Action
      </em>
      parameter,
      <strong>
       Register-EngineEvent
      </strong>
      returns a
      <strong>
       System.Management.Automation.PSEventJob
      </strong>
      object.
Otherwise, it does not generate any output.
     </p>
     <h2 id="notes">
      Notes
     </h2>
     <ul>
      <li>
       Events, event subscriptions, and the event queue exist only in the current session. If you close the current session, the event queue is discarded and the event subscription is canceled.
      </li>
     </ul>
     <p>
      *
     </p>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="relative-path" href="get-event.html">
        Get-Event
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="new-event.html">
        New-Event
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="register-objectevent.html">
        Register-ObjectEvent
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="remove-event.html">
        Remove-Event
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="unregister-event.html">
        Unregister-Event
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="wait-event.html">
        Wait-Event
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <div class="note alert feedback-system-change-alert">
     <p>
      Note
     </p>
     <p>
      The feedback system for this content will be changing soon. Old comments will not be carried over. If content within a comment thread is important to you, please save a copy. For more information on the upcoming change,
      <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
       we invite you to read our blog post
      </a>
      .
     </p>
    </div>
    <div data-bi-name="comments" id="comments-container" role="form">
    </div>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>