<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Add-History (Microsoft.PowerShell.Core)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Add-History (Microsoft.PowerShell.Core)" name="twitter:title"/>
  <meta content="The Add-History cmdlet adds entries to the end of the session history, that is, the list of commands entered during the current session. You can use the Get-History cmdlet to get the commands and pasâ¦" name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="The Add-History cmdlet adds entries to the end of the session history, that is, the list of commands entered during the current session. You can use the Get-History cmdlet to get the commands and pasâ¦" name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="PowerShell_PowerShell-docs_reference" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="PowerShell" name="search.ms_product"/>
  <meta content="PowerShell.PowerShell_PowerShell-docs_reference" name="depot_name"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/6a6d85dfc6556f4605f45163661aeed4e68cf400/reference/6/Microsoft.PowerShell.Core/Add-History.md" name="ref_skeleton_gitcommit"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/live/reference/6/Microsoft.PowerShell.Core/Add-History.md" name="original_ref_skeleton_git_url"/>
  <meta content="2018-03-30 03:35 PM" name="updated_at"/>
  <meta content="866a1c3a-743e-c828-48d2-867791f0b91b" name="document_id"/>
  <meta content="192f9dcb-d746-1996-5236-cc32a01ea7a9" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="06/09/2017" name="ms.date"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="powershell,cmdlet" name="keywords"/>
  <meta content="http://go.microsoft.com/fwlink/?LinkId=821468" name="online_version"/>
  <meta content="System.Management.Automation.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="sdwheeler" name="author"/>
  <meta content="sewhee" name="ms.author"/>
  <meta content="carmonm" name="manager"/>
  <meta content="/powershell/bread-pscore/toc.yml?view=powershell-6" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="windows, macos, linux" name="ms.tgt_pltfr"/>
  <meta content="powershell-scripting" name="ms.technology"/>
  <meta content="powershell" name="ms.prod"/>
  <meta content="MSDocsHeader-Powershell" name="uhfHeaderId"/>
  <meta content="../psdocs/toc.json?view=powershell-6" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/add-history" rel="canonical"/>
  <title>
   Add-History
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/60aac04b.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/fdb8a38a.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Add-History
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./Microsoft.PowerShell.Core.html">
         Microsoft.PowerShell.Core
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Appends entries to the session history.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Add-History
   [[-InputObject] &lt;PSObject[]&gt;]
   [-Passthru]
   [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Add-History
      </strong>
      cmdlet adds entries to the end of the session history, that is, the list of commands entered during the current session.
     </p>
     <p>
      You can use the Get-History cmdlet to get the commands and pass them to
      <strong>
       Add-History
      </strong>
      , or you can export the commands to a CSV or XML file, then import the commands, and pass the imported file to
      <strong>
       Add-History
      </strong>
      .
You can use this cmdlet to add specific commands to the history or to create a single history file that includes commands from more than one session.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Add commands to the history of a different session
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-History | Export-Csv c:\testing\history.csv

PS C:\&gt; Import-Csv history.csv | Add-History</code></pre>
     <p>
      These commands add the commands typed in one Windows PowerShell session to the history of a different Windows PowerShell session.
     </p>
     <p>
      The first command gets objects representing the commands in the history and exports them to the History.csv file.
     </p>
     <p>
      The second command is typed at the command line of a different session.
It uses the
      <strong>
       Import-Csv
      </strong>
      cmdlet to import the objects in the History.csv file.
The pipeline operator (|) passes the objects to the
      <strong>
       Add-History
      </strong>
      cmdlet, which adds the objects representing the commands in the History.csv file to the current session history.
     </p>
     <p>
      <strong>
       Example 2: Import and run commands
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Import-Clixml c:\temp\history.xml | Add-History -PassThru | ForEach-Object -Process {Invoke-History}</code></pre>
     <p>
      This command imports commands from the History.xml file, adds them to the current session history, and then runs the commands in the combined history.
     </p>
     <p>
      The first command uses the
      <strong>
       Import-Clixml
      </strong>
      cmdlet to import a command history that was exported to the History.xml file.
The pipeline operator passes the commands to the
      <strong>
       Add-History
      </strong>
      cmdlet, which adds the commands to the current session history.
The
      <em>
       PassThru
      </em>
      parameter passes the objects representing the added commands down the pipeline.
     </p>
     <p>
      The command then uses the ForEach-Object cmdlet to apply the Invoke-History command to each of the commands in the combined history.
The
      <strong>
       Invoke-History
      </strong>
      command is formatted as a script block, enclosed in braces, as required by the
      <em>
       Process
      </em>
      parameter of the
      <strong>
       ForEach-Object
      </strong>
      cmdlet.
     </p>
     <p>
      <strong>
       Example 3: Add commands in the history to the end of the history
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-History -Id 5 -Count 5 | Add-History</code></pre>
     <p>
      This command adds the first five commands in the history to the end of the history list.
It uses the Get-History cmdlet to get the five commands ending in command 5.
The pipeline operator passes them to the
      <strong>
       Add-History
      </strong>
      cmdlet, which appends them to the current history.
The
      <strong>
       Add-History
      </strong>
      command does not include any parameters, but Windows PowerShell associates the objects passed through the pipeline with the
      <em>
       InputObject
      </em>
      parameter of
      <strong>
       Add-History
      </strong>
      .
     </p>
     <p>
      <strong>
       Example 4: Add commands in a .csv file to the current history
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; $a = Import-Csv c:\testing\history.csv

PS C:\&gt; Add-History -InputObject $a -PassThru</code></pre>
     <p>
      These commands add the commands in the History.csv file to the current session history.
     </p>
     <p>
      The first command uses the
      <strong>
       Import-Csv
      </strong>
      cmdlet to import the commands in the History.csv file and store its contents in the variable $a.
     </p>
     <p>
      The second command uses the
      <strong>
       Add-History
      </strong>
      cmdlet to add the commands from History.csv to the current session history.
It uses the
      <em>
       InputObject
      </em>
      parameter to specify the $a variable and the
      <em>
       PassThru
      </em>
      parameter to generate an object to display at the command line.
Without the
      <em>
       PassThru
      </em>
      parameter, the
      <strong>
       Add-History
      </strong>
      cmdlet does not generate any output.
     </p>
     <p>
      <strong>
       Example 5: Add commands in an .xml file to the current history
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Add-History -InputObject (Import-Clixml c:\temp\history01.xml)</code></pre>
     <p>
      This command adds the commands in the History01.xml file to the current session history.
It uses the
      <em>
       InputObject
      </em>
      parameter to pass the results of the command in parentheses to the
      <strong>
       Add-History
      </strong>
      cmdlet.
The command in parentheses, which is executed first, imports the History01.xml file into Windows PowerShell.
The
      <strong>
       Add-History
      </strong>
      cmdlet then adds the commands in the file to the session history.
     </p>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -InputObject
     </div>
     <div class="parameterInfo">
      <p>
       Specifies an array of entries to add to the history as HistoryInfo object to the session history.
You can use this parameter to submit a
       <strong>
        HistoryInfo
       </strong>
       object, such as the ones that are returned by the
       <strong>
        Get-History
       </strong>
       , Import-Clixml, or Import-Csv cmdlets, to
       <strong>
        Add-History
       </strong>
       .
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          PSObject[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         0
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByValue)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Passthru
     </div>
     <div class="parameterInfo">
      <p>
       Indicates that this cmdlet returns a history object for each history entry.
By default, this cmdlet does not generate any output.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       Microsoft.PowerShell.Commands.HistoryInfo
      </strong>
     </p>
     <p>
      You can pipe a
      <strong>
       HistoryInfo
      </strong>
      object to this cmdlet.
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       None or Microsoft.PowerShell.Commands.HistoryInfo
      </strong>
     </p>
     <p>
      This cmdlet returns a
      <strong>
       HistoryInfo
      </strong>
      object if you specify the
      <em>
       PassThru
      </em>
      parameter.
Otherwise, this cmdlet does not generate any output.
     </p>
     <h2 id="notes">
      Notes
     </h2>
     <ul>
      <li>
       <p>
        The session history is a list of the commands entered during the session together with the ID. The session history represents the order of execution, the status, and the start and end times of the command. As you enter each command, Windows PowerShell adds it to the history so that you can reuse it. For more information about the session history, see about_History.
       </p>
       <p>
        To specify the commands to add to the history, use the
        <em>
         InputObject
        </em>
        parameter.
The
        <strong>
         Add-History
        </strong>
        command accepts only
        <strong>
         HistoryInfo
        </strong>
        objects, such as those returned for each command by the
        <strong>
         Get-History
        </strong>
        cmdlet.
You cannot pass it a path and file name or a list of commands.
       </p>
       <p>
        You can use the
        <em>
         InputObject
        </em>
        parameter to pass a file of
        <strong>
         HistoryInfo
        </strong>
        objects to
        <strong>
         Add-History
        </strong>
        .
To do so, export the results of a
        <strong>
         Get-History
        </strong>
        command to a file by using the Export-Csv or Export-Clixml cmdlet and then import the file by using the
        <strong>
         Import-Csv
        </strong>
        or
        <strong>
         Import-Clixml
        </strong>
        cmdlets.
You can then pass the file of imported
        <strong>
         HistoryInfo
        </strong>
        objects to
        <strong>
         Add-History
        </strong>
        through a pipeline or in a variable.
For more information, see the examples.
       </p>
       <p>
        The file of
        <strong>
         HistoryInfo
        </strong>
        objects that you pass to the
        <strong>
         Add-History
        </strong>
        cmdlet must include the type information, column headings, and all of the properties of the
        <strong>
         HistoryInfo
        </strong>
        objects.
If you intend to pass the objects back to
        <strong>
         Add-History
        </strong>
        , do not use the
        <em>
         NoTypeInformation
        </em>
        parameter of the
        <strong>
         Export-Csv
        </strong>
        cmdlet and do not delete the type information, column headings, or any fields in the file.
       </p>
       <p>
        To modify the session history, export the session to a CSV or XML file, modify the file, import the file, and use
        <strong>
         Add-History
        </strong>
        to append it to the current session history.
       </p>
      </li>
     </ul>
     <p>
      *
     </p>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="relative-path" href="clear-history.html">
        Clear-History
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="get-history.html">
        Get-History
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="invoke-history.html">
        Invoke-History
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <div class="note alert feedback-system-change-alert">
     <p>
      Note
     </p>
     <p>
      The feedback system for this content will be changing soon. Old comments will not be carried over. If content within a comment thread is important to you, please save a copy. For more information on the upcoming change,
      <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
       we invite you to read our blog post
      </a>
      .
     </p>
    </div>
    <div data-bi-name="comments" id="comments-container" role="form">
    </div>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>