<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Invoke-History (Microsoft.PowerShell.Core)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Invoke-History (Microsoft.PowerShell.Core)" name="twitter:title"/>
  <meta content="The Invoke-History cmdlet runs commands from the session history. You can pass objects representing the commands from Get-History to Invoke-History, or you can identify commands in the current historâ¦" name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="The Invoke-History cmdlet runs commands from the session history. You can pass objects representing the commands from Get-History to Invoke-History, or you can identify commands in the current historâ¦" name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="PowerShell_PowerShell-docs_reference" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="PowerShell" name="search.ms_product"/>
  <meta content="PowerShell.PowerShell_PowerShell-docs_reference" name="depot_name"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/6a6d85dfc6556f4605f45163661aeed4e68cf400/reference/6/Microsoft.PowerShell.Core/Invoke-History.md" name="ref_skeleton_gitcommit"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/live/reference/6/Microsoft.PowerShell.Core/Invoke-History.md" name="original_ref_skeleton_git_url"/>
  <meta content="2018-03-30 03:35 PM" name="updated_at"/>
  <meta content="da36641a-1cfa-3a87-2b1b-eb4eff36f50c" name="document_id"/>
  <meta content="e0132061-fcac-8430-5570-742fa7f797b2" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="06/09/2017" name="ms.date"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="powershell,cmdlet" name="keywords"/>
  <meta content="http://go.microsoft.com/fwlink/?LinkId=821494" name="online_version"/>
  <meta content="System.Management.Automation.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="sdwheeler" name="author"/>
  <meta content="sewhee" name="ms.author"/>
  <meta content="carmonm" name="manager"/>
  <meta content="/powershell/bread-pscore/toc.yml?view=powershell-6" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="windows, macos, linux" name="ms.tgt_pltfr"/>
  <meta content="powershell-scripting" name="ms.technology"/>
  <meta content="powershell" name="ms.prod"/>
  <meta content="MSDocsHeader-Powershell" name="uhfHeaderId"/>
  <meta content="../psdocs/toc.json?view=powershell-6" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/invoke-history" rel="canonical"/>
  <title>
   Invoke-History
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/60aac04b.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/fdb8a38a.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Invoke-History
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./Microsoft.PowerShell.Core.html">
         Microsoft.PowerShell.Core
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Runs commands from the session history.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Invoke-History
      [[-Id] &lt;String&gt;]
      [-WhatIf]
      [-Confirm]
      [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Invoke-History
      </strong>
      cmdlet runs commands from the session history.
You can pass objects representing the commands from Get-History to
      <strong>
       Invoke-History
      </strong>
      , or you can identify commands in the current history by using their ID number.
To find the identification number of a command, use the
      <strong>
       Get-History
      </strong>
      cmdlet.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Run the most recent command in the history
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Invoke-History</code></pre>
     <p>
      This command runs the last, or most recent, command in the session history.
You can abbreviate this command as
      <code>
       r
      </code>
      , the alias for
      <strong>
       Invoke-History
      </strong>
      .
     </p>
     <p>
      <strong>
       Example 2: Run the command that has a specified ID
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Invoke-History -Id 132</code></pre>
     <p>
      This command runs the command in the session history with ID 132.
Because the name of the
      <em>
       Id
      </em>
      parameter is optional, you can abbreviate this command as the following:
      <code>
       Invoke-History 132
      </code>
      ,
      <code>
       ihy 132
      </code>
      , or
      <code>
       r 132
      </code>
      .
     </p>
     <p>
      <strong>
       Example 3: Run the most recent command by using the command text
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Invoke-History -ID get-pr</code></pre>
     <p>
      This command runs the most recent
      <strong>
       Get-Process
      </strong>
      command in the session history.
When you type characters for the
      <em>
       Id
      </em>
      parameter,
      <strong>
       Invoke-History
      </strong>
      runs the first command that it finds that matches the pattern, starting with the most recent commands.
     </p>
     <p>
      <strong>
       Example 4: Run a sequence of commands from the history
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; 16..24 | ForEach {Invoke-History -Id $_ }</code></pre>
     <p>
      This command runs commands 16 through 24.
Because you can list only one ID value, the command uses the ForEach-Object cmdlet to run the
      <strong>
       Invoke-History
      </strong>
      command one time for each ID value.
     </p>
     <p>
      <strong>
       Example 5
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-History -Id 255 -Count 7 | ForEach {Invoke-History -Id $_.Id}</code></pre>
     <p>
      This command runs the 7 commands in the history that end with command 255 (typically 249 through 255).
It uses the Get-History cmdlet to retrieve the commands.
Because you can list only one ID value, the command uses the ForEach-Object cmdlet to run the
      <strong>
       Invoke-History
      </strong>
      command once for each ID value.
     </p>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -Confirm
     </div>
     <div class="parameterInfo">
      <p>
       Prompts you for confirmation before running the cmdlet.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         cf
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Id
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the ID of a command in the history.
You can type the ID number of the command or the first few characters of the command.
      </p>
      <p>
       If you type characters,
       <strong>
        Invoke-History
       </strong>
       matches the most recent commands first.
If you omit this parameter,
       <strong>
        Invoke-History
       </strong>
       runs the last, or most recent, command.
To find the ID number of a command, use the
       <strong>
        Get-History
       </strong>
       cmdlet.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         0
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -WhatIf
     </div>
     <div class="parameterInfo">
      <p>
       Shows what would happen if the cmdlet runs.
The cmdlet is not run.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         wi
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       System.String
      </strong>
     </p>
     <p>
      You can pipe a history ID to this cmdlet.
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       None
      </strong>
     </p>
     <p>
      This cmdlet does not generate any output, but output might be generated by the commands that
      <strong>
       Invoke-History
      </strong>
      runs.
     </p>
     <h2 id="notes">
      Notes
     </h2>
     <ul>
      <li>
       <p>
        The session history is a list of the commands entered during the session together with the ID. The session history represents the order of execution, the status, and the start and end times of the command. As you enter each command, Windows PowerShell adds it to the history so that you can reuse it. For more information about the session history, see about_History (
        <a data-linktype="external" href="http://go.microsoft.com/fwlink/?LinkID=113233">
         http://go.microsoft.com/fwlink/?LinkID=113233
        </a>
        ).
       </p>
       <p>
        You can also refer to
        <strong>
         Invoke-History
        </strong>
        by its built-in aliases, "r" and "ihy".
For more information, see about_Aliases (
        <a data-linktype="external" href="http://go.microsoft.com/fwlink/?LinkID=113207">
         http://go.microsoft.com/fwlink/?LinkID=113207
        </a>
        ).
       </p>
      </li>
     </ul>
     <p>
      *
     </p>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="relative-path" href="add-history.html">
        Add-History
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="clear-history.html">
        Clear-History
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="get-history.html">
        Get-History
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <div class="note alert feedback-system-change-alert">
     <p>
      Note
     </p>
     <p>
      The feedback system for this content will be changing soon. Old comments will not be carried over. If content within a comment thread is important to you, please save a copy. For more information on the upcoming change,
      <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
       we invite you to read our blog post
      </a>
      .
     </p>
    </div>
    <div data-bi-name="comments" id="comments-container" role="form">
    </div>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>