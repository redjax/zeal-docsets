<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Invoke-Expression (Microsoft.PowerShell.Utility)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Invoke-Expression (Microsoft.PowerShell.Utility)" name="twitter:title"/>
  <meta content="The Invoke-Expression cmdlet evaluates or runs a specified string as a command and returns the results of the expression or command. Without Invoke-Expression, a string submitted at the command lineâ¦" name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="The Invoke-Expression cmdlet evaluates or runs a specified string as a command and returns the results of the expression or command. Without Invoke-Expression, a string submitted at the command lineâ¦" name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="PowerShell_PowerShell-docs_reference" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="PowerShell" name="search.ms_product"/>
  <meta content="PowerShell.PowerShell_PowerShell-docs_reference" name="depot_name"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/57cd861e6079bc530a60692b1bbf35cfef1d3f35/reference/6/Microsoft.PowerShell.Utility/Invoke-Expression.md" name="ref_skeleton_gitcommit"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/live/reference/6/Microsoft.PowerShell.Utility/Invoke-Expression.md" name="original_ref_skeleton_git_url"/>
  <meta content="2018-03-30 03:35 PM" name="updated_at"/>
  <meta content="d669d38f-7692-bbaa-2c88-ba1b1d2bb4c1" name="document_id"/>
  <meta content="9d592d60-e29c-84e6-2e43-078e2a69fb97" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="06/09/2017" name="ms.date"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="powershell,cmdlet" name="keywords"/>
  <meta content="http://go.microsoft.com/fwlink/?LinkId=821823" name="online_version"/>
  <meta content="Microsoft.PowerShell.Commands.Utility.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="sdwheeler" name="author"/>
  <meta content="sewhee" name="ms.author"/>
  <meta content="carmonm" name="manager"/>
  <meta content="/powershell/bread-pscore/toc.yml?view=powershell-6" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="windows, macos, linux" name="ms.tgt_pltfr"/>
  <meta content="powershell-scripting" name="ms.technology"/>
  <meta content="powershell" name="ms.prod"/>
  <meta content="MSDocsHeader-Powershell" name="uhfHeaderId"/>
  <meta content="../psdocs/toc.json?view=powershell-6" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-expression" rel="canonical"/>
  <title>
   Invoke-Expression
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/60aac04b.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/fdb8a38a.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Invoke-Expression
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./Microsoft.PowerShell.Utility.html">
         Microsoft.PowerShell.Utility
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Runs commands or expressions on the local computer.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Invoke-Expression
      [-Command] &lt;String&gt;
      [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Invoke-Expression
      </strong>
      cmdlet evaluates or runs a specified string as a command and returns the results of the expression or command.
Without
      <strong>
       Invoke-Expression
      </strong>
      , a string submitted at the command line would be returned (echoed) unchanged.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Evaluate an expression
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; $Command = "Get-Process"

PS C:\&gt; $Command

Get-Process PS C:\&gt; Invoke-Expression $Command

Handles  NPM(K)    PM(K)      WS(K) VM(M)   CPU(s)     Id   ProcessName

-------  ------    -----      ----- -----   ------     --   -----------

296       4       1572       1956    20       0.53     1348   AdtAgent

270       6       1328       800     34       0.06     2396   alg

67        2       620        484     20       0.22     716    ati2evxx

1060      15      12904      11840   74       11.48    892    CcmExec

1400      33      25280      37544   223      38.44    2564   communicator

...</code></pre>
     <p>
      This example demonstrates the use of
      <strong>
       Invoke-Expression
      </strong>
      to evaluate an expression.
Without
      <strong>
       Invoke-Expression
      </strong>
      , the expression is printed, but not evaluated.
     </p>
     <p>
      The first command assigns a value of Get-Process (a string) to the $Command variable.
     </p>
     <p>
      The second command shows the effect of typing the variable name at the command line.
Windows PowerShell echoes the string.
     </p>
     <p>
      The third command uses
      <strong>
       Invoke-Expression
      </strong>
      to evaluate the string.
     </p>
     <p>
      <strong>
       Example 2: Run a script on the local computer
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Invoke-Expression -Command "C:\ps-test\testscript.ps1"

PS C:\&gt; "C:\ps-test\testscript.ps1" | Invoke-Expression</code></pre>
     <p>
      These commands use
      <strong>
       Invoke-Expression
      </strong>
      to run a script, TestScript.ps1, on the local computer.
The two commands are equivalent.
The first uses the
      <em>
       Command
      </em>
      parameter to specify the command to run.
The second uses a pipeline operator (|) to send the command string to
      <strong>
       Invoke-Expression
      </strong>
      .
     </p>
     <p>
      <strong>
       Example 3: Run a command in a variable
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; $Command = 'Get-Process | where {$_.cpu -gt 1000}'

PS C:\&gt; Invoke-Expression $Command</code></pre>
     <p>
      This example runs a command string that is saved in the $Command variable.
     </p>
     <p>
      The command string is enclosed in single quotation marks because it includes a variable, $
      <em>
       , which represents the current object.
If it were enclosed in double quotation marks, the $
      </em>
      variable would be replaced by its value before it was saved in the $Command variable.
     </p>
     <p>
      <strong>
       Example 4: Get and run a cmdlet Help example
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; $Cmdlet_name = "Get-EventLog"

PS C:\&gt; $Example_number = 1

PS C:\&gt; $Example_code = (Get-Help $Cmdlet_name).examples.example[($Example_number-1)].code

PS C:\&gt; Invoke-Expression $Example_code</code></pre>
     <p>
      This command retrieves and runs the first example in the Get-EventLog cmdlet Help topic.
     </p>
     <p>
      To run an example of a different cmdlet, change the value of the $Cmdlet_name variable to the name of the cmdlet.
And, change the $Example_number variable to the example number you want to run.
The command will fail if the example number is not valid.
     </p>
     <h2 id="required-parameters">
      Required Parameters
     </h2>
     <div class="parameterName stack">
      -Command
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the command or expression to run.
Type the command or expression or enter a variable that contains the command or expression.
The
       <em>
        Command
       </em>
       parameter is required.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         1
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByValue)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       System.String or PSObject
      </strong>
     </p>
     <p>
      You can pipe an object that represents the command to
      <strong>
       Invoke-Expression
      </strong>
      .
Use the $Input automatic variable to represent the input objects in the command.
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       PSObject
      </strong>
     </p>
     <p>
      Returns the output that is generated by the invoked command (the value of the
      <em>
       Command
      </em>
      parameter).
     </p>
     <h2 id="notes">
      Notes
     </h2>
     <ul>
      <li>
       An expression is a statement that can be evaluated and produces a result, such as a Windows PowerShell command.
      </li>
      <li>
       Take reasonable precautions when using the
       <strong>
        Invoke-Expression
       </strong>
       cmdlet in scripts. When using
       <strong>
        Invoke-Expression
       </strong>
       to run a command that the user enters, verify that the command is safe to run before running it. In general, it is best to design your script with predefined input options, rather than allowing freeform input.
      </li>
     </ul>
     <h2 id="related-links">
      RELATED LINKS
     </h2>
     <!-- </content> -->
    </main>
    <div class="note alert feedback-system-change-alert">
     <p>
      Note
     </p>
     <p>
      The feedback system for this content will be changing soon. Old comments will not be carried over. If content within a comment thread is important to you, please save a copy. For more information on the upcoming change,
      <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
       we invite you to read our blog post
      </a>
      .
     </p>
    </div>
    <div data-bi-name="comments" id="comments-container" role="form">
    </div>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>