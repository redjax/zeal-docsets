<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Enable-PSSessionConfiguration (Microsoft.PowerShell.Core)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Enable-PSSessionConfiguration (Microsoft.PowerShell.Core)" name="twitter:title"/>
  <meta content="The Enable-PSSessionConfiguration cmdlet enables registered session configurations that have been disabled, such as by using the Disable-PSSessionConfiguration or Disable-PSRemoting cmdlets, or the Aâ¦" name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="The Enable-PSSessionConfiguration cmdlet enables registered session configurations that have been disabled, such as by using the Disable-PSSessionConfiguration or Disable-PSRemoting cmdlets, or the Aâ¦" name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="PowerShell_PowerShell-docs_reference" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="PowerShell" name="search.ms_product"/>
  <meta content="PowerShell.PowerShell_PowerShell-docs_reference" name="depot_name"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/6a6d85dfc6556f4605f45163661aeed4e68cf400/reference/6/Microsoft.PowerShell.Core/Enable-PSSessionConfiguration.md" name="ref_skeleton_gitcommit"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/live/reference/6/Microsoft.PowerShell.Core/Enable-PSSessionConfiguration.md" name="original_ref_skeleton_git_url"/>
  <meta content="2018-03-30 03:35 PM" name="updated_at"/>
  <meta content="7aca48d3-f6e0-c0cf-28e3-79a167bc1e46" name="document_id"/>
  <meta content="0116c0c6-d4b3-f555-0c64-a2f362db95d2" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="06/09/2017" name="ms.date"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="powershell,cmdlet" name="keywords"/>
  <meta content="http://go.microsoft.com/fwlink/?LinkId=821476" name="online_version"/>
  <meta content="System.Management.Automation.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="sdwheeler" name="author"/>
  <meta content="sewhee" name="ms.author"/>
  <meta content="carmonm" name="manager"/>
  <meta content="/powershell/bread-pscore/toc.yml?view=powershell-6" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="windows, macos, linux" name="ms.tgt_pltfr"/>
  <meta content="powershell-scripting" name="ms.technology"/>
  <meta content="powershell" name="ms.prod"/>
  <meta content="MSDocsHeader-Powershell" name="uhfHeaderId"/>
  <meta content="../psdocs/toc.json?view=powershell-6" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/enable-pssessionconfiguration" rel="canonical"/>
  <title>
   Enable-PSSessionConfiguration
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/60aac04b.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/fdb8a38a.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Enable-PSSession
      <wbr/>
      Configuration
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./Microsoft.PowerShell.Core.html">
         Microsoft.PowerShell.Core
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Enables the session configurations on the local computer.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Enable-PSSessionConfiguration
      [[-Name] &lt;String[]&gt;]
      [-Force]
      [-SecurityDescriptorSddl &lt;String&gt;]
      [-SkipNetworkProfileCheck]
      [-NoServiceRestart]
      [-WhatIf]
      [-Confirm]
      [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Enable-PSSessionConfiguration
      </strong>
      cmdlet enables registered session configurations that have been disabled, such as by using the Disable-PSSessionConfiguration or Disable-PSRemoting cmdlets, or the
      <em>
       AccessMode
      </em>
      parameter of Register-PSSessionConfiguration.
This is an advanced cmdlet that is designed to be used by system administrators to manage customized session configurations for their users.
     </p>
     <p>
      Without parameters,
      <strong>
       Enable-PSSessionConfiguration
      </strong>
      enables the Microsoft.PowerShell configuration, which is the default configuration that is used for sessions.
     </p>
     <p>
      <strong>
       Enable-PSSessionConfiguration
      </strong>
      removes the Deny_All setting from the security descriptor of the affected session configurations, turns on the listener that accepts requests on any IP address, and restarts the WinRM service.
Beginning in Windows PowerShell 3.0,
      <strong>
       Enable-PSSessionConfiguration
      </strong>
      also sets the value of the
      <strong>
       Enabled
      </strong>
      property of the session configuration (WSMan:\&lt;computer&gt;\PlugIn\&lt;SessionConfigurationName&gt;\Enabled) to True.
However,
      <strong>
       Enable-PSSessionConfiguration
      </strong>
      does not remove or change the Network_Deny_All (AccessMode=Local) security descriptor setting that allows only users of the local computer to use to the session configuration.
     </p>
     <p>
      The
      <strong>
       Enable-PSSessionConfiguration
      </strong>
      cmdlet calls the
      <strong>
       Set-WSManQuickConfig
      </strong>
      cmdlet.
However, it should not be used to enable remoting on the computer.
Instead, use the more comprehensive cmdlet, Enable-PSRemoting.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Re-enable the default session
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Enable-PSSessionConfiguration</code></pre>
     <p>
      This command re-enables the Microsoft.PowerShell default session configuration on the computer.
     </p>
     <p>
      <strong>
       Example 2: Re-enable specified sessions
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Enable-PSSessionConfiguration -Name MaintenanceShell, AdminShell</code></pre>
     <p>
      This command re-enables the MaintenanceShell and AdminShell session configurations on the computer.
     </p>
     <p>
      <strong>
       Example 3: Re-enable the all sessions
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Enable-PSSessionConfiguration -Name *

PS C:\&gt; Get-PSSessionConfiguration | Enable-PSSessionConfiguration</code></pre>
     <p>
      These commands re-enable all session configurations on the computer.
The commands are equivalent.
Therefore, you can use either.
     </p>
     <p>
      <strong>
       Enable-PSSessionConfiguration
      </strong>
      does not generate an error if you enable a session configuration that is already enabled.
     </p>
     <p>
      <strong>
       Example 4: Re-enable a session and specify a new security descriptor
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Enable-PSSessionConfiguration -Name MaintenanceShell -SecurityDescriptorSDDL "O:NSG:BAD:P(A;;GXGWGR;;;BA)(A;;GAGR;;;S-1-5-21-123456789-188441444-3100496)S:P"</code></pre>
     <p>
      This command re-enables the MaintenanceShell session configuration and specifies a new security descriptor for the configuration.
     </p>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -Confirm
     </div>
     <div class="parameterInfo">
      <p>
       Prompts you for confirmation before running the cmdlet.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         cf
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Force
     </div>
     <div class="parameterInfo">
      <p>
       Indicates that the cmdlet does not prompt you for confirmation, and restarts the WinRM service without prompting.
Restarting the service makes the configuration change effective.
      </p>
      <p>
       To prevent a restart and suppress the restart prompt, use the
       <em>
        NoServiceRestart
       </em>
       parameter.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Name
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the names of session configurations to enable.
Enter one or more configuration names.
Wildcard characters are permitted.
      </p>
      <p>
       You can also pipe a string that contains a configuration name or a session configuration object to
       <strong>
        Enable-PSSessionConfiguration
       </strong>
       .
      </p>
      <p>
       If you omit this parameter,
       <strong>
        Enable-PSSessionConfiguration
       </strong>
       enables the Microsoft.PowerShell session configuration.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         0
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName, ByValue)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -NoServiceRestart
     </div>
     <div class="parameterInfo">
      <p>
       Indicates that the cmdlet does not restart the service.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -SecurityDescriptorSddl
     </div>
     <div class="parameterInfo">
      <p>
       Specifies a security descriptor with which this cmdlet replaces the security descriptor on the session configuration.
      </p>
      <p>
       If you omit this parameter,
       <strong>
        Enable-PSSessionConfiguration
       </strong>
       only deletes the deny all item from the security descriptor.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -SkipNetworkProfileCheck
     </div>
     <div class="parameterInfo">
      <p>
       Indicates that this cmdlet enables the session configuration when the computer is on a public network.
This parameter enables a firewall rule for public networks that allows remote access only from computers in the same local subnet.
By default,
       <strong>
        Enable-PSSessionConfiguration
       </strong>
       fails on a public network.
      </p>
      <p>
       This parameter is designed for client versions of the Windows operating system.
By default, server versions of the Windows operating system have a local subnet firewall rule for public networks.
However, if the local subnet firewall rule is disabled on a server version of the Windows operating system, this parameter re-enables it.
      </p>
      <p>
       To remove the local subnet restriction and enable remote access from all locations on public networks, use the
       <strong>
        Set-NetFirewallRule
       </strong>
       cmdlet in the NetSecurity module.
For more information, see Enable-PSRemoting.
      </p>
      <p>
       This parameter was introduced in Windows PowerShell 3.0.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -WhatIf
     </div>
     <div class="parameterInfo">
      <p>
       Shows what would happen if the cmdlet runs.
The cmdlet is not run.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         wi
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       Microsoft.PowerShell.Commands.PSSessionConfigurationCommands#PSSessionConfiguration, System.String
      </strong>
     </p>
     <p>
      You can pipe a session configuration object or a string that contains the name of a session configuration to this cmdlet.
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       None
      </strong>
     </p>
     <p>
      This cmdlet does not return any objects.
     </p>
     <h2 id="notes">
      Notes
     </h2>
     <ul>
      <li>
       To run this cmdlet on Windows Vista, Windows Server 2008, and later versions of the Windows operating system, you must start Windows PowerShell by using the Run as administrator option.
      </li>
     </ul>
     <p>
      *
     </p>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="relative-path" href="disable-pssessionconfiguration.html">
        Disable-PSSessionConfiguration
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="get-pssessionconfiguration.html">
        Get-PSSessionConfiguration
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="new-pssessionconfigurationfile.html">
        New-PSSessionConfigurationFile
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="new-pssessionoption.html">
        New-PSSessionOption
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="register-pssessionconfiguration.html">
        Register-PSSessionConfiguration
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="set-pssessionconfiguration.html">
        Set-PSSessionConfiguration
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="test-pssessionconfigurationfile.html">
        Test-PSSessionConfigurationFile
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="unregister-pssessionconfiguration.html">
        Unregister-PSSessionConfiguration
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <div class="note alert feedback-system-change-alert">
     <p>
      Note
     </p>
     <p>
      The feedback system for this content will be changing soon. Old comments will not be carried over. If content within a comment thread is important to you, please save a copy. For more information on the upcoming change,
      <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
       we invite you to read our blog post
      </a>
      .
     </p>
    </div>
    <div data-bi-name="comments" id="comments-container" role="form">
    </div>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>