<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Stop-Process (Microsoft.PowerShell.Management)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Stop-Process (Microsoft.PowerShell.Management)" name="twitter:title"/>
  <meta content="The Stop-Process cmdlet stops one or more running processes. You can specify a process by process name or process ID (PID), or pass a process object to Stop-Process. Stop-Process works only on procesâ¦" name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="The Stop-Process cmdlet stops one or more running processes. You can specify a process by process name or process ID (PID), or pass a process object to Stop-Process. Stop-Process works only on procesâ¦" name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="PowerShell_PowerShell-docs_reference" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="PowerShell" name="search.ms_product"/>
  <meta content="PowerShell.PowerShell_PowerShell-docs_reference" name="depot_name"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/617301cc0a194afdca440ba75f5cec2a540ce619/reference/6/Microsoft.PowerShell.Management/Stop-Process.md" name="ref_skeleton_gitcommit"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/live/reference/6/Microsoft.PowerShell.Management/Stop-Process.md" name="original_ref_skeleton_git_url"/>
  <meta content="2018-03-30 03:35 PM" name="updated_at"/>
  <meta content="d1dc5ec5-93df-6ca7-b0c1-6f82c31476ea" name="document_id"/>
  <meta content="8c5d4768-21da-5958-296c-e71e4fa49d2b" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="06/09/2017" name="ms.date"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="powershell,cmdlet" name="keywords"/>
  <meta content="http://go.microsoft.com/fwlink/?LinkId=821642" name="online_version"/>
  <meta content="Microsoft.PowerShell.Commands.Management.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="sdwheeler" name="author"/>
  <meta content="sewhee" name="ms.author"/>
  <meta content="carmonm" name="manager"/>
  <meta content="/powershell/bread-pscore/toc.yml?view=powershell-6" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="windows, macos, linux" name="ms.tgt_pltfr"/>
  <meta content="powershell-scripting" name="ms.technology"/>
  <meta content="powershell" name="ms.prod"/>
  <meta content="MSDocsHeader-Powershell" name="uhfHeaderId"/>
  <meta content="../psdocs/toc.json?view=powershell-6" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/stop-process" rel="canonical"/>
  <title>
   Stop-Process
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/60aac04b.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/fdb8a38a.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Stop-Process
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./Microsoft.PowerShell.Management.html">
         Microsoft.PowerShell.Management
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Stops one or more running processes.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Stop-Process
    [-Id] &lt;Int32[]&gt;
    [-PassThru]
    [-Force]
    [-WhatIf]
    [-Confirm]
    [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Stop-Process
    -Name &lt;String[]&gt;
    [-PassThru]
    [-Force]
    [-WhatIf]
    [-Confirm]
    [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Stop-Process
    [-InputObject] &lt;Process[]&gt;
    [-PassThru]
    [-Force]
    [-WhatIf]
    [-Confirm]
    [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Stop-Process
      </strong>
      cmdlet stops one or more running processes.
You can specify a process by process name or process ID (PID), or pass a process object to
      <strong>
       Stop-Process
      </strong>
      .
      <strong>
       Stop-Process
      </strong>
      works only on processes running on the local computer.
     </p>
     <p>
      On Windows Vista and later versions of the Windows operating system, to stop a process that is not owned by the current user, you must start Windows PowerShell by using the Run as administrator option.
Also, you are will not be prompted for confirmation unless you specify the
      <em>
       Confirm
      </em>
      parameter.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Stop all instances of a process
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Stop-Process -Name "notepad"</code></pre>
     <p>
      This command stops all instances of the Notepad process on the computer.
Each instance of Notepad runs in its own process.
It uses the
      <em>
       Name
      </em>
      parameter to specify the processes, all of which have the same name.
If you were to use the
      <em>
       Id
      </em>
      parameter to stop the same processes, you would have to list the process IDs of each instance of Notepad.
     </p>
     <p>
      <strong>
       Example 2: Stop a specific instance of a process
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Stop-Process -Id 3952 -Confirm -PassThru

Confirm

Are you sure you want to perform this action?

Performing operation "Stop-Process" on Target "notepad (3952)".

[Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help

(default is "Y"):y

Handles  NPM(K)    PM(K)      WS(K) VM(M)   CPU(s)     Id ProcessName

-------  ------    -----      ----- -----   ------     -- -----------

41       2      996       3212    31            3952 notepad</code></pre>
     <p>
      This command stops a particular instance of the Notepad process.
It uses the process ID, 3952, to identify the process.
The
      <em>
       Confirm
      </em>
      parameter directs Windows PowerShell to prompt you before it stops the process.
Because the prompt includes the process namein addition to its ID, this is best practice.
The
      <em>
       PassThru
      </em>
      parameter passes the process object to the formatter for display.
Without this parameter, there would be no display after a
      <strong>
       Stop-Process
      </strong>
      command.
     </p>
     <p>
      <strong>
       Example 3: Stop a process and detect that it has stopped
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; calc

PS C:\&gt; $p = Get-Process -Name "calc"

PS C:\&gt; Stop-Process -InputObject $p

PS C:\&gt; Get-Process | Where-Object {$_.HasExited}</code></pre>
     <p>
      This series of commands starts and stops the Calc process, and then detects processes that have stopped.
     </p>
     <p>
      The first command starts an instance of the calculator.
     </p>
     <p>
      The second command uses
      <strong>
       Get-Process
      </strong>
      gets an object that represents the Calc process, and then stores it in the $p variable.
     </p>
     <p>
      The third command stops the Calc process.
It uses the
      <em>
       InputObject
      </em>
      parameter to pass the object to
      <strong>
       Stop-Process
      </strong>
      .
     </p>
     <p>
      The last command gets all of the processes on the computer that were running but that are now stopped.
It uses
      <strong>
       Get-Process
      </strong>
      to get all of the processes on the computer.
The pipeline operator (|) passes the results to the Where-Object cmdlet, which selects the ones where the value of the
      <strong>
       HasExited
      </strong>
      property is $True.
      <strong>
       HasExited
      </strong>
      is just one property of process objects.
To find all the properties, type
      <code>
       Get-Process | Get-Member
      </code>
      .
     </p>
     <p>
      <strong>
       Example 4: Stop a process not owned by the current user
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-Process -Name "lsass" | Stop-Process



Stop-Process : Cannot stop process 'lsass (596)' because of the following error: Access is denied

At line:1 char:34

+ Get-Process -Name "lsass" | Stop-Process &lt;&lt;&lt;&lt;



[ADMIN]: PS C:\&gt; Get-Process -Name "lsass" | Stop-Process



Warning!

Are you sure you want to perform this action?

Performing operation 'Stop-Process' on Target 'lsass(596)'

[Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help (default is "Y"):

[ADMIN]: PS C:\&gt; Get-Process -Name "lsass" | Stop-Process -Force

[ADMIN]: PS C:\&gt;</code></pre>
     <p>
      These commands show the effect of using
      <em>
       Force
      </em>
      to stop a process that is not owned by the user.
     </p>
     <p>
      The first command uses
      <strong>
       Get-Process
      </strong>
      to get the Lsass process.
A pipeline operator sends the process to
      <strong>
       Stop-Process
      </strong>
      to stop it.
As shown in the sample output, the first command fails with an Access denied message, because this process can be stopped only by a member of the Administrator group on the computer.
     </p>
     <p>
      When Windows PowerShell is opened by using the Run as administrator option, and the command is repeated, Windows PowerShell prompts you for confirmation.
     </p>
     <p>
      The second command specifies
      <em>
       Force
      </em>
      to suppress the prompt.
As a result, the process is stopped without confirmation.
     </p>
     <h2 id="required-parameters">
      Required Parameters
     </h2>
     <div class="parameterName stack">
      -Id
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the process IDs of the processes to stop.
To specify multiple IDs, use commas to separate the IDs.
To find the PID of a process, type
       <code>
        Get-Process
       </code>
       .
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          Int32[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         1
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -InputObject
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the process objects to stop.
Enter a variable that contains the objects, or type a command or expression that gets the objects.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          Process[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         1
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByValue)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Name
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the process names of the processes to stop.
You can type multiple process names, separated by commas, or use wildcard characters.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         ProcessName
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -Confirm
     </div>
     <div class="parameterInfo">
      <p>
       Prompts you for confirmation before running the cmdlet.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         cf
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Force
     </div>
     <div class="parameterInfo">
      <p>
       Stops the specified processes without prompting for confirmation.
By default,
       <strong>
        Stop-Process
       </strong>
       prompts for confirmation before stopping any process that is not owned by the current user.
      </p>
      <p>
       To find the owner of a process, use the Get-WmiObject cmdlet to get a
       <strong>
        Win32_Process
       </strong>
       object that represents the process, and then use the
       <strong>
        GetOwner
       </strong>
       method of the object.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -PassThru
     </div>
     <div class="parameterInfo">
      <p>
       Returns an object that represents the process.
By default, this cmdlet does not generate any output.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -WhatIf
     </div>
     <div class="parameterInfo">
      <p>
       Shows what would happen if the cmdlet runs.
The cmdlet is not run.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         wi
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       System.Diagnostics.Process
      </strong>
     </p>
     <p>
      You can pipe a process object to this cmdlet.
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       None, System.Diagnostics.Process
      </strong>
     </p>
     <p>
      This cmdlet returns a
      <strong>
       System.Diagnostics.Process
      </strong>
      object that represents the stopped process, if you specify the
      <em>
       PassThru
      </em>
      parameter.
Otherwise, this cmdlet does not generate any output.
     </p>
     <h2 id="notes">
      Notes
     </h2>
     <ul>
      <li>
       <p>
        You can also refer to
        <strong>
         Stop-Process
        </strong>
        by its built-in aliases,
        <strong>
         kill
        </strong>
        and
        <strong>
         spps
        </strong>
        . For more information, see about_Aliases.
       </p>
      </li>
      <li>
       <p>
        You can also use the properties and methods of the Windows Management Instrumentation (WMI)
        <strong>
         Win32_Process
        </strong>
        object in Windows PowerShell. For more information, see
        <strong>
         Get-WmiObject
        </strong>
        and the WMI SDK.
       </p>
      </li>
      <li>
       <p>
        When stopping processes, realize that stopping a process can stop process and services that depend on the process.
In an extreme case, stopping a process can stop Windows.
       </p>
      </li>
     </ul>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="relative-path" href="debug-process.html">
        Debug-Process
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="get-process.html">
        Get-Process
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="start-process.html">
        Start-Process
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="stop-process.html">
        Stop-Process
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="wait-process.html">
        Wait-Process
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <div class="note alert feedback-system-change-alert">
     <p>
      Note
     </p>
     <p>
      The feedback system for this content will be changing soon. Old comments will not be carried over. If content within a comment thread is important to you, please save a copy. For more information on the upcoming change,
      <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
       we invite you to read our blog post
      </a>
      .
     </p>
    </div>
    <div data-bi-name="comments" id="comments-container" role="form">
    </div>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>