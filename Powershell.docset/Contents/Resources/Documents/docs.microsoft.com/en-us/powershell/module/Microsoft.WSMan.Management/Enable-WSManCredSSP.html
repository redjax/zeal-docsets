<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Enable-WSManCredSSP (Microsoft.WSMan.Management)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Enable-WSManCredSSP (Microsoft.WSMan.Management)" name="twitter:title"/>
  <meta content="The Enable-WSManCredSSP cmdlet enables Credential Security Support Provider (CredSSP) authentication on a client or on a server computer. When CredSSP authentication is used, the user credentials areâ¦" name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="The Enable-WSManCredSSP cmdlet enables Credential Security Support Provider (CredSSP) authentication on a client or on a server computer. When CredSSP authentication is used, the user credentials areâ¦" name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="PowerShell_PowerShell-docs_reference" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="PowerShell" name="search.ms_product"/>
  <meta content="PowerShell.PowerShell_PowerShell-docs_reference" name="depot_name"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/45404d4ca212afa615798d3d5cbfea5dc5cc1efb/reference/6/Microsoft.WSMan.Management/Enable-WSManCredSSP.md" name="ref_skeleton_gitcommit"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/live/reference/6/Microsoft.WSMan.Management/Enable-WSManCredSSP.md" name="original_ref_skeleton_git_url"/>
  <meta content="2018-03-30 03:35 PM" name="updated_at"/>
  <meta content="79d2b3a6-5210-0f77-1b04-3abce2e01659" name="document_id"/>
  <meta content="aad5c878-9b43-3e7e-d420-b0d8cd91fe0b" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="06/09/2017" name="ms.date"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="powershell,cmdlet" name="keywords"/>
  <meta content="http://go.microsoft.com/fwlink/?LinkId=821727" name="online_version"/>
  <meta content="Microsoft.WSMan.Management.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="sdwheeler" name="author"/>
  <meta content="sewhee" name="ms.author"/>
  <meta content="carmonm" name="manager"/>
  <meta content="/powershell/bread-pscore/toc.yml?view=powershell-6" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="windows, macos, linux" name="ms.tgt_pltfr"/>
  <meta content="powershell-scripting" name="ms.technology"/>
  <meta content="powershell" name="ms.prod"/>
  <meta content="MSDocsHeader-Powershell" name="uhfHeaderId"/>
  <meta content="../psdocs/toc.json?view=powershell-6" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.wsman.management/enable-wsmancredssp" rel="canonical"/>
  <title>
   Enable-WSManCredSSP
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/60aac04b.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/fdb8a38a.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Enable-WSMan
      <wbr/>
      CredSSP
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./Microsoft.WSMan.Management.html">
         Microsoft.WSMan.Management
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Enables CredSSP authentication on a computer.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Enable-WSManCredSSP
      [[-DelegateComputer] &lt;String[]&gt;]
      [-Force]
      [-Role] &lt;String&gt;
      [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Enable-WSManCredSSP
      </strong>
      cmdlet enables Credential Security Support Provider (CredSSP) authentication on a client or on a server computer.
When CredSSP authentication is used, the user credentials are passed to a remote computer to be authenticated.
This type of authentication is designed for commands that create a remote session from another remote session.
For example, if you want to run a background job on a remote computer, use this kind of authentication.
     </p>
     <p>
      Use this cmdlet to enable CredSSP on the client by specifying Client in the
      <em>
       Role
      </em>
      parameter.
This cmdlet performs the following actions:
     </p>
     <ul>
      <li>
       Enables CredSSP on the client.
This cmdlet sets the WS-Management setting
       <strong>
        &lt;localhost|computername&gt;\Client\Auth\CredSSP
       </strong>
       to true.
      </li>
      <li>
       Sets the Windows CredSSP policy
       <strong>
        AllowFreshCredentials
       </strong>
       to WSMan/Delegate on the client.
      </li>
     </ul>
     <p>
      These settings allow the client to delegate explicit credentials to a server when server authentication is achieved.
     </p>
     <p>
      Use this cmdlet enable CredSSP on the server by specifying Server in
      <em>
       Role
      </em>
      .
This cmdlet performs the following action:
     </p>
     <ul>
      <li>
       Enables CredSSP on the server.
This cmdlet sets the WS-Management setting
       <strong>
        &lt;localhost|computername&gt;\Service\Auth\CredSSP
       </strong>
       to true.
      </li>
     </ul>
     <p>
      This policy setting allows the server to act as a delegate for clients.
     </p>
     <p>
      Caution: CredSSP authentication delegates the user credentials from the local computer to a remote computer.
This practice increases the security risk of the remote operation.
If the remote computer is compromised, when credentials are passed to it, the credentials can be used to control the network session.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Delegate client credentials
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Enable-WSManCredSSP -Role "Client" -DelegateComputer "server02.accounting.fabrikam.com"

cfg         : http://schemas.microsoft.com/wbem/wsman/1/config/client/auth

lang        : en-US

Basic       : true

Digest      : true

Kerberos    : true

Negotiate   : true

Certificate : true

CredSSP     : true</code></pre>
     <p>
      This command allows the client credentials to be delegated to the server02 computer.
     </p>
     <p>
      <strong>
       Example 2: Delegate client credentials to all computers in a domain
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Enable-WSManCredSSP -Role "Client" -DelegateComputer "*.accounting.fabrikam.com"

cfg         : http://schemas.microsoft.com/wbem/wsman/1/config/client/auth

lang        : en-US

Basic       : true

Digest      : true

Kerberos    : true

Negotiate   : true

Certificate : true

CredSSP     : true</code></pre>
     <p>
      This command allows the client credentials to be delegated to all the computers in the accounting.fabrikam.com domain.
     </p>
     <p>
      <strong>
       Example 3: Delegate client credentials to multiple computers
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Enable-WSManCredSSP -Role "Client" -DelegateComputer "server02.accounting.fabrikam.com", "server03.accounting.fabrikam.com", "server04.accounting.fabrikam.com"

cfg         : http://schemas.microsoft.com/wbem/wsman/1/config/client/auth

lang        : en-US

Basic       : true

Digest      : true

Kerberos    : true

Negotiate   : true

Certificate : true

CredSSP     : true</code></pre>
     <p>
      This command allows the client credentials to be delegated to multiple computers.
     </p>
     <p>
      <strong>
       Example 4: Allow a computer to act as a delegate
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Enable-WSManCredSSP -Role "Server"</code></pre>
     <p>
      This command allows a computer to act as a delegate for another.
The
      <strong>
       Enable-WSManCredSSP
      </strong>
      cmdlet, shown in the earlier examples, only enables CredSSP authentication on the client, and specifies the remote computers that can act on its behalf.
In order for the remote computer to act as a delegate for the client, the CredSSP item in the Service node of WSMan must be set to true.
This example sets the CredSSP item in the Service node of WSMan to true.
     </p>
     <p>
      <strong>
       Example 5: Allow a computer to act as a delegate by using Set-Item
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Connect-WSMan -ComputerName "server02"

PS C:\&gt; Set-Item -Path "wsman:\server02\service\auth\credSSP" -Value $True</code></pre>
     <p>
      This example allows a computer to act as a delegate for another computer.
The Enable-WSManCredSSP commands, shown in the earlier examples, enable CredSSP authentication only on the client computer, and they specify the remote computers that can act on behalf of the client computer.
For the remote computer to act as a delegate for the client computer, the CredSSP item in the Service directory of the WSMan provider must be set to true.
     </p>
     <p>
      The first command creates a connection to the remote server02 computer by using the Connect-WSMan cmdlet.
     </p>
     <p>
      The second command sets the credSSP value on the remote server02 computer by using the Set-Item cmdlet.
This value allows the remote computer to act as a delegate.
     </p>
     <h2 id="required-parameters">
      Required Parameters
     </h2>
     <div class="parameterName stack">
      -Role
     </div>
     <div class="parameterInfo">
      <p>
       Specifies whether to enable CredSSP as a client or as a server.
The acceptable values for this parameter are: Client and Server.
      </p>
      <p>
       If you specify Client, this cmdlet performs the following actions:
      </p>
      <ul>
       <li>
        Enables CredSSP on the client.
This cmdlet sets the WS-Management setting
        <strong>
         &lt;localhost|computername&gt;\Client\Auth\CredSSP
        </strong>
        to true.
       </li>
       <li>
        Sets the Windows CredSSP policy
        <strong>
         AllowFreshCredentials
        </strong>
        to WSMan/Delegate on the client.
       </li>
      </ul>
      <p>
       These settings allow the client to delegate explicit credentials to a server when server authentication is achieved.
      </p>
      <p>
       If you specify Server, the cmdlet performs the following actions:
      </p>
      <ul>
       <li>
        Enables CredSSP on the server.
This cmdlet sets the WS-Management setting
        <strong>
         &lt;localhost|computername&gt;\Service\Auth\CredSSP
        </strong>
        to true.
       </li>
      </ul>
      <p>
       This policy setting allows the server to act as a delegate for clients.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         1
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -DelegateComputer
     </div>
     <div class="parameterInfo">
      <p>
       Specifies servers to which client credentials are delegated.
Specify fully qualified domain names.
      </p>
      <p>
       If the
       <em>
        Role
       </em>
       parameter is Client, you must specify this paremter.
      </p>
      <p>
       If
       <em>
        Role
       </em>
       is Server, do not specify this parameter.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         2
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Force
     </div>
     <div class="parameterInfo">
      <p>
       Forces the command to run without asking for user confirmation.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       None
      </strong>
     </p>
     <p>
      This cmdlet does not accept any input.
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       System.Xml.XmlElement
      </strong>
     </p>
     <p>
      If CredSSP authentication is successfully enabled, this cmdlet generates an
      <strong>
       XMLElement
      </strong>
      object.
     </p>
     <h2 id="notes">
      Notes
     </h2>
     <ul>
      <li>
       To disable CredSSP authentication, use the Disable-WSManCredSSP cmdlet.
      </li>
     </ul>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="relative-path" href="connect-wsman.html">
        Connect-WSMan
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="disable-wsmancredssp.html">
        Disable-WSManCredSSP
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="disconnect-wsman.html">
        Disconnect-WSMan
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="get-wsmancredssp.html">
        Get-WSManCredSSP
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="get-wsmaninstance.html">
        Get-WSManInstance
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="invoke-wsmanaction.html">
        Invoke-WSManAction
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="new-wsmaninstance.html">
        New-WSManInstance
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="new-wsmansessionoption.html">
        New-WSManSessionOption
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="remove-wsmaninstance.html">
        Remove-WSManInstance
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="set-wsmaninstance.html">
        Set-WSManInstance
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="set-wsmanquickconfig.html">
        Set-WSManQuickConfig
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="test-wsman.html">
        Test-WSMan
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <div class="note alert feedback-system-change-alert">
     <p>
      Note
     </p>
     <p>
      The feedback system for this content will be changing soon. Old comments will not be carried over. If content within a comment thread is important to you, please save a copy. For more information on the upcoming change,
      <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
       we invite you to read our blog post
      </a>
      .
     </p>
    </div>
    <div data-bi-name="comments" id="comments-container" role="form">
    </div>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>