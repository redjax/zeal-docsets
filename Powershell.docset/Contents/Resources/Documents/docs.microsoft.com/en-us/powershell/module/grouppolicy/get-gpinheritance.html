<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Get-GPInheritance (grouppolicy)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Get-GPInheritance (grouppolicy)" name="twitter:title"/>
  <meta content="Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell." name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell." name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="powershell-windows" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="MSDN" name="search.ms_product"/>
  <meta content="MSDN.powershell-windows" name="depot_name"/>
  <meta content="https://cpubwin.visualstudio.com/DefaultCollection/powershell/_git/powershell/commit/ced7757924addcaea0b7a244ae4d240e4d28d93a?path=%2fdocset%2fwindows%2fgrouppolicy%2fget-gpinheritance.md&amp;_a=contents" name="ref_skeleton_gitcommit"/>
  <meta content="https://cpubwin.visualstudio.com/DefaultCollection/powershell/_git/powershell?path=%2fdocset%2fwindows%2fgrouppolicy%2fget-gpinheritance.md&amp;version=GBlive&amp;_a=contents" name="original_ref_skeleton_git_url"/>
  <meta content="2017-09-15 03:44 AM" name="updated_at"/>
  <meta content="e74bf874-00aa-7058-3679-3efdf8f81cd3" name="document_id"/>
  <meta content="cf38e64c-d822-56d8-6f73-fcd57df86c1c" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="manage" name="ms.mktglfcycl"/>
  <meta content="library" name="ms.sitesec"/>
  <meta content="brianlic" name="ms.author"/>
  <meta content="brianlic-msft" name="author"/>
  <meta content="Microsoft.GroupPolicy.Commands.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell, cmdlet" name="keywords"/>
  <meta content="alanth" name="manager"/>
  <meta content="12/20/2016" name="ms.date"/>
  <meta content="w10" name="ms.prod"/>
  <meta content="powershell-windows" name="ms.technology"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="" name="online_version"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="2B4BA841-DD58-4384-A6E4-70909BDD77A1" name="ms.assetid"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="/powershell/windows/bread/toc.json?view=win10-ps" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="MSDocsHeader-WindowsIT" name="uhfHeaderId"/>
  <meta content="../win10-ps/toc.json?view=win10-ps" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/grouppolicy/get-gpinheritance" rel="canonical"/>
  <title>
   Get-GPInheritance
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/e4a1f3a3.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/31353636.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Get-GPInheritance
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./.html">
         grouppolicy
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Gets Group Policy inheritance information for a specified domain or OU.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Get-GPInheritance
   [-Target] &lt;String&gt;
   [-Domain &lt;String&gt;]
   [-Server &lt;String&gt;]
   [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Get-GPInheritance
      </strong>
      cmdlet gets information about Group Policy inheritance for a specified domain or organizational unit (OU).
     </p>
     <p>
      This information includes the following:
     </p>
     <ul>
      <li>
       A list of GPOs that are linked directly to the location (the GpoLinks property).
      </li>
      <li>
       A list of GPOs that are applied to the location when Group Policy is processed on a client (the
       <strong>
        InheritedGpoLinks
       </strong>
       property).
      </li>
      <li>
       Whether inheritance is blocked for the location (the
       <strong>
        GpoInheritanceBlocked
       </strong>
       property).
      </li>
     </ul>
     <p>
      The
      <strong>
       InheritedGpoLinks
      </strong>
      property contains a list of the GPOs are applied to the OU or domain when Group Policy is processed on a client.
The GPOs are listed according to the order of precedence with which they are applied.
This list includes (in the following order):
     </p>
     <ul>
      <li>
       Inherited GPOs that are linked, enabled, and enforced at higher levels of the Group Policy hierarchy (for example, a site).
      </li>
      <li>
       GPOs that are linked and enabled directly at the specified location.
      </li>
      <li>
       If inheritance is not blocked for the specified location, inherited GPOs that are linked and enabled -- but not enforced -- at higher levels of the Group Policy hierarchy.
      </li>
     </ul>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Get Group Policy inheritance information for a specific OU
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-GPInheritance -Target "ou=MyOU,dc=contoso,dc=com" 
ContainerName         : myou 

ContainerType         : OU 

Path                  : ou=myou,dc=contoso,dc=com 

GpoInheritanceBlocked : No 

GpoLinks              : {TestGPO-0, TestGPO-1, TestGPO-2, TestGPO-3...} 

InheritedGpoLinks     : {TestGPO-2, TestGPO-3, Default Domain Policy}</code></pre>
     <p>
      This command gets Group Policy inheritance information for the OU named MyOU in the contoso.com domain.
     </p>
     <p>
      The
      <strong>
       GpoLinks
      </strong>
      property contains a list of all the GPOs that are linked directly to the GPO, whether their links are enabled or not.
     </p>
     <p>
      The
      <strong>
       InheritedGpoLinks
      </strong>
      property contains a list of all the GPOs that are applied when Group Policy is processed on the client.
TestGPO-2 and TestGPO-3 appear in this list because their links are enabled.
     </p>
     <p>
      The Default Domain Policy GPO is inherited from the contoso.com domain.
If inheritance is blocked, it does not appear in the
      <strong>
       InheritedGpoLinks
      </strong>
      property unless its link is enforced at the domain.
If its link is enforced, it appears first in the list.
     </p>
     <p>
      <strong>
       Example 2: Get Group Policy inheritance for a specific domain
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-GPInheritance -Target "dc=contoso,dc=com" -Domain "contoso.com" -Server "DomainController1"
Name                  : contoso.com 

ContainerType         : Domain 

Path                  : dc=contoso,dc=com 

GpoInheritanceBlocked : No 

GpoLinks              : {Default Domain Policy} 

InheritedGpoLinks     : {Default Domain Policy}</code></pre>
     <p>
      This command gets Group Policy inheritance information for the contoso.com domain.
The domain controller with the host name DomainController1 is contacted to complete the operation.
     </p>
     <p>
      The domain does not have to be explicitly specified using the
      <em>
       Domain
      </em>
      parameter in this example.
If the domain of the user that is running the session (or, for startup and shutdown scripts, the computer) is the same as the target domain, or a trust exists between it and the target domain, you do not have to specify the
      <em>
       Domain
      </em>
      parameter.
     </p>
     <p>
      <strong>
       Example 3: Get GPOs that are linked to a specific organizational unit by evaluating the SOM object
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; (Get-GPInheritance -Target "ou=myou,dc=contoso,dc=com").GpoLinks | foreach-object { Get-GPO -Name ($_.DisplayName)} 

DisplayName      : TestGPO-3 

DomainName       : contoso.com 

Owner            : CONTOSO\Domain Admins 

Id               : d02126d4-82e8-4e87-b4a0-2d44b6891411 

GpoStatus        : AllSettingsEnabled 

Description      : 

CreationTime     : 2/27/2009 2:59:51 PM 

ModificationTime : 2/27/2009 4:00:44 PM 

UserVersion      : AD Version: 13, SysVol Version: 13 

ComputerVersion  : AD Version: 0, SysVol Version: 0 

WmiFilter        : 



DisplayName      : TestGPO-2 

DomainName       : contoso.com 

Owner            : CONTOSO\Domain Admins 

Id               : 375865b2-3b5f-480f-8f56-2a994ea6e725 

GpoStatus        : AllSettingsEnabled 

Description      : 

CreationTime     : 2/26/2009 11:28:08 PM 

ModificationTime : 3/1/2009 11:07:30 AM 

UserVersion      : AD Version: 0, SysVol Version: 0 

ComputerVersion  : AD Version: 1, SysVol Version: 1 

WmiFilter        :</code></pre>
     <p>
      This command evaluates the SOM object (Microsoft.GroupPolicy.SOM) returned by
      <strong>
       Get-GPInheritance
      </strong>
      and returns the GPOs that are linked to the MyOU organizational unit.
You can use this command to set properties of the GPOs by piping its output into other cmdlets.
For instance, you can pipe the output to the
      <strong>
       Set-GPPermissions
      </strong>
      cmdlet to delegate permissions to administrators of the OU for each of the GPOs linked to the OU.
     </p>
     <p>
      The
      <strong>
       GpoLinks
      </strong>
      property of the SOM object contains a list of all the GPO links for the OU.
Each object in this list is of type
      <strong>
       Microsoft.GroupPolicy.GpoLink
      </strong>
      .
The following shows one such object:
     </p>
     <p>
      GpoId : d02126d4-82e8-4e87-b4a0-2d44b6891411
     </p>
     <p>
      DisplayName : TestGPO-3
     </p>
     <p>
      Enabled : True
     </p>
     <p>
      Enforced : False
     </p>
     <p>
      Target : ou=myou,dc=contoso,dc=com
     </p>
     <p>
      Order : 1
     </p>
     <p>
      The collection is piped into a foreach-object command, which retrieves each GPO by using the DisplayName property of the GpoLink object.
     </p>
     <h2 id="required-parameters">
      Required Parameters
     </h2>
     <div class="parameterName stack">
      -Target
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the domain or the OU for which to retrieve the Group Policy inheritance information by its Lightweight Directory Access Protocol (LDAP) distinguished name.
For instance, the MyOU organizational unit in the contoso.com domain is specified as ou=MyOU,dc=contoso,dc=com.
      </p>
      <p>
       You can also refer to the
       <em>
        Target
       </em>
       parameter by its built-in alias, path.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         path
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         0
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName, ByValue)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -Domain
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the domain for this cmdlet.
You must specify the fully qualified domain name (FQDN) of the domain.
      </p>
      <p>
       For the
       <strong>
        Get-GPInheritance
       </strong>
       cmdlet, this is typically the domain of the container (domain or OU) for which you want to retrieve inheritance information.
If the specified domain is different than the domain of the container, a trust must exist between the two domains.
      </p>
      <p>
       If you do not specify the
       <em>
        Domain
       </em>
       parameter, the domain of the user that is running the current session is used.
If the cmdlet is being run from a computer startup or shutdown script, the domain of the computer is used.
For more information, see the Notes section in the full Help.
      </p>
      <p>
       If you specify a domain that is different from the domain of the user that is running the current session (or, for a startup or shutdown script, the computer), a trust must exist between that domain and the domain of the user or the computer.
      </p>
      <p>
       You can also refer to the
       <em>
        Domain
       </em>
       parameter by its built-in alias, domainname.
For more information, see about_Aliases.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         DomainName
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Server
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the name of the domain controller that this cmdlet contacts to complete the operation.
You can specify either the fully qualified domain name (FQDN) or the host name.
      </p>
      <p>
       If you do not specify the name by using the
       <em>
        Server
       </em>
       parameter, the primary domain controller (PDC) emulator is contacted.
      </p>
      <p>
       You can also refer to the
       <em>
        Server
       </em>
       parameter by its built-in alias, dc.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         DC
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       Microsoft.GroupPolicy.Som
      </strong>
     </p>
     <p>
      An object that represents a domain or an OU.
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       Microsoft.GroupPolicy.Som
      </strong>
     </p>
     <p>
      This cmdlet returns an object that represents the domain or OU.
The
      <strong>
       GpoInheritanceBlocked
      </strong>
      property indicates whether inheritance is blocked.
You can modify inheritance for the domain or OU by using the
      <strong>
       Set-GPInheritance
      </strong>
      cmdlet.
     </p>
     <h2 id="notes">
      Notes
     </h2>
     <ul>
      <li>
       <p>
        You can use the
        <em>
         Domain
        </em>
        parameter to explicitly specify the domain for this cmdlet.
       </p>
       <p>
        If you do not explicitly specify the domain, the cmdlet uses a default domain.
The default domain is the domain that is used to access network resources by the security context under which the current session is running.
This domain is typically the domain of the user that is running the session.
For example, the domain of the user who started the session by opening Windows PowerShell from the Program Files menu, or the domain of a user that is specified in a runas command.
However, computer startup and shutdown scripts run under the context of the LocalSystem account.
The LocalSystem account is a built-in local account, and it accesses network resources under the context of the computer account.
Therefore, when this cmdlet is run from a startup or shutdown script, the default domain is the domain to which the computer is joined.
       </p>
      </li>
     </ul>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="relative-path" href="./set-gpinheritance.html">
        Set-GPInheritance
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <section class="feedback-section" data-bi-name="feedback-section">
     <h2 id="feedback">
      Feedback
     </h2>
     <div class="alert choose-feedback-type">
      <p>
       We'd love to hear your thoughts. Choose the type you'd like to provide:
      </p>
      <div class="choose-feedback-buttons">
       <a class="button-border feedback-type-product" data-bi-name="product-feedback" href="https://windowsserver.uservoice.com/forums/301869-powershell">
        Product feedback
        <span aria-hidden="true" class="docon docon-navigate-external">
        </span>
       </a>
       <div class="button-group">
        <button class="button-border feedback-sign-in-button" data-bi-name="feedback-sign-in">
         <span aria-hidden="true" class="docon docon-brand-github">
         </span>
         Sign in to give documentation feedback
        </button>
        <button aria-controls="feedback-form" aria-expanded="false" class="button-border feedback-form-toggle" data-bi-name="documentation-feedback" hidden="">
         Content feedback
        </button>
        <div auto-align="" class="dropdown has-caret">
         <button aria-controls="fbm0" aria-expanded="false" aria-haspopup="true" aria-label="Expand documentation feedback menu" class="button-border dropdown-trigger" data-bi-name="documentation-feedback-menu">
          <span aria-hidden="true" class="docon docon-chevron-down-light">
          </span>
         </button>
         <div class="dropdown-menu documentation-feedback-menu" id="fbm0" role="menu">
          You may also leave feedback
          <a data-bi-name="create-issue-on-github" href="{0}">
           directly on GitHub
           <span aria-hidden="true" class="docon docon-navigate-external">
           </span>
          </a>
          .
         </div>
        </div>
       </div>
      </div>
      <p>
       <small>
        Our new feedback system is built on GitHub Issues. Read about this change in
        <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
         our blog post
        </a>
        .
       </small>
      </p>
     </div>
     <form accept-charset="UTF-8" action="javascript:" autocomplete="off" class="feedback-form" hidden="" id="feedback-form">
      <h3 class="feedback-form-heading current-user">
       <img alt="Avatar" aria-hidden="true" class="avatar" height="36" width="36"/>
       <span aria-hidden="true" class="username">
       </span>
       <span class="visually-hidden">
        Liquid error: Can't find the localized string giveDocumentationFeedback for template Conceptual.
       </span>
      </h3>
      <label>
       <span class="visually-hidden">
        Title
       </span>
       <input name="title" pattern=".*\w.*" placeholder="Title" required="" type="text"/>
      </label>
      <label>
       <span class="visually-hidden">
        Leave a comment
       </span>
       <textarea name="body" placeholder="Leave a comment" required=""></textarea>
      </label>
      <div class="action-container">
       <button class="primary-action" name="submit" type="submit">
        Submit feedback
       </button>
      </div>
     </form>
     <div class="feedback-status alert busy" role="alert">
      <p>
       Loading feedback...
      </p>
     </div>
     <div class="feedback-tab-group tabGroup" data-tab-group-independent="" hidden="">
      <ul role="tablist">
       <li role="presentation">
        <a aria-controls="tabpanel-issues-open" aria-label="Open Issues" data-tab="issues-open" href="#tabpanel-issues-open" role="tab">
        </a>
       </li>
       <li role="presentation">
        <a aria-controls="tabpanel-issues-closed" aria-label="Closed Issues" data-tab="issues-closed" href="#tabpanel-issues-closed" role="tab">
        </a>
       </li>
      </ul>
      <section data-tab="issues-open" id="tabpanel-issues-open" role="tabpanel">
       <div class="no-issues-placeholder">
        There are no open issues
       </div>
       <ul aria-label="Open Issues" class="github-issues-list">
       </ul>
      </section>
      <section data-tab="issues-closed" id="tabpanel-issues-closed" role="tabpanel">
       <div class="no-issues-placeholder">
        There are no closed issues
       </div>
       <ul aria-label="Closed Issues" class="github-issues-list">
       </ul>
      </section>
     </div>
     <div class="action-container">
      <a class="view-on-github" data-bi-name="view-on-github" hidden="" href="https://github.com/MicrosoftDocs/windows-powershell-docs/issues">
       <span aria-hidden="true" class="docon docon-brand-github">
       </span>
       <span>
        View on GitHub
       </span>
       <span aria-hidden="true" class="docon docon-navigate-external">
       </span>
      </a>
     </div>
    </section>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>