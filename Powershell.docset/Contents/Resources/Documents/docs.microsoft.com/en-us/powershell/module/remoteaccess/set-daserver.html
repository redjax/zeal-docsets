<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Set-DAServer (remoteaccess)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Set-DAServer (remoteaccess)" name="twitter:title"/>
  <meta content="Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell." name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="Use this topic to help manage Windows and Windows Server technologies with Windows PowerShell." name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="powershell-windows" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="MSDN" name="search.ms_product"/>
  <meta content="MSDN.powershell-windows" name="depot_name"/>
  <meta content="https://cpubwin.visualstudio.com/DefaultCollection/powershell/_git/powershell/commit/ced7757924addcaea0b7a244ae4d240e4d28d93a?path=%2fdocset%2fwindows%2fremoteaccess%2fset-daserver.md&amp;_a=contents" name="ref_skeleton_gitcommit"/>
  <meta content="https://cpubwin.visualstudio.com/DefaultCollection/powershell/_git/powershell?path=%2fdocset%2fwindows%2fremoteaccess%2fset-daserver.md&amp;version=GBlive&amp;_a=contents" name="original_ref_skeleton_git_url"/>
  <meta content="2017-09-15 03:44 AM" name="updated_at"/>
  <meta content="5dd1d989-2177-05e6-a40d-c2bd2848d645" name="document_id"/>
  <meta content="86f94ad0-e9fa-8c16-661e-456845dd30ee" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="manage" name="ms.mktglfcycl"/>
  <meta content="library" name="ms.sitesec"/>
  <meta content="brianlic" name="ms.author"/>
  <meta content="brianlic-msft" name="author"/>
  <meta content="PS_DAServer_v2.0.0.cdxml-help.xml" name="external_help_file"/>
  <meta content="powershell, cmdlet" name="keywords"/>
  <meta content="alanth" name="manager"/>
  <meta content="12/20/2016" name="ms.date"/>
  <meta content="w10" name="ms.prod"/>
  <meta content="powershell-windows" name="ms.technology"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="" name="online_version"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="00980E48-5937-40BD-BA8C-65B0053D53B7" name="ms.assetid"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="/powershell/windows/bread/toc.json?view=win10-ps" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="MSDocsHeader-WindowsIT" name="uhfHeaderId"/>
  <meta content="../win10-ps/toc.json?view=win10-ps" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/remoteaccess/set-daserver" rel="canonical"/>
  <title>
   Set-DAServer
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/e4a1f3a3.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/31353636.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Set-DAServer
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./.html">
         remoteaccess
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Sets the properties specific to the DirectAccess (DA) server.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Set-DAServer
   [-ComputerName &lt;String&gt;]
   [-PassThru]
   [-Force]
   [-InternalIPv6Prefix &lt;String[]&gt;]
   [-ClientIPv6Prefix &lt;String&gt;]
   [-TeredoState &lt;String&gt;]
   [-ConnectToAddress &lt;String&gt;]
   [-UserAuthentication &lt;String&gt;]
   [-IPsecRootCertificate &lt;X509Certificate2&gt;]
   [-IntermediateRootCertificate]
   [-EntrypointName &lt;String&gt;]
   [-CimSession &lt;CimSession[]&gt;]
   [-ThrottleLimit &lt;Int32&gt;]
   [-AsJob]
   [-WhatIf]
   [-Confirm]
   [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Set-DAServer
   [-ComputerName &lt;String&gt;]
   [-PassThru]
   [-Force]
   [-InternalIPv6Prefix &lt;String[]&gt;]
   [-ClientIPv6Prefix &lt;String&gt;]
   [-DisableComputerCertAuthentication]
   [-TeredoState &lt;String&gt;]
   [-ConnectToAddress &lt;String&gt;]
   [-CimSession &lt;CimSession[]&gt;]
   [-ThrottleLimit &lt;Int32&gt;]
   [-AsJob]
   [-WhatIf]
   [-Confirm]
   [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Set-DAServer
   [-ComputerName &lt;String&gt;]
   -DAInstallType &lt;String&gt;
   [-PassThru]
   [-Force]
   [-CimSession &lt;CimSession[]&gt;]
   [-ThrottleLimit &lt;Int32&gt;]
   [-AsJob]
   [-WhatIf]
   [-Confirm]
   [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Set-DAServer
      </strong>
      cmdlet sets the properties specific to the DirectAccess (DA) server.
     </p>
     <p>
      The DA server properties that this cmdlet configures are of the following types.
     </p>
     <p>
      -- Properties which are applicable globally to the entire DA deployment.
     </p>
     <p>
      -- Properties which are applicable per-server, or per-cluster in a load balancing scenario, or per-site such as in a multi-site deployment.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       EXAMPLE 1
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt;Set-DAServer -DAInstallType FullInstall -PassThru
Confirm 
If the DirectAccess Configuration is changed to FullInstall, DirectAccess client computers will be able to connect to internal network via DirectAccess. Do you want to continue to change DAInstallType? 

This cmdlet prompts user to confirm if they really want to change DA configuration. On confirming the cmdlet completes the underlying modifications.
PS C:\&gt;
[Y] Yes  [N] No  [S]Suspend [?] Help  (default is "Y"): Y 
 
DAInstallType               : FullInstall 
InternetInterface           : internet 
InternalInterface           : datest 
ConnectToAddress            : 131.107.0.2 
SslCertificate              : [Subject] 
CN=131.107.0.2 
[Issuer] 
CN=131.107.0.2 
[Serial Number] 
65F63C49B30F669044653F3114390653 
[Not Before] 
11/29/2011 9:45:23 PM 
[Not After] 
11/29/2016 1:55:22 PM 
[Thumbprint] 
0A37103C3038781228FAC19D8725FAD395558FBF 
GpoName                     : corp.contoso.com\DirectAccess Server Settings 
InternalIPv6Prefix          : 2006:2005:1::/48 
ClientIPv6Prefix            : 2006:2005:1:1000::/64 
UserAuthentication          : UserPasswd 
ComputerCertAuthentication  : Disabled 
IPsecRootCertificate        : 
IntermediateRootCertificate : 
TeredoState                 : Disabled 
IsSingleNic                 : False 
IsNatDeployed               : False 
HealthCheck                 : Disabled</code></pre>
     <p>
      This example, given a DA installation in a ManageOut mode, changes the DA configuration to FullInstall mode.
This allows remote clients to connect to resources in the corporate network over the DA connection.
     </p>
     <p>
      <strong>
       EXAMPLE 2
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt;$certs = Get-ChildItem -Path Cert:\LocalMachine\Root



PS C:\&gt;$IPSecRootCert = $certs[13]



PS C:\&gt;$IPSecRootCert
Directory: Microsoft.PowerShell.Security\Certificate::localmachine\root 
Thumbprint                                Subject 
----------                                ------- 
65505D9CDD106DCC6D4C88D3D5FA0EE26B6A3C4F  CN=corp-contoso-dc1-ca 


PS C:\&gt;Set-DAServer -IPsecRootCertificate $IPsecRootCert -UserAuthentication "TwoFactor" -PassThru
DAInstallType               : FullInstall 
InternetInterface           : internet 
InternalInterface           : datest 
ConnectToAddress            : 131.107.0.2 
SslCertificate              : [Subject] 
CN=131.107.0.2 
[Issuer] 
CN=131.107.0.2 
[Serial Number] 
65F63C49B30F669044653F3114390653 
[Not Before] 
11/29/2011 9:45:23 PM 
[Not After] 
11/29/2016 1:55:22 PM 
[Thumbprint] 
0A37103C3038781228FAC19D8725FAD395558FBF 
GpoName                     : corp.contoso.com\DirectAccess Server Settings 
InternalIPv6Prefix          : 2006:2005:1::/48 
ClientIPv6Prefix            : 2006:2005:1:1000::/64 
UserAuthentication          : TwoFactor 
ComputerCertAuthentication  : Enabled 
IPsecRootCertificate        : [Subject] 
CN=corp-contoso-dc1-ca 
[Issuer] 
CN=corp-contoso-dc1-ca 
[Serial Number] 
4022E742A82AECA643E4E786DFE4CB6F 
[Not Before] 
10/13/2011 8:03:11 AM 
[Not After] 
10/13/2016 8:13:08 AM 
[Thumbprint] 
65505D9CDD106DCC6D4C88D3D5FA0EE26B6A3C4F 
IntermediateRootCertificate : False 
TeredoState                 : Disabled 
IsSingleNic                 : False 
IsNatDeployed               : False 
HealthCheck                 : Disabled</code></pre>
     <p>
      This example enables Two-factor user authentication which enables users to use certificates for DA.
There are multiple steps involved in enabling Two-factor authentication.
By default, PKI is disabled during DA installation and will need to be enabled.
This is achieved by provisioning an IPsec root certificate on the DA server using this cmdlet.
The enterprise needs to have a certification authority (CA) which will provision this certificate for all domain joint computers.
The first two steps in this example list out the certificates present in the root certificate store of the server computer and pick an appropriate one.
In this case it happens to be the 13th certificate in the list.
Using this cmdlet, the certificate is then assigned as the IPsec root certificate to enable PKI and the UserAuthentication is specified to be two-factor.
     </p>
     <p>
      <strong>
       EXAMPLE 3
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt;Set-DAServer -TeredoState Enabled</code></pre>
     <p>
      This example enables clients to connect using Teredo.
By default, Teredo is disabled unless two consecutive public IPv4 addresses are found on the internet facing interface of the server while installing DA.
Before enabling Teredo, ensure that two consecutive public IP addresses are present.
     </p>
     <p>
      <strong>
       EXAMPLE 4
      </strong>
     </p>
     <pre><code class="lang-powershell">On running the cmdlet, the user is presented with a prompt to confirm the change to the **ConnecToAddress** parameter.
PS C:\&gt;Set-DAServer -ConnectToAddress daserverNew.com
Changing the ConnectTo address will change the certificate used for IPHttps and VPN. If a load balanced cluster is deployed, change will be deployed to all servers in the cluster. Do you want to continue?

On accepting this prompt, the cmdlet tries to locate a certificate for the new connectTo address. In this case it is unable to locate one and tries to create a self-signed certificate.
PS C:\&gt;
[Y] Yes  [N] No  [S] Suspend  [?] Help  (default is "Y"): Y 
 
Certificate IPHttps cannot be located on the Remote Access server. Do you want DirectAccess to create and use a self-signed certificate? 

Before creating one it asks for user confirmation through the second prompt.
PS C:\&gt;
[Y] Yes  [N] No  [S] Suspend  [?] Help  (default is "Y"): Y</code></pre>
     <p>
      This example changes the connectTo address of the DA Server.
However, since the same address is used in IPHttps and VPN certificates, applying this changes the certificates used for both these technologies.
     </p>
     <h2 id="required-parameters">
      Required Parameters
     </h2>
     <div class="parameterName stack">
      -DAInstallType
     </div>
     <div class="parameterInfo">
      <p>
       Changes the configuration in which DA has been deployed.
The acceptable values for this parameter are:
      </p>
      <p>
       -- FullInstall.
      </p>
      <p>
       -- ManageOut.
      </p>
      <p>
       This parameter is a global configuration and applies to the entire DA deployment.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Parameter Sets:
        </td>
        <td>
         FullInstall, ManageOut
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -DisableComputerCertAuthentication
     </div>
     <div class="parameterInfo">
      <p>
       Specifies that computer certificate authentication is to be disabled.
Disabling this setting disables PKI for the DA deployment.
      </p>
      <p>
       Following are conditions for computer certificate authentication.
      </p>
      <p>
       -- Computer certificate authentication cannot be disabled if health checks are enabled using the
       <strong>
        HealthCheck
       </strong>
       parameter or Two-factor authentication is used for user authentication or when multi-site deployment is enabled or when firstref_client_7 client support is enabled.
      </p>
      <p>
       -- User authentication configuration is automatically changed to
       <code>
        UserPasswd
       </code>
       when computer certificate authentication is disabled.
      </p>
      <p>
       Computer certificate authentication is re-enabled by configuring an IPsec root certificate using the
       <strong>
        IPsecRootCertificate
       </strong>
       parameter.
      </p>
      <p>
       Disabling of computer certificate authentication is a global configuration that applies to the entire DA deployment.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -AsJob
     </div>
     <div class="parameterInfo">
      <p>
       Runs the cmdlet as a background job. Use this parameter to run commands that take a long time to complete.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -CimSession
     </div>
     <div class="parameterInfo">
      <p>
       Runs the cmdlet in a remote session or on a remote computer.
Enter a computer name or a session object, such as the output of a
       <a data-linktype="external" href="http://go.microsoft.com/fwlink/p/?LinkId=227967">
        New-CimSession
       </a>
       or
       <a data-linktype="external" href="http://go.microsoft.com/fwlink/p/?LinkId=227966">
        Get-CimSession
       </a>
       cmdlet.
The default is the current session on the local computer.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          CimSession[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         Session
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -ClientIPv6Prefix
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the prefix from which IPv6 addresses are assigned to the connecting clients in case of IP-HTTPS.
The length should be 64 bits.
In the case of a load balancing scenario the prefix length should be 59 bits.
      </p>
      <p>
       The client IPv6 prefix configuration is applicable per-server or per-site as in the case of multi-site deployments.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -ComputerName
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the IPv4 or IPv6 address, or host name, of the computer on which the DA server computer specific tasks should be run.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         Cn
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Confirm
     </div>
     <div class="parameterInfo">
      <p>
       Prompts you for confirmation before running the cmdlet.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         cf
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -ConnectToAddress
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the DA server or NAT public, if DA server is deployed behind a NAT, address to which clients connect.
Specified as host name or IPv4 address.
      </p>
      <p>
       When the ConnectTo address is changed, the SSL certificate is also changed appropriately.
Following are the rules associated with assigning a proper certificate.
      </p>
      <p>
       -- This cmdlet looks for an appropriate SSL certificate on the computer.
      </p>
      <p>
       -- If an appropriate SSL certificate is not found, then a self-signed certificate is created.
      </p>
      <p>
       -- In the case of external load balancer configuration, if one or more computers are down, then the cmdlet bails out and the ConnectTo Address is not changed.
      </p>
      <p>
       -- In a load balancing scenario, if all computers are up and an appropriate SSL certificate is found only on some computers, then the cmdlet fails the operation of changing the ConnectTo address.
If none of the computers has a proper SSL certificate, then a self-signed certificate is created on all computers and the ConnectTo change goes through.
If one or more computers are down, then the certificate is updated only on the other computers.
But the DA server GPO is updated to ensure that when these computers come up load balancing is in stopped state on them due to a certificate mismatch.
For the certificate change, and as a result the ConnectTo address change, to take effect the administrator needs to install a similar certificate with the same name on the computers and re-run this cmdlet.
If a self-signed certificate is being used, then the user just needs to re-run the cmdet and it automatically creates a self-signed certificate.
      </p>
      <p>
       -- In a multi-site scenario, this cmdlet does not create a self-signed certificate and always expects a proper certificate to be present on the computer itself.
      </p>
      <p>
       The ConnectTo address is applicable per-DA server or per-site, in the case of multi-site deployments.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -EntrypointName
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the identity of a site in a multi-site deployment and indicates that the DA server properties should be configured for that site.
Only the following properties are applicable at the site level.
The rest of the properties are global and therefore this parameter has no meaning to them.
      </p>
      <p>
       -- ClientIPv6Prefix.
      </p>
      <p>
       -- ConnectToAddress.
      </p>
      <p>
       -- TeredoState.
      </p>
      <p>
       If this parameter is not specified in a multi-site deployment, then the entry point name to which the server on which the cmdlet is run is used.
The server could also be represented by using the
       <strong>
        ComputerName
       </strong>
       parameter.
      </p>
      <p>
       If both this parameter and
       <strong>
        ComputerName
       </strong>
       parameter are specified and the computer name does not belong to the site represented by the entry point name, then the entry point takes precedence.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Force
     </div>
     <div class="parameterInfo">
      <p>
       Forces the command to run without asking for user confirmation.
      </p>
      <p>
       When suppressed the cmdlet assumes user confirmation for the following conditions.
      </p>
      <p>
       -- ConnectTo change would result in a change in the SSL certificate.
      </p>
      <p>
       -- During SSL certificate change if an appropriate certificate is not found then a self-signed certificate is created.
      </p>
      <p>
       -- Changing DA installation type.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -IPsecRootCertificate
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the root certificate to which DA should chain.
The acceptable values for this parameter are:
      </p>
      <p>
       -- Change the IPsec root certificate.
      </p>
      <p>
       -- Enable PKI if there is no IPsec root certificate already configured.
However, this cmdlet configures the certificate only on the server on which this cmdlet finally runs.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          X509Certificate2
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByValue)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -IntermediateRootCertificate
     </div>
     <div class="parameterInfo">
      <p>
       Specifies that the IPsec root certificate specified is an intermediate root certificate.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -InternalIPv6Prefix
     </div>
     <div class="parameterInfo">
      <p>
       Represents the native IPv6 prefixes used in the internal network, in corporate network.
The list of prefixes specified always overwrites the existing list of prefixes.
      </p>
      <p>
       The list of internal IPv6 prefixes is a global configuration and applies to the entire DA deployment.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -PassThru
     </div>
     <div class="parameterInfo">
      <p>
       Returns an object representing the item with which you are working.
By default, this cmdlet does not generate any output.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -TeredoState
     </div>
     <div class="parameterInfo">
      <p>
       Configures the state of Teredo.
The acceptable values for this parameter are:
      </p>
      <p>
       -- Enabled.
      </p>
      <p>
       -- Disabled.
      </p>
      <p>
       The following are the behavioral aspects of Teredo State.
      </p>
      <p>
       -- Teredo can be enabled only if two consecutive Public IPv4 addresses are present on the Internet interface of the server.
      </p>
      <p>
       -- In a load balancing scenario.
      </p>
      <p>
       ---- If a 3rd party load balancer is being used and Teredo has to be enabled, then the load balancer should have two consecutive IP addresses.
Additionally each DA server that is part of the Load balancer must have 2 consecutive public IPv4 addresses.
      </p>
      <p>
       ---- Teredo can be enabled on a cluster if the cluster has VIPs that are two consecutive public IPv4 addresses.
If such IPs are not found, then the cluster should be destroyed first and two consecutive IPs should be configured on the DA server.
      </p>
      <p>
       -- The Teredo configuration is applicable per-computer or per-site, in the case of multi-site deployments.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Parameter Sets:
        </td>
        <td>
         Enabled, Disabled
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -ThrottleLimit
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the maximum number of concurrent operations that can be established to run the cmdlet.
If this parameter is omitted or a value of
       <code>
        0
       </code>
       is entered, then Windows PowerShellÂ® calculates an optimum throttle limit for the cmdlet based on the number of CIM cmdlets that are running on the computer.
The throttle limit applies only to the current cmdlet, not to the session or to the computer.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          Int32
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -UserAuthentication
     </div>
     <div class="parameterInfo">
      <p>
       Sets the type of authentication that is used to authenticate a DA user.
The acceptable values for this parameter are:
      </p>
      <p>
       -- TwoFactor.
      </p>
      <p>
       -- UserPasswd.
      </p>
      <p>
       Here two-factor refers to certificate authentication, OTP authentication, or smartcard based authentication.
Note: To setup OTP authentication enabling two-factor alone is not enough.
It needs to be configured separately using the DAOtpAuth cmdlets.
      </p>
      <p>
       User authentication is a global configuration that applies to the entire DA deployment.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Parameter Sets:
        </td>
        <td>
         TwoFactor, UserPasswd
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -WhatIf
     </div>
     <div class="parameterInfo">
      <p>
       Shows what would happen if the cmdlet runs.
The cmdlet is not run.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         wi
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       None
      </strong>
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       Microsoft.Management.Infrastructure.CimInstance#DAServer
      </strong>
     </p>
     <p>
      The
      <code>
       Microsoft.Management.Infrastructure.CimInstance
      </code>
      object is a wrapper class that displays Windows Management Instrumentation (WMI) objects.
The path after the pound sign (
      <code>
       #
      </code>
      ) provides the namespace and class name for the underlying WMI object.
     </p>
     <p>
      The output object contains the following properties:
     </p>
     <p>
      -- Type of DirectAccess installation: full or managed.
     </p>
     <p>
      -- Authentication type.
     </p>
     <p>
      -- Internal IPv6 prefix.
     </p>
     <p>
      -- Client IPHTTPS IPv6 prefix.
     </p>
     <p>
      -- Usage of computer certificate authorization for 1st tunnel: Enabled or Disabled.
     </p>
     <p>
      -- IPsec root certificate.
     </p>
     <p>
      -- Whether the IPsec root certificate is an intermediate root certificate.
     </p>
     <p>
      -- Status of Teredo: Enabled or Disabled.
     </p>
     <p>
      -- Whether the DA server is deployed behind NAT.
     </p>
     <p>
      -- Whether the configuration in which DA is deployed is a single or double network adapter.
     </p>
     <p>
      -- Name of the DA server GPO.
     </p>
     <p>
      -- Status of the health check.
     </p>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="external" href="http://go.microsoft.com/fwlink/p/?LinkId=204557">
        Get-ChildItem
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="./get-daserver.html">
        Get-DAServer
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="./get-remoteaccess.html">
        Get-RemoteAccess
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <section class="feedback-section" data-bi-name="feedback-section">
     <h2 id="feedback">
      Feedback
     </h2>
     <div class="alert choose-feedback-type">
      <p>
       We'd love to hear your thoughts. Choose the type you'd like to provide:
      </p>
      <div class="choose-feedback-buttons">
       <a class="button-border feedback-type-product" data-bi-name="product-feedback" href="https://windowsserver.uservoice.com/forums/301869-powershell">
        Product feedback
        <span aria-hidden="true" class="docon docon-navigate-external">
        </span>
       </a>
       <div class="button-group">
        <button class="button-border feedback-sign-in-button" data-bi-name="feedback-sign-in">
         <span aria-hidden="true" class="docon docon-brand-github">
         </span>
         Sign in to give documentation feedback
        </button>
        <button aria-controls="feedback-form" aria-expanded="false" class="button-border feedback-form-toggle" data-bi-name="documentation-feedback" hidden="">
         Content feedback
        </button>
        <div auto-align="" class="dropdown has-caret">
         <button aria-controls="fbm0" aria-expanded="false" aria-haspopup="true" aria-label="Expand documentation feedback menu" class="button-border dropdown-trigger" data-bi-name="documentation-feedback-menu">
          <span aria-hidden="true" class="docon docon-chevron-down-light">
          </span>
         </button>
         <div class="dropdown-menu documentation-feedback-menu" id="fbm0" role="menu">
          You may also leave feedback
          <a data-bi-name="create-issue-on-github" href="{0}">
           directly on GitHub
           <span aria-hidden="true" class="docon docon-navigate-external">
           </span>
          </a>
          .
         </div>
        </div>
       </div>
      </div>
      <p>
       <small>
        Our new feedback system is built on GitHub Issues. Read about this change in
        <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
         our blog post
        </a>
        .
       </small>
      </p>
     </div>
     <form accept-charset="UTF-8" action="javascript:" autocomplete="off" class="feedback-form" hidden="" id="feedback-form">
      <h3 class="feedback-form-heading current-user">
       <img alt="Avatar" aria-hidden="true" class="avatar" height="36" width="36"/>
       <span aria-hidden="true" class="username">
       </span>
       <span class="visually-hidden">
        Liquid error: Can't find the localized string giveDocumentationFeedback for template Conceptual.
       </span>
      </h3>
      <label>
       <span class="visually-hidden">
        Title
       </span>
       <input name="title" pattern=".*\w.*" placeholder="Title" required="" type="text"/>
      </label>
      <label>
       <span class="visually-hidden">
        Leave a comment
       </span>
       <textarea name="body" placeholder="Leave a comment" required=""></textarea>
      </label>
      <div class="action-container">
       <button class="primary-action" name="submit" type="submit">
        Submit feedback
       </button>
      </div>
     </form>
     <div class="feedback-status alert busy" role="alert">
      <p>
       Loading feedback...
      </p>
     </div>
     <div class="feedback-tab-group tabGroup" data-tab-group-independent="" hidden="">
      <ul role="tablist">
       <li role="presentation">
        <a aria-controls="tabpanel-issues-open" aria-label="Open Issues" data-tab="issues-open" href="#tabpanel-issues-open" role="tab">
        </a>
       </li>
       <li role="presentation">
        <a aria-controls="tabpanel-issues-closed" aria-label="Closed Issues" data-tab="issues-closed" href="#tabpanel-issues-closed" role="tab">
        </a>
       </li>
      </ul>
      <section data-tab="issues-open" id="tabpanel-issues-open" role="tabpanel">
       <div class="no-issues-placeholder">
        There are no open issues
       </div>
       <ul aria-label="Open Issues" class="github-issues-list">
       </ul>
      </section>
      <section data-tab="issues-closed" id="tabpanel-issues-closed" role="tabpanel">
       <div class="no-issues-placeholder">
        There are no closed issues
       </div>
       <ul aria-label="Closed Issues" class="github-issues-list">
       </ul>
      </section>
     </div>
     <div class="action-container">
      <a class="view-on-github" data-bi-name="view-on-github" hidden="" href="https://github.com/MicrosoftDocs/windows-powershell-docs/issues">
       <span aria-hidden="true" class="docon docon-brand-github">
       </span>
       <span>
        View on GitHub
       </span>
       <span aria-hidden="true" class="docon docon-navigate-external">
       </span>
      </a>
     </div>
    </section>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>