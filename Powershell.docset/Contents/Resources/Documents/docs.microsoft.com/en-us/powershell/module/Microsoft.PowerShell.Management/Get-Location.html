<!DOCTYPE html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb conceptual" data-authenticated="false" data-render="docs" dir="ltr" lang="en-us">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Get-Location (Microsoft.PowerShell.Management)" property="og:title"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" property="og:image"/>
  <meta content="summary" name="twitter:card"/>
  <meta content="@docsmsft" name="twitter:site"/>
  <meta content="Get-Location (Microsoft.PowerShell.Management)" name="twitter:title"/>
  <meta content="The Get-Location cmdlet gets an object that represents the current directory, much like the print working directory (pwd) command. When you move between Windows PowerShell drives, Windows PowerShellâ¦" name="twitter:description"/>
  <meta content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png" name="twitter:image"/>
  <meta content="Microsoft Logo" name="twitter:image:alt"/>
  <meta content="The Get-Location cmdlet gets an object that represents the current directory, much like the print working directory (pwd) command. When you move between Windows PowerShell drives, Windows PowerShellâ¦" name="description"/>
  <meta content="Docs" name="search.ms_sitename"/>
  <meta content="PowerShell_PowerShell-docs_reference" name="search.ms_docsetname"/>
  <meta content="0" name="version"/>
  <meta content="en-us" name="locale"/>
  <meta content="Docs" name="site_name"/>
  <meta content="PowerShell" name="search.ms_product"/>
  <meta content="PowerShell.PowerShell_PowerShell-docs_reference" name="depot_name"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/446813f2b0922607a6ae1d2df7a11be56edfa4c1/reference/6/Microsoft.PowerShell.Management/Get-Location.md" name="ref_skeleton_gitcommit"/>
  <meta content="https://github.com/PowerShell/PowerShell-Docs/blob/live/reference/6/Microsoft.PowerShell.Management/Get-Location.md" name="original_ref_skeleton_git_url"/>
  <meta content="2018-03-30 03:35 PM" name="updated_at"/>
  <meta content="8f05eb13-6d23-c9ab-588e-80aef9289e05" name="document_id"/>
  <meta content="5a33312c-b132-0351-2f5a-3230c60db544" name="document_version_independent_id"/>
  <meta content="powershell" name="page_type"/>
  <meta content="command" name="page_kind"/>
  <meta content="06/09/2017" name="ms.date"/>
  <meta content="2.0.0" name="schema"/>
  <meta content="powershell,cmdlet" name="keywords"/>
  <meta content="http://go.microsoft.com/fwlink/?LinkId=821589" name="online_version"/>
  <meta content="Microsoft.PowerShell.Commands.Management.dll-Help.xml" name="external_help_file"/>
  <meta content="powershell" name="ms.devlang"/>
  <meta content="INDEX, FOLLOW" name="ROBOTS"/>
  <meta content="sdwheeler" name="author"/>
  <meta content="sewhee" name="ms.author"/>
  <meta content="carmonm" name="manager"/>
  <meta content="/powershell/bread-pscore/toc.yml?view=powershell-6" name="breadcrumb_path"/>
  <meta content="powershell" name="apiPlatform"/>
  <meta content="reference" name="ms.topic"/>
  <meta content="windows, macos, linux" name="ms.tgt_pltfr"/>
  <meta content="powershell-scripting" name="ms.technology"/>
  <meta content="powershell" name="ms.prod"/>
  <meta content="MSDocsHeader-Powershell" name="uhfHeaderId"/>
  <meta content="../psdocs/toc.json?view=powershell-6" name="toc_rel"/>
  <link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-location" rel="canonical"/>
  <title>
   Get-Location
  </title>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/60aac04b.site.css" rel="stylesheet"/>
  <link href="../../../../_themes/docs.theme/master/en-us/_themes/css/fdb8a38a.conceptual.css" rel="stylesheet"/>
 </head>
 <body dir="ltr" lang="en-us">
  <div class="header-holder">
   <div data-bi-name="header" id="headerAreaHolder">
    <div id="uhf-placeholder">
    </div>
   </div>
   <div class="disclaimer-holder" id="disclaimer-holder">
   </div>
  </div>
  <div class="container mainContainer" data-bi-name="body">
   <div class="content-header" data-bi-name="content-header">
    <div class="content-header-controls">
     <button class="contents-button button-border" data-bi-name="contents-expand" type="button">
      <span class="docon docon-menu">
      </span>
      Contents
     </button>
    </div>
    <div class="content-header-controls">
     <button class="ap-collapse-behavior ap-expanded button-border" data-bi-name="ap-collapse" type="button">
      <span class="docon docon-exit-mode">
      </span>
      Exit focus mode
     </button>
    </div>
   </div>
   <div class="primary-holder">
    <main class="content" data-bi-name="content" dir="ltr" id="main" lang="en-us" role="main">
     <!-- <content> -->
     <h1>
      Get-Location
     </h1>
     <div class="metadata">
      <dl class="attributeList">
       <dt>
        Module:
       </dt>
       <dd>
        <a data-linktype="relative-path" href="./Microsoft.PowerShell.Management.html">
         Microsoft.PowerShell.Management
        </a>
       </dd>
      </dl>
     </div>
     <div class="summaryHolder">
      <div class="summary">
       Gets information about the current working location or a location stack.
      </div>
     </div>
     <h2 class="hiddenAnchor" id="syntax">
      Syntax
     </h2>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Get-Location
   [-PSProvider &lt;String[]&gt;]
   [-PSDrive &lt;String[]&gt;]
   [-UseTransaction]
   [&lt;CommonParameters&gt;]</code></pre>
     <pre class="wrap"><code class="lang-powershell" dir="ltr">Get-Location
   [-Stack]
   [-StackName &lt;String[]&gt;]
   [-UseTransaction]
   [&lt;CommonParameters&gt;]</code></pre>
     <h2 id="description">
      Description
     </h2>
     <p>
      The
      <strong>
       Get-Location
      </strong>
      cmdlet gets an object that represents the current directory, much like the print working directory (pwd) command.
     </p>
     <p>
      When you move between Windows PowerShell drives, Windows PowerShell retains your location in each drive.
You can use this cmdlet to find your location in each drive.
     </p>
     <p>
      You can use this cmdlet to get the current directory at run time and use it in functions and scripts, such as in a function that displays the current directory in the Windows PowerShell prompt.
     </p>
     <p>
      You can also use this cmdlet to display the locations in a location stack.
For more information, see the Notes and the descriptions of the
      <em>
       Stack
      </em>
      and
      <em>
       StackName
      </em>
      parameters.
     </p>
     <h2 id="examples">
      Examples
     </h2>
     <p>
      <strong>
       Example 1: Display your current drive location
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt; Get-Location

Path

----

C:\WINDOWS</code></pre>
     <p>
      This command displays your location in the current Windows PowerShell drive.
     </p>
     <p>
      For instance, if you are in the Windows directory of the C: drive, it displays the path to that directory.
     </p>
     <p>
      <strong>
       Example 2: Display your current location for different drives
      </strong>
     </p>
     <pre><code class="lang-powershell">The first command uses the **Set-Location** cmdlet to set the current location to the Windows subdirectory of the C: drive.

PS C:\&gt; Set-Location C:\Windows



The second command uses the **Set-Location** cmdlet to change the location to the HKLM:\Software\Microsoft registry key. When you change to a location in the HKLM: drive, Windows PowerShell retains your location in the C: drive.

PS C:\&gt;

PS C:\WINDOWS&gt; Set-Location HKLM:\Software\Microsoft

PS HKLM:\Software\Microsoft&gt;



The third command uses the **Set-Location** cmdlet to change the location to the HKCU:\Control Panel\Input Method registry key.

PS C:\&gt;

PS HKLM:\Software\Microsoft&gt; Set-Location "HKCU:\Control Panel\Input Method"

PS HKCU:\Control Panel\Input Method&gt;



The fourth command uses the **Get-Location** cmdlet to find the current location on the C: drive. It uses the *PSDrive* parameter to specify the drive.

PS C:\&gt;

PS HKCU:\Control Panel\Input Method&gt; Get-Location -PSDrive C







Path

----

C:\WINDOWS





The fifth command uses the **Set-Location** cmdlet to return to the C: drive. Even though the command does not specify a subdirectory, Windows PowerShell returns you to the saved location.

PS C:\&gt;

PS HKCU:\Control Panel\Input Method&gt; Set-Location C:

PS C:\WINDOWS&gt;



The sixth command uses the **Get-Location** cmdlet to find the current location in the drives supported by the Windows PowerShell registry provider. **Get-Location** returns the location of the most recently accessed registry drive, HKCU.

PS C:\&gt;

PS C:\WINDOWS&gt; Get-Location -PSProvider registry









Path

----

HKCU:\Control Panel\Input Method





To see the current location in the HKLM: drive, you need to use the *PSDrive* parameter to specify the drive. The seventh command does just this:

PS C:\&gt;

PS C:\WINDOWS&gt; Get-Location -PSDrive HKLM







Path

----

HKLM:\Software\Microsoft</code></pre>
     <p>
      This example demonstrates the use of
      <strong>
       Get-Location
      </strong>
      to display your current location in different Windows PowerShell drives.
     </p>
     <p>
      <strong>
       Example 3:
      </strong>
     </p>
     <pre><code class="lang-powershell">The first command sets the current location to the Windows directory on the C: drive.

PS C:\&gt; Set-Location C:\Windows



The second command uses the **Push-Location** cmdlet to push the current location (C:\Windows) onto the current location stack and change to the System32 subdirectory. Because no stack is specified, the current location is pushed onto the current location stack. By default, the current location stack is the unnamed default location stack.

PS C:\&gt;

C:\WINDOWS&gt;Push-Location System32



The third command uses the *StackName* parameter of the **Push-Location** cmdlet to push the current location (C:\Windows\System32) onto the Stack2 stack and to change the current location to the WindowsPowerShell subirectory. If the Stack2 stack does not exist, **Push-Location** creates it.

PS C:\&gt;

C:\Windows\System32&gt;Push-Location WindowsPowerShell -StackName Stack2



The fourth command uses the *Stack* parameter of the **Get-Location** cmdlet to get the locations in the current location stack. By default, the current stack is the unnamed default location stack.

PS C:\&gt;

C:\WINDOWS\system32\WindowsPowerShell&gt;Get-Location -Stack







Path

----

C:\WINDOWS





The fifth command uses the *StackName* parameter of the **Get-Location** cmdlet to get the locations in the Stack2 stack.

PS C:\&gt;

C:\WINDOWS\system32\WindowsPowerShell&gt;get-location -stackname Stack2







Path

----

C:\WINDOWS\system32</code></pre>
     <p>
      This example shows how to use the
      <em>
       Stack
      </em>
      and
      <em>
       StackName
      </em>
      parameters of
      <strong>
       Get-Location
      </strong>
      to list the locations in the current location stack and alternate location stacks.
For more information about location stacks, see the Notes.
     </p>
     <p>
      <strong>
       Example 4: Customize the Windows PowerShell prompt
      </strong>
     </p>
     <pre><code class="lang-powershell">PS C:\&gt;

function prompt { 'PowerShell: ' + (get-location) + '&gt; '}

PowerShell: C:\WINDOWS&gt;</code></pre>
     <p>
      This example shows how to customize the Windows PowerShell prompt.
The function that defines the prompt includes a
      <strong>
       Get-Location
      </strong>
      command, which is run whenever the prompt appears in the console.
     </p>
     <p>
      The format of the default Windows PowerShell prompt is defined by a special function named prompt.
You can change the prompt in your console by creating a new function named prompt.
     </p>
     <p>
      To see the current prompt function, type the following command:
      <code>
       Get-Content Function:prompt
      </code>
     </p>
     <p>
      The command begins with the function keyword followed by the function name, prompt.
The function body appears within braces ( {} ).
     </p>
     <p>
      This command defines a new prompt that begins with the string PowerShell: .
To append the current location, it uses a
      <strong>
       Get-Location
      </strong>
      command, which runs when the prompt function is called.
The prompt ends with the string "&gt; ".
     </p>
     <h2 id="optional-parameters">
      Optional Parameters
     </h2>
     <div class="parameterName stack">
      -PSDrive
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the current location in the specified Windows PowerShell drive that this cmdlet gets in the operation.
      </p>
      <p>
       For instance, if you are in the Certificate: drive, you can use this parameter to find your current location in the C: drive.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -PSProvider
     </div>
     <div class="parameterInfo">
      <p>
       Specifies the current location in the drive supported by the Windows PowerShell provider that this cmdlet gets in the operation.
      </p>
      <p>
       If the specified provider supports more than one drive, this cmdlet returns the location on the most recently accessed drive.
      </p>
      <p>
       For example, if you are in the C: drive, you can use this parameter to find your current location in the drives of the Windows PowerShellRegistry provider.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -Stack
     </div>
     <div class="parameterInfo">
      <p>
       Indicates that this cmdlet displays the locations in the current location stack.
      </p>
      <p>
       To display the locations in a different location stack, use the
       <em>
        StackName
       </em>
       parameter.
For information about location stacks, see the Notes.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -StackName
     </div>
     <div class="parameterInfo">
      <p>
       Specifies, as a string array, the named location stacks.
Enter one or more location stack names.
      </p>
      <p>
       To display the locations in the current location stack, use the
       <em>
        Stack
       </em>
       parameter.
To make a location stack the current location stack, use the Set-Location parameter.
For information about location stacks, see the Notes.
      </p>
      <p>
       This cmdlet cannot display the locations in the unnamed default stack unless it is the current stack.
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          String[]
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         None
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         True (ByPropertyName)
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <div class="parameterName stack">
      -UseTransaction
     </div>
     <div class="parameterInfo">
      <p>
       Includes the command in the active transaction.
This parameter is valid only when a transaction is in progress.
For more information, see Includes the command in the active transaction.
This parameter is valid only when a transaction is in progress.
For more information, see
      </p>
      <table class="nameValue stack">
       <tr>
        <td>
         Type:
        </td>
        <td>
         <span class="xref">
          SwitchParameter
         </span>
        </td>
       </tr>
       <tr>
        <td>
         Aliases:
        </td>
        <td>
         usetx
        </td>
       </tr>
       <tr>
        <td>
         Position:
        </td>
        <td>
         Named
        </td>
       </tr>
       <tr>
        <td>
         Default value:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept pipeline input:
        </td>
        <td>
         False
        </td>
       </tr>
       <tr>
        <td>
         Accept wildcard characters:
        </td>
        <td>
         False
        </td>
       </tr>
      </table>
     </div>
     <h2 id="inputs">
      Inputs
     </h2>
     <p>
      <strong>
       None
      </strong>
     </p>
     <p>
      You cannot pipe input to this cmdlet.
     </p>
     <h2 id="outputs">
      Outputs
     </h2>
     <p>
      <strong>
       System.Management.Automation.PathInfo or System.Management.Automation.PathInfoStack
      </strong>
     </p>
     <p>
      If you use the
      <em>
       Stack
      </em>
      or
      <em>
       StackName
      </em>
      parameters, this cmdlet returns a
      <strong>
       StackInfo
      </strong>
      object.
Otherwise, it returns a
      <strong>
       PathInfo
      </strong>
      object.
     </p>
     <h2 id="notes">
      Notes
     </h2>
     <ul>
      <li>
       <p>
        This cmdlet is designed to work with the data exposed by any provider. To list the providers in your session, type
        <code>
         Get-PSProvider
        </code>
        . For more information, see about_Providers.
       </p>
       <p>
        The ways that the
        <em>
         PSProvider
        </em>
        ,
        <em>
         PSDrive
        </em>
        ,
        <em>
         Stack
        </em>
        , and
        <em>
         StackName
        </em>
        parameters interact depends on the provider.
Some combinations will result in errors, such as specifying both a drive and a provider that does not expose that drive.
If no parameters are specified, this cmdlet returns the
        <strong>
         PathInfo
        </strong>
        object for the provider that contains the current working location.
       </p>
       <p>
        A stack is a last-in, first-out list in which only the most recently added item is accessible.
You add items to a stack in the order that you use them, and then retrieve them for use in the reverse order.
Windows PowerShell lets you store provider locations in location stacks.
Windows PowerShell creates an unnamed default location stack and you can create multiple named location stacks.
If you do not specify a stack name, Windows PowerShell uses the current location stack.
By default, the unnamed default location is the current location stack, but you can use the
        <strong>
         Set-Location
        </strong>
        cmdlet to change the current location stack.
       </p>
       <p>
        To manage location stacks, use the Windows PowerShellLocation cmdlets, as follows.
       </p>
       <ul>
        <li>
         <p>
          To add a location to a location stack, use the Push-Location cmdlet.
         </p>
        </li>
        <li>
         <p>
          To get a location from a location stack, use the Pop-Location cmdlet.
         </p>
        </li>
        <li>
         <p>
          To display the locations in the current location stack, use the
          <em>
           Stack
          </em>
          parameter of the
          <strong>
           Get-Location
          </strong>
          cmdlet.
To display the locations in a named location stack, use the
          <em>
           StackName
          </em>
          parameter of the
          <strong>
           Get-Location
          </strong>
          cmdlet.
         </p>
        </li>
        <li>
         <p>
          To create a new location stack, use the
          <em>
           StackName
          </em>
          parameter of the
          <strong>
           Push-Location
          </strong>
          cmdlet.
If you specify a stack that does not exist,
          <strong>
           Push-Location
          </strong>
          creates the stack.
         </p>
        </li>
        <li>
         <p>
          To make a location stack the current location stack, use the
          <em>
           StackName
          </em>
          parameter of the
          <strong>
           Set-Location
          </strong>
          cmdlet.
         </p>
        </li>
       </ul>
       <p>
        The unnamed default location stack is fully accessible only when it is the current location stack.
If you make a named location stack the current location stack, you cannot no longer use the
        <strong>
         Push-Location
        </strong>
        or
        <strong>
         Pop-Location
        </strong>
        add or get items from the default stack or use this cmdlet command to display the locations in the unnamed stack.
To make the unnamed stack the current stack, use the
        <em>
         StackName
        </em>
        parameter of the
        <strong>
         Set-Location
        </strong>
        cmdlet with a value of $null or an empty string ("").
       </p>
      </li>
     </ul>
     <p>
      *
     </p>
     <h2 id="related-links">
      Related Links
     </h2>
     <ul>
      <li>
       <a data-linktype="relative-path" href="pop-location.html">
        Pop-Location
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="push-location.html">
        Push-Location
       </a>
      </li>
      <li>
       <a data-linktype="relative-path" href="set-location.html">
        Set-Location
       </a>
      </li>
     </ul>
     <!-- </content> -->
    </main>
    <div class="note alert feedback-system-change-alert">
     <p>
      Note
     </p>
     <p>
      The feedback system for this content will be changing soon. Old comments will not be carried over. If content within a comment thread is important to you, please save a copy. For more information on the upcoming change,
      <a href="https://docs.microsoft.com/teamblog/a-new-feedback-system-is-coming-to-docs">
       we invite you to read our blog post
      </a>
      .
     </p>
    </div>
    <div data-bi-name="comments" id="comments-container" role="form">
    </div>
   </div>
  </div>
  <div class="openfeedback-container" id="openFeedbackContainer">
  </div>
  <div class="action-panel">
  </div>
 </body>
</html>